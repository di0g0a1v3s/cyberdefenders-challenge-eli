Qve.prototype.uR=X(1657,function(a){this.C.C.sP(a)});Yve.prototype.uR=X(1656,function(a){this.D.uR(a)});c8d.prototype.o7=X(1322,function(){return si(this,3)});Wbe.prototype.o7=X(1321,function(){return si(this,3)});Vsa.prototype.rr=X(1313,function(){return si(this,2)});U0d.prototype.rr=X(1312,function(){return si(this,1)});vpa.prototype.$q=X(11,function(){return nh(this,12)});xpa.prototype.$q=X(10,function(){return this.message.$q()});Vse.prototype.$q=X(9,function(){return J(this,2)});
ate.prototype.$q=X(8,function(){return J(this,2)});function pVi(a){DM(a,function(b){b=new (b.H())(a.H,a.eb);BM(a,b);b.setVisible(!0)},"ritzmaestro")}function qVi(a,b){DM(a,function(c){c=c.C(b,this.H,this.jb,this.Ja);BM(this,c);c.setVisible(!0)},"ritzmaestro")}function rVi(a,b){DM(a,function(c){c=c.D(b,this.H,this.jb);BM(this,c);c.setVisible(!0)},"ritzmaestro")}function sVi(a,b){a.D=b}function tVi(a,b){var c=Ld;Md(a,function(d,e){return c(b(d),b(e))})}function uVi(a){C.call(this,a)}v(uVi,C);
uVi.prototype.Hd=function(){return this.message.Hd()};function vVi(a){var b=wVi();xVi(b);return yh(b,3,a)}function xVi(a){a.Oi(1,2,3,4,5,6)}function yVi(a){this.hb=ch(a,-1,0)}v(yVi,fh);yVi.prototype.toBuilder=function(){return new uVi(this)};yVi.prototype.Hd=function(){return nh(this,1)};function wVi(){var a=void 0===a?hh(yVi):a;return new uVi(a)}function zVi(a){C.call(this,a)}v(zVi,C);zVi.prototype.getFunctionName=function(){return this.message.getFunctionName()};
function AVi(a){this.hb=ch(a,-1,0)}v(AVi,fh);AVi.prototype.toBuilder=function(){return new zVi(this)};AVi.prototype.getFunctionName=function(){return nh(this,2)};function BVi(){var a=void 0===a?hh(AVi):a;return new zVi(a)}function CVi(a){C.call(this,a)}v(CVi,C);function DVi(a,b){return Ch(a,1,b)}function EVi(a){this.hb=ch(a,-1,0)}v(EVi,fh);EVi.prototype.toBuilder=function(){return new CVi(this)};function FVi(){var a=void 0===a?hh(EVi):a;return new CVi(a)}
function GVi(a,b){var c=this;this.J=a;this.F=new Uf;this.C=new Map;this.D=new Map;this.H=new Kl(this);this.H.listen(b,"external_data_change",function(){HVi(c);c.F.dispatchEvent(null)});HVi(this)}
function IVi(a,b,c){for(var d=ha(sh(b,1,AVi).Gb()),e=d.next();!e.done;e=d.next()){var f=e.value;jh(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(lh(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.toBuilder();jh(f,3);var k=nh(f,3);yh(h,8,k);jh(f,4)?(f=nh(f,4),yh(h,9,f)):uh(h,9);a.C.set(e,h.build())}else h=a.D.get(e).toBuilder(),jh(f,3),f=nh(f,3),yh(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);wk(bp(To(a.J.Pe("/editactions"),{data:JSON.parse(b.pb())}),"POST"),c).Se()}
function HVi(a){var b=N().zT()().map(wpa),c=new Map,d=new Map;b=ha(b);for(var e=b.next();!e.done;e=b.next())e=e.value,jh(e,8)?c.set(e.getFunctionName(),e):lh(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function JVi(){return T('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function KVi(a){return T('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Er(a.WGa)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function LVi(a,b,c,d,e){Xv.call(this,void 0,!1,e);var f=this;this.R=a;this.O=Array.from(this.R.C.values());tVi(this.O,function(h){return h.getFunctionName()});this.F=b;this.ea=c;this.C=new Map;this.L=null;this.ma=d;this.H=new vbc("Macro removed","UNDO",function(){return MVi(f)},void 0,this.qa(),"off");this.oa(this.H);lw(this.ea,this.H);Hs(this,(new Es).tf(Ls,!1,!0).set("save","Update",!0))}v(LVi,Xv);
LVi.prototype.Ca=function(){Xv.prototype.Ca.call(this);this.kq=!1;Gs(this,!1);NVi(this,!1);fs(Cs(this),"waffle-edit-actions-dialog-gm");Ts(this,"save");this.setTitle("Manage macros");this.zb().appendChild(Br(JVi));for(var a=this.Da("waffle-edit-actions-dialog-actions-row-container"),b=ha(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new OVi(c,this.F,this.ma);this.Ha(d);this.C.set(c.getFunctionName(),d);d.render(a)}Q(this.Da("waffle-edit-actions-empty"),!1);this.H.render();fs(this.H.La(),
"waffle-edit-actions-undo-remove-toast")};function NVi(a,b){Is(a.D,"save").disabled=!b}LVi.prototype.Ia=function(){var a=this;Xv.prototype.Ia.call(this);PVi(this);this.getHandler().listen(this,"dialogselect",this.xa).listen(this.La(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&MVi(a)});QVi(this)};
function PVi(a){for(var b={},c=ha(a.C.values()),d=c.next();!d.done;b={vQ:b.vQ},d=c.next())b.vQ=d.value,a.getHandler().listen(b.vQ.ea,"action",function(e){return function(){return RVi(a,e.vQ)}}(b)).listen(SVi(b.vQ),"input",function(e){return function(){var f=e.vQ;TVi(f)?eW(f.oM):dW(f.oM,"Must be a number from 0 to 9 or blank.",!0);f=!QVi(a)&&TVi(f);NVi(a,f)}}(b)).listen(UVi(b.vQ),"input",function(){a.F.C(29573);NVi(a,!0)})}
function QVi(a){var b=new Map;a=ha(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(VVi(c))?b.get(VVi(c)).push(c):b.set(VVi(c),[c]);a=!1;c=null;b=ha(b);for(var d=b.next();!d.done;d=b.next()){var e=ha(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");wm(h,"Conflicts with another shortcut");Q(h,!0)})):e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");Q(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return yG(f)})}return a}function RVi(a,b){NVi(a,!0);a.L=b;a.C.delete(b.Aa);Q(b.La(),!1);QVi(a);a.H.setVisible(!0);0==a.C.size&&Q(a.Da("waffle-edit-actions-empty"),!0);a.La().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return yG(c)});a.F.C(29572)}
function MVi(a){if(null!=a.L){var b=a.L;a.C.set(b.Aa,b);Q(b.La(),!0);Q(a.Da("waffle-edit-actions-empty"),!1);QVi(a);a.L=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return yG(c)});a.F.C(29577)}}
LVi.prototype.xa=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ha(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!TVi(d)||""!=WVi(d)){a.preventDefault();return}QVi(this)?a.preventDefault():(a=XVi(this),IVi(this.R,a,function(){var e=kw(b.ea,"Failed to update macros.",Sl(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);iw(e);e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return yG("Macros updated")}))}};
function XVi(a){for(var b=FVi(),c=ha(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=BVi();var f=!1,h=a.C.get(e.getFunctionName()),k=nh(e,9),l=nh(e,8);h?(k!=VVi(h)&&(k=VVi(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(vh(d,5,!0),f=!0);f&&(f=nh(e,1),yh(d,1,f),e=e.getFunctionName(),yh(d,2,e),yh(d,3,l),k&&yh(d,4,k),d=d.build(),Bh(b,1,d))}return b.build()}
function OVi(a,b,c,d){S.call(this,d);this.xa=a;this.Ma=nh(a,8);this.Aa=a.getFunctionName();this.J=(a=nh(a,9))?a.split("+"):[];this.D=new Dv;this.Ha(this.D);this.L=this.O=null;this.C=new Dv;this.Ha(this.C);this.ma=new aw;this.oa(this.ma);this.Ea=b;this.Ja=c;b=ht(zt,"waffle-overflow-menu-material");this.H=new Qt(void 0,void 0,b,this.qa());this.oa(this.H);this.R=new Et("Edit script");this.oa(this.R);this.ea=new Et("Remove");this.oa(this.ea);this.oM=new cW(this.qa());this.oa(this.oM);this.F=new cW(this.qa());
this.oa(this.F)}v(OVi,S);OVi.prototype.Ca=function(){var a=(yd(this.J)?YVi:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=Br(KVi,{WGa:Op?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.mb(a)};
OVi.prototype.Ia=function(){var a=this;this.D.Wa(this.Da("waffle-edit-actions-row-shortcut-input"));this.D.setValue(ld(this.J)||"");var b=this.Da("waffle-edit-actions-name-input");this.C.Wa(b);this.C.setValue(this.Ma);this.ma.Wa(b);this.oM.setPosition(3,2);this.oM.render();b=this.D.La();this.oM.Bi(b);fW(this.oM,b);eW(this.oM);this.F.setPosition(0,2);this.F.render();b=this.C.La();this.F.Bi(b);fW(this.F,b);eW(this.F);b=new Wr(this.H.zb(),13);Rt(this.H,b);this.H.sz=!0;this.H.hd(this.R);this.H.hd(this.ea);
b=this.Da("waffle-edit-actions-row-menu");this.H.Wa(b);"black"==Xt()&&fs(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.R,"action",function(){a.Ja.Ga("macros-editor").kb({scriptId:nh(a.xa,1),filename:nh(a.xa,10)});a.Ea.C(29570)}).listen(this.C.La(),"blur",function(){""==WVi(a)?eW(a.F):dW(a.F,WVi(a),!0)}).listen(this.D.La(),"click",function(){return a.D.La().select()}).listen(SVi(this),"input",function(){return a.Ea.C(29571)});bs(this.Da("waffle-edit-actions-name-input"),"Macro name");
bs(this.D.La(),"Numeric shortcut key");bs(b,"More options button")};function VVi(a){var b=a.D.getValue();return""==b?"":(yd(a.J)?YVi:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function SVi(a){null==a.O&&(a.O=new $v(a.D.La()),a.oa(a.O));return a.O}function UVi(a){null==a.L&&(a.L=new $v(a.C.La()),a.oa(a.L));return a.L}function TVi(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function WVi(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var YVi=["Ctrl","Alt","Shift"];function ZVi(){return T('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function $Vi(a){var b=a.cuc,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Er(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Er(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Er(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return T(a)};function aWi(a,b,c,d){Xv.call(this,void 0,!1,d);this.O=a;this.ea=Array.from(this.O.D.values());tVi(this.ea,function(e){return e.getFunctionName()});this.L=b;this.R=c;this.H=[];this.F=[];this.C=kw(this.R,"Function added.",Sl(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.oa(this.C);this.Ja=new cw(this.qa());this.oa(this.Ja);this.ma=new On(this.xa,3E3,this);this.oa(this.ma)}v(aWi,Xv);
aWi.prototype.Ca=function(){Xv.prototype.Ca.call(this);fs(Cs(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.qa().Ca("DIV","waffle-import-custom-function-title-description",ax()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");As(this).appendChild(a);this.zb().appendChild(Br(ZVi));a=this.Da("waffle-import-custom-functions-row-container");for(var b=ha(this.ea),c=b.next();!c.done;c=
b.next())c=new bWi(c.value,this.L),this.Ha(c),c.render(a),this.H.push(c);this.C.render();this.C.setVisible(!1);Hs(this,null)};aWi.prototype.Ia=function(){var a=this;Xv.prototype.Ia.call(this);for(var b={},c=ha(this.H),d=c.next();!d.done;b={dca:b.dca},d=c.next())b.dca=d.value,this.getHandler().listen(b.dca.D,"action",function(e){return function(){return cWi(a,e.dca)}}(b));this.getHandler().listen(this,"hide",function(){return a.xa()})};
function cWi(a,b){dWi(b);var c=eWi(b.C);fWi(a,c);b=b.Da("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");bs(b,"This function has been added.");b.focus();a.L.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function eWi(a){var b=BVi();var c=nh(a,1);b=yh(b,1,c);c=a.getFunctionName();b=yh(b,2,c);a=a.getFunctionName();return yh(b,3,a).build()}function fWi(a,b){a.F.push(b);a.ma.start()}
aWi.prototype.xa=function(){var a=this;if(0<this.F.length){var b=DVi(FVi(),this.F).build();IVi(this.O,b,function(){var c=kw(a.R,"Failed to add function.",Sl(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);iw(c);c.render();c.setVisible(!0)});this.F=[]}};function bWi(a,b,c){S.call(this,c);this.C=a;this.H=b;a=ew.getInstance();this.D=new At("Add Function",a,c);this.Ha(this.D);this.F=new At("Edit Script",a,c);this.Ha(this.F)}v(bWi,S);
bWi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=Br($Vi,{functionName:this.C.getFunctionName(),cuc:nh(this.C,2),fileName:nh(this.C,10)});this.mb(a);this.D.render(this.Da("waffle-import-custom-function-add-function"));this.F.render(this.Da("waffle-import-custom-function-view-script"))};
bWi.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);this.getHandler().listen(this.F,"action",function(){O("macros-editor").kb({scriptId:nh(a.C,1),filename:nh(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(nh(this.C,2)+(", defined in file: "+nh(this.C,10)))));bs(this.La(),b)};function dWi(a){Q(a.D.La(),!1);fs(a.Da("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function gWi(a,b,c,d,e,f){B.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}v(gWi,B);function hWi(a){I(this,a,0,-1,iWi,null)}x(hWi,H);var iWi=[6];p=hWi.prototype;p.V=function(){var a=new D;jWi(this,a);return Y(a)};function jWi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,4);null!=c&&b.Ba(4,c);c=J(a,5);null!=c&&b.Ba(5,c);c=a.vh();0<c.length&&gi(b,6,c,jWi);c=J(a,7);null!=c&&F(b,7,c);c=J(a,9);null!=c&&b.Ba(9,c);c=J(a,10);null!=c&&b.Ba(10,c);c=J(a,11);null!=c&&G(b,11,c);c=J(a,12);null!=c&&G(b,12,c);c=J(a,13);null!=c&&b.Ba(13,c)}
p.Ie=function(){return J(this,1)};p.Rg=function(){return J(this,2)};p.qk=function(a){L(this,2,a)};p.getKey=function(){return J(this,5)};p.vh=function(){return Li(this,hWi,6)};p.hd=function(a,b){return Qi(this,6,a,hWi,b)};p.Oa=function(a){return L(this,7,a)};p.$q=function(){return J(this,13)};function kWi(a){I(this,a,"amep",-1,null,null)}x(kWi,H);kWi.prototype.V=function(){var a=new D;var b=this.Bb();null!=b&&a.va(1,b,jWi);return Y(a)};kWi.messageId="amep";kWi.prototype.Bb=function(){return M(this,hWi,1,1)};kWi.prototype.re=function(a){return Mi(this,1,a)};kWi.prototype.Y5=function(){XP(this,1)};kWi.prototype.RA=function(){return pi(this,1)};function R7(a){wl.call(this,a)}v(R7,wl);function lWi(a){wl.call(this,"amep");this.D=new kWi(a)}v(lWi,R7);lWi.prototype.C=g("D");function mWi(a){I(this,a,0,-1,null,null)}x(mWi,H);mWi.prototype.V=function(){var a=new D;nWi(this,a);return Y(a)};
function nWi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,4);null!=c&&F(b,4,c);c=J(a,5);null!=c&&b.Ba(5,c);c=J(a,6);null!=c&&b.Ba(6,c);c=J(a,7);null!=c&&b.Ba(7,c);c=J(a,8);null!=c&&F(b,8,c);c=J(a,9);null!=c&&F(b,9,c);c=J(a,10);null!=c&&F(b,10,c);c=J(a,11);null!=c&&b.Ba(11,c);c=J(a,12);null!=c&&F(b,12,c);c=J(a,13);null!=c&&b.Ba(13,c);c=J(a,14);null!=c&&b.Ba(14,c);c=J(a,15);null!=c&&b.Ba(15,c);c=J(a,16);null!=c&&b.Ba(16,c);c=J(a,17);null!=c&&b.Ba(17,
c);c=J(a,18);null!=c&&$h(b,18,c);c=J(a,19);null!=c&&F(b,19,c)}function S7(a){return J(a,2)}mWi.prototype.getName=function(){return J(this,3)};mWi.prototype.Mj=function(){return J(this,13)};function oWi(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}oWi.prototype.F=g("C");function pWi(a,b){return y(A(),"docs-emgsmw")?null==a.F||null==J(b,18)?!1:a.C===J(b,18):a.D===J(b,1)}function T7(a){return new oWi(J(a,1),J(a,18))};function qWi(a){I(this,a,"der",-1,null,null)}x(qWi,H);qWi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};qWi.messageId="der";qWi.prototype.rr=function(){return si(this,1)};function rWi(a){I(this,a,"eer",-1,null,null)}x(rWi,H);rWi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};rWi.messageId="eer";rWi.prototype.rr=function(){return si(this,1)};function sWi(a,b,c){this.C=a;this.F=b;this.D=c}sWi.prototype.getVersionInfo=g("D");function tWi(a,b){this.C=a;this.D=b}tWi.prototype.getVersionInfo=g("D");function uWi(a,b){this.C=a;this.Sd=b}uWi.prototype.getExtension=g("C");uWi.prototype.isEnabled=g("Sd");function vWi(a){Xv.call(this);this.C=a;Ds(this,!0);this.Lw(!1);Hs(this,null);Gs(this,!1)}v(vWi,Xv);vWi.prototype.Ca=function(){Xv.prototype.Ca.call(this);this.C.render(this.zb())};vWi.prototype.Ia=function(){Xv.prototype.Ia.call(this);var a=this.La();$r(a,"labelledby");bs(a,"Add-ons");fs(Cs(this),"gsm-widget")};function wWi(a,b){var c=new Wi,d=new oNd;if(b){if(J(b,1)){var e=J(b,1);L(d,1,e)}e=si(b,12);L(d,2,e);pi(b,18)&&(e=J(b,18),L(d,5,e));b=si(b,19);L(d,6,b)}b=fd(A(),"docs-tcmt");e=!!b;L(d,3,e);e&&L(d,4,b);Mi(c,73,d);return pq(qq(new oq,c),a).build()}function xWi(a){var b=new Wi,c=new oNd;null!=a.D&&L(c,1,a.D);null!=a.C&&L(c,5,a.C);Mi(b,73,c);return pq(qq(new oq,b),90).build()};function yWi(a,b,c){DW.call(this,a);this.D=b;this.F=c;this.D.Ni=!0}v(yWi,DW);p=yWi.prototype;p.Ira=function(){O("macros-extension-store-render").kb()};p.Eda=function(a,b,c){a=new oWi(null,a);O("macros-extension-store-install").kb(new sWi(a,String(b),c),xWi(a))};p.Hra=function(a,b){a=new oWi(null,a);O("macros-extension-store-uninstall-item").kb(new tWi(a,b),xWi(a))};
p.GMa=function(a){var b=new rkf,c=this.F(new oWi(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new CW;d.qk("Use in this document");L(d,3,"useInDoc");d.Jb(!!si(a,4)||!!si(a,12));d.Oa(c);var e=new CW;e.qk("Help");L(e,3,"help");d=[d,e];si(a,9)&&(e=new CW,L(e,1,!0),d.push(e),si(a,8)&&(a=new CW,a.Oa(c),a.qk("Settings"),L(a,3,"settings"),d.push(a)),a=new CW,a.qk("Report an issue"),L(a,3,"reportIssue"),d.push(a));Pi(b,1,d);return b};
p.FMa=function(a,b){var c=new oWi(null,a);a=xWi(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();O("macros-extension-help").kb(S7(b),a);break;case "reportIssue":O("macros-extension-store-report").kb(c,a);break;case "settings":O("macros-extension-store-settings").kb(c,a);Wf(this.D);break;case "useInDoc":O("macros-extension-store-use-in-doc").kb(c,a)}};p.jma=function(){this.D.setVisible(!1)};function zWi(a,b,c){B.call(this);this.D=AWi(a);this.F=b;this.C=c}v(zWi,B);function BWi(a,b,c,d,e){b=new Vrf(b,null,e);Wrf(b,hd(A(),"docs-gsmd"));a.C&&Zrf(b,a.C);sVi(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=hd(A(),"gaia_session_id");a=Zd(a)?NaN:Number(a);isNaN(a)||Xrf(b,a);return b.build()}function CWi(a,b){var c=new vWi(b);a=new yWi(b,c,a.F);c.oa(a);return c}
function AWi(a){if(a==(Mu(),Ju))return"docs_addon";if(a==(Mu(),Ku))return"sheets_addon";if(a==(Mu(),Lu))return"slides_addon";if(a==(Mu(),m1a))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function DWi(a,b,c,d,e,f){B.call(this);this.D=b;this.F=new zWi(a,d,f);this.C=null}v(DWi,B);function EWi(a){I(this,a,"iar",-1,null,null)}x(EWi,H);EWi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&F(a,3,b);return Y(a)};EWi.messageId="iar";EWi.prototype.rr=function(){return si(this,1)};function FWi(a,b,c,d){var e=J(a,4)+"-polymorphic-"+(a.Ie()||"");rTa.call(this,e);this.H=a;this.L=rd(b,function(f){return new FWi(f,[],!1)},this);this.Oa(this.isEnabled());this.xa=c;this.ma="boolean"===typeof d?d:!0}v(FWi,rTa);p=FWi.prototype;p.Za=g("H");p.isInstalled=g("ma");p.kb=function(){O("macros-polymorphic-item").kb(this)};p.isEnabled=function(){return this.L&&(0<this.L.length?!0:!!si(this.H,7))};p.getLabel=function(){return this.H.Rg()||J(this.H,10)||""};function GWi(){wl.call(this,"bm")}v(GWi,wl);function HWi(){Gl.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new ou(this);this.oa(this.D);this.D.subscribe(O("macros-polymorphic-item"),"action",this.F)}v(HWi,Gl);HWi.prototype.F=function(a){a.xa||0<a.L.length?this.dispatchEvent(new GWi(a)):(a=new gWi(J(a.Za(),4),J(a.Za(),3),void 0,J(a.Za(),9)||void 0,void 0,a.Za().$q()||void 0),O("macros-exec").kb(a))};function IWi(a){I(this,a,"ger",-1,JWi,null)}x(IWi,H);var JWi=[1];IWi.prototype.V=function(){var a=new D;var b=this.oia();0<b.length&&gi(a,1,b,nWi);return Y(a)};IWi.messageId="ger";IWi.prototype.oia=function(){return Li(this,mWi,1)};function KWi(a){I(this,a,0,-1,null,null)}x(KWi,H);KWi.prototype.V=function(){var a=new D;LWi(this,a);return Y(a)};function LWi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c)}KWi.prototype.getName=function(){return J(this,1)};function MWi(a){I(this,a,0,-1,NWi,null)}x(MWi,H);var NWi=[4];p=MWi.prototype;p.V=function(){var a=new D;OWi(this,a);return Y(a)};function OWi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=Li(a,KWi,4);0<c.length&&gi(b,4,c,LWi)}p.getId=function(){return J(this,1)};p.wc=function(a){return L(this,1,a)};p.getName=function(){return J(this,2)};p.Od=function(){return J(this,3)};p.Ci=function(a){return L(this,3,a)};function PWi(a){I(this,a,"llr",-1,QWi,null)}x(PWi,H);var QWi=[2];PWi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=Li(this,MWi,2);0<b.length&&gi(a,2,b,OWi);return Y(a)};PWi.messageId="llr";PWi.prototype.rr=function(){return si(this,1)};function RWi(a){I(this,a,"rar",-1,null,null)}x(RWi,H);RWi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);return Y(a)};RWi.messageId="rar";RWi.prototype.rr=function(){return si(this,1)};function SWi(a){I(this,a,"uer",-1,null,null)}x(SWi,H);SWi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};SWi.messageId="uer";SWi.prototype.rr=function(){return si(this,1)};function TWi(a,b,c,d){B.call(this);this.D=a;this.F=c;this.C=d||new UWi}v(TWi,B);p=TWi.prototype;p.n3a=function(a,b,c,d,e,f,h){a=["ruid",Ha({}),this.C.C,this.D,this.C.F,a,this.C.ma,b,this.C.D,c,this.C.L,e,this.C.O,f,this.C.J,h];a=$o(vk(bp(U7(this,this.C.xa),"POST"),2),a).Gr();d&&(xk(a,w(this.bwb,this,d)),wk(a,w(this.X6b,this,d)));a.Se()};p.cancel=function(a){a=["ruid",Ha({}),this.C.C,this.D,this.C.H,a];$o(vk(bp(U7(this,this.C.R),"POST"),2),a).Gr().Se()};
function VWi(a,b){var c=["ruid",Ha({}),a.C.C,a.D];c=$o(vk(U7(a,a.C.Aa),2),c);b&&(xk(c,w(a.G7b,a,b)),wk(c,w(a.F7b,a,b)));c.Se()}p.bwb=function(a,b){b=b.we();b=new EWi(b[0]);a(b)};p.X6b=function(a){var b=new EWi;L(b,1,!1);a(b)};p.G7b=function(a,b){b=b.we();b=new PWi(b[0]);a(b)};p.F7b=function(a){var b=new PWi;L(b,1,!1);a(b)};p.cwb=function(a,b){b=b.we();b=new RWi(b[0]);a(b)};p.pdc=function(a){var b=new RWi;L(b,1,!1);a(b)};
function WWi(a,b){var c=["ruid",Ha({}),a.C.C,a.D];wk(xk($o(vk(U7(a,"/scripts/getitems"),1),c),w(a.e5b,a,b)),ya).Se()}p.e5b=function(a,b){b=b.we();b=new IWi(b[0]);a(b)};function XWi(a,b,c,d){function e(h,k){k=k.we();k=new SWi(k[0]);h(k)}var f=["ruid",Ha({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=$o(bp(U7(a,"/scripts/uninstallitem"),"POST"),f).Gr();c&&(xk(b,w(e,a,c)),a=new SWi,L(a,1,!1),wk(b,Ia(c,a)));b.Se()}
p.KUa=function(a,b,c,d,e,f){a=["ruid",Ha({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=$o(vk(bp(U7(this,"/scripts/enableitem"),"POST"),1),a).Gr();c&&(xk(b,w(this.m3b,this,c)),wk(b,w(this.l3b,this,c)));b.Se()};p.m3b=function(a,b){b=b.we();b=new rWi(b[0]);a(b)};p.l3b=function(a){var b=new rWi;L(b,1,!1);a(b)};
p.tJb=function(a,b,c,d){a=["ruid",Ha({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=$o(vk(bp(U7(this,"/scripts/disableitem"),"POST"),1),a).Gr();c&&(xk(b,w(this.O1b,this,c)),wk(b,w(this.N1b,this,c)));b.Se()};p.O1b=function(a,b){b=b.we();b=new qWi(b[0]);a(b)};p.N1b=function(a){var b=new qWi;L(b,1,!1);a(b)};function U7(a,b){return ap(a.F.Pe(b)).setTimeout(4E4)}
function UWi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,K,P,R){B.call(this);this.C=a||"id";this.F=c||"lib";this.ma=d||"func";this.D=e||"ctx";this.H=f||"pid";this.L=K||"eei";this.O=P||"usit";this.J=void 0!==R?R:"did";this.ea=h||"ca";this.xa=k||"/scripts/invoke";this.R=l||"/scripts/cancel";this.Aa=n||"/scripts/libraries";this.Ea=q||"/scripts/resume";this.Ja=u||"/scripts/uiready"}v(UWi,B);function YWi(a,b,c,d,e,f,h,k,l,n,q,t){B.call(this);var u=this;this.Ja=n?Cac(n):void 0;this.Ea=n?Dac(n):void 0;this.ma=a;this.C=d;this.Ma=e;this.ea=b;this.L=f;this.F=h;this.J=k;this.D=[];this.H=l;this.O=new at("mae-show_addons_menu_promo");bt(c,this.O,"mae-show_addons_menu_promo");this.Aa=q||null;this.xa=t||null;this.R=new DWi(this.ma,this.ea,this,function(z){if(z=u.getExtension(z)){var E=2==u.H?!1:1==u.H?!(!si(z,10)||!si(z,9)):!0;z=new uWi(z,E)}else z=void 0;return z},this.Ea,this.Ja);this.oa(this.R);
O("macros-extension-store-install").Ab(wp,this.G3b,this);O("macros-extension-store-install").Oa(!0);O("macros-extension-store-render").Ab(wp,this.H3b,this);O("macros-extension-store-render").Oa(!0);O("macros-extension-store-report").Ab(wp,this.I3b,this);O("macros-extension-store-report").Oa(!0);O("macros-extension-store-settings").Ab(wp,this.J3b,this);O("macros-extension-store-settings").Oa(!0);O("macros-extension-store-uninstall-item").Ab(wp,this.K3b,this);O("macros-extension-store-uninstall-item").Oa(!0);
O("macros-extension-store-use-in-doc").Ab(wp,this.L3b,this);O("macros-extension-store-use-in-doc").Oa(!0)}v(YWi,B);p=YWi.prototype;p.H3b=function(){ZWi(this)};p.G3b=function(a){a=a.data;$Wi(this,a.F,a.C,a.getVersionInfo())};p.I3b=function(a){a=this.getExtension(a.data);var b=T7(a);this.U7a(b,S7(a),a.getName(),J(a,6)||void 0,J(a,11)||void 0)};p.J3b=function(a){a=this.getExtension(a.data);aXi(this,S7(a))};p.K3b=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&S7(b);b=T7(b);bXi(this,c,b,ya,a.getVersionInfo())};
p.L3b=function(a){var b=this.getExtension(a.data);a=T7(b);si(b,4)||si(b,12)?cXi(this,S7(b),a,function(c){c&&(L(b,4,!1),L(b,12,!1))}):dXi(this,S7(b),a,function(c){c&&L(b,4,!0)})};p.AV=function(a){var b=eXi(this,!1),c=this.R;var d=c.F;a=BWi(d,d.D,b,a,!1);d=CWi(d,a);c.C=d;d=c.C;c.D.Ah(d);d.setVisible(!0);fXi(this)};function eXi(a,b){return(void 0===b?0:b)?a.D.map(function(c){return T7(c)}):a.D.filter(function(c){return si(c,10)&&si(c,9)}).map(function(c){return T7(c)})}
function aXi(a,b){gXi(a.C);var c=w(function(d,e){this.C.uO();d&&d(e)},a,void 0);zqe(a.L.C,w(a.F.n3a,a.F,b,"doSettings",a.J().getState()||void 0,c))}function dXi(a,b,c,d){gXi(a.C);zqe(a.L.C,w(a.F.KUa,a.F,b,c,w(function(e,f){if(f.rr()){var h=a.getExtension(c);h&&L(h,4,!0);ZWi(a)}a.C.uO();e&&e(f.rr())},a,d),void 0,a.J().getState()||void 0))}
function cXi(a,b,c,d){gXi(a.C);zqe(a.L.C,w(a.F.tJb,a.F,b,c,w(function(e,f){if(f.rr()){O("macros-extension-disabled").kb(b);var h=a.getExtension(c);h&&(L(h,4,!1),L(h,12,!1));ZWi(a)}a.C.uO();e&&e(f.rr())},a,d),a.J().getState()||void 0))}function bXi(a,b,c,d,e){XWi(a.F,c,w(function(f,h){if(h.rr()&&b){O("macros-extension-disabled").kb(b);var k=a.D.findIndex(function(l){return pWi(c,l)});-1!=k&&Ed(a.D,k);(k=hXi(a.C))&&pe(k.J,b)}ZWi(a,function(){return f(h.rr())})},a,d),e)}
p.U7a=function(a,b,c,d,e){e?ur(e):(iXi(this.C,w(function(f,h){var k=this.F,l=w(this.C.Byc,this.C,c,h,d),n=w(this.C.Ayc,this.C);f=["ruid",Ha({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);$o(wk(xk(vk(bp(U7(k,"/scripts/sendissuereport"),"POST"),1),Ce(l)),Ce(n)),f).Gr().Se()},this),c),fXi(this))};
function $Wi(a,b,c,d){gXi(a.C);zqe(a.L.C,w(a.F.KUa,a.F,b,c,function(e){a.C.uO();e.rr()?ZWi(a):(e=Pu("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),jXi(a))},!0,a.J().getState()||void 0,d))}function ZWi(a,b){b=void 0===b?ya:b;WWi(a.F,w(function(c,d){d=d.oia();zd(this.D);d=ha(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);kXi(this);jXi(this);c()},a,b))}
function kXi(a){var b=a.Ma,c=Gd(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=S7(e),h=new hWi,k=String(Ha(h));L(h,1,k);h.qk(e.getName());k=S7(e);L(h,4,k);h.Oa(!0);k=e.getName();L(h,10,k);L(h,11,1);k=!(!si(e,10)&&!si(e,9));e=new FWi(h,[],!0,k,si(e,19)||!1);e.setVisible(!0);b.C[ui(e.Za(),11,0)][f]=e}b.dispatchEvent("$l");if(b=a.C.O)if(yd(a.D))!a.O.getValue()&&O("macros-extension-menu-promo").isEnabled()&&(a=a.ma,Mk(b.J.F,"mae-promo-id")||(a=new lXi(a),a.render(),c=new Et(""),c.wc("mae-promo-id"),
c.Ob("script-promo-menu-item"),c.setContent(a.getElement()),su(b.O,c,O("macros-extension-menu-promo"),void 0,void 0,wWi(3)),b.C.Rc(),b.J.Rc(),mXi(b.J,c)),nXi(b));else{c=Gd(a.D);if(b.F){Md(c,b.Ma);f=new Lk;sza(f,b.C.F);b.J.Rc();b.C.Rc();d=[];for(e=0;e<c.length;++e){k=c[e];var l=S7(k),n=!(!si(k,10)&&!si(k,9));d.push(l);h=f.get(l);var q=si(k,19);if(h)l=h.Bb(),n&&!q&&(n=l.Bc(0),q="addon-menu-install-"+S7(k),n&&n.getId()==q&&(l.Hn(0).dispose(),2==l.jc()&&(l.Bc(0),l.Hn(0).dispose())));else{h=new Pt("");
h.wc(l);h.Oa(2==b.R?!1:1==b.R?!!(k&&si(k,10)&&si(k,9)):!0);var t=new Jt;n||q||oXi(b,t,k);pXi(b,t,l,[],k);h.re(t)}k=k.getName();n=im("span");n.appendChild(jm(k));h.setContent(n);qXi(h.Bb().La(),!0);mXi(b.C,h)}for(e=0;e<b.ea.length;++e)mXi(b.C,f.get(b.ea[e]));if(b.L)for(f=f.Oe(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.ea.indexOf(f[e])&&(h=b.xa[f[e]])){for(k=0;k<h.length;++k)b.L.uR(h[k]);delete b.xa[f[e]]}O("macros-manage-extensions").Oa(!!c.length);nXi(b)}a.xa&&a.xa.C(!!a.D.length)}}
function jXi(a){var b=hXi(a.C);if(b){var c=Gd(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(si(f,12)||si(f,4))Zea(b.C,f,b.bLb),b.H&&!si(f,12)&&(b.H=!1)}O("macros-addon-sidebar-focus").Oa(0<b.C.length);b.R=0==d;b.ea=!0;b.L=1==b.C.length&&null!=rXi(b);b.xb()&&sXi(b);a.Aa&&a.Aa.C(0<b.C.length)}}p.getExtension=function(a){return this.D.find(function(b){return pWi(a,b)})};function tXi(a,b){return a.D.find(function(c){return S7(c)===b})}
function fXi(a){if(!a.O.getValue()&&(a.O.setValue(!0),yd(a.D))){var b=a.C.O;if(b){var c=bm("docs-menu-superscript",b.D.getElement());c&&ar(c,0);b.J.Rc();nXi(b);kXi(a)}}};function uXi(a,b,c,d,e,f,h,k,l,n,q,t,u){this.L=a;this.F=b;this.R=c;this.ea=d;this.H=e;this.Aa=h;this.D=k;this.C=l;this.O=n;this.ma=q;this.xa=t;this.J=u}function vXi(a,b){a=a.R;if(b){a=new fl(a);var c=a.F;c+=Td(c,"/")?"":"/";Td(c,"/start/")&&(c=c.replace("start/",""));c+=pha("d/%s/edit",b);jl(a,c);a=a.toString()}return a};function wXi(a){I(this,a,0,-1,null,null)}x(wXi,H);wXi.prototype.V=function(){var a=new D;xXi(this,a);return Y(a)};function xXi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&Zh(b,3,c);c=J(a,4);null!=c&&b.Ba(4,c)};function yXi(a){I(this,a,0,-1,null,null)}x(yXi,H);yXi.prototype.V=function(){var a=new D;zXi(this,a);return Y(a)};function zXi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,5);null!=c&&$h(b,5,c);c=J(a,6);null!=c&&G(b,6,c);c=M(a,wXi,7);null!=c&&b.va(7,c,xXi);c=J(a,8);null!=c&&G(b,8,c);c=J(a,9);null!=c&&$h(b,9,c);c=J(a,10);null!=c&&$h(b,10,c);c=J(a,11);null!=c&&$h(b,11,c)}yXi.prototype.Qf=function(){return J(this,3)};function AXi(a){I(this,a,"paep",-1,null,null)}x(AXi,H);AXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=M(this,yXi,3);null!=b&&a.va(3,b,zXi);b=J(this,4);null!=b&&F(a,4,b);return Y(a)};AXi.messageId="paep";AXi.prototype.getUrl=function(){return J(this,1)};AXi.prototype.Kf=function(){return J(this,2)};function BXi(a){wl.call(this,"paep");this.D=new AXi(a)}v(BXi,R7);BXi.prototype.C=g("D");function CXi(a){I(this,a,0,-1,null,null)}x(CXi,H);CXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&F(a,3,b);b=J(this,4);null!=b&&a.Ba(4,b);return Y(a)};CXi.prototype.mj=function(){return J(this,2)};function DXi(a){I(this,a,"rfep",-1,null,null)}x(DXi,H);DXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,4);null!=b&&a.Ba(4,b);b=J(this,5);null!=b&&a.Ba(5,b);return Y(a)};DXi.messageId="rfep";DXi.prototype.getFunctionName=function(){return J(this,2)};DXi.prototype.$q=function(){return J(this,5)};function EXi(a){wl.call(this,"rfep");this.D=new DXi(a)}v(EXi,R7);EXi.prototype.C=g("D");function FXi(a){I(this,a,"sfep",-1,null,null)}x(FXi,H);FXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&G(a,2,b);b=J(this,3);null!=b&&a.Ba(3,b);return Y(a)};FXi.messageId="sfep";FXi.prototype.sF=function(){return J(this,2)};FXi.prototype.Kf=function(){return J(this,3)};function GXi(a){wl.call(this,"sfep");this.D=new FXi(a)}v(GXi,R7);GXi.prototype.C=g("D");function HXi(a){I(this,a,"step",-1,null,null)}x(HXi,H);HXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&F(a,2,b);return Y(a)};HXi.messageId="step";HXi.prototype.o7=function(){return si(this,2)};function IXi(a){wl.call(this,"step");this.D=new HXi(a)}v(IXi,R7);IXi.prototype.C=g("D");function JXi(a){I(this,a,"scpep",-1,null,null)}x(JXi,H);JXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};JXi.messageId="scpep";function KXi(a){wl.call(this,"scpep");this.D=new JXi(a)}v(KXi,R7);KXi.prototype.C=g("D");function LXi(a){I(this,a,"saep",-1,null,null)}x(LXi,H);LXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ka(4,b);b=J(this,5);null!=b&&a.Ka(5,b);b=J(this,6);null!=b&&G(a,6,b);b=J(this,7);null!=b&&a.Ba(7,b);b=J(this,8);null!=b&&F(a,8,b);b=M(this,kS,9);null!=b&&a.va(9,b,owe);return Y(a)};LXi.messageId="saep";p=LXi.prototype;p.getTitle=function(){return J(this,2)};
p.setTitle=function(a){return L(this,2,a)};p.getWidth=function(){return J(this,4)};p.setWidth=function(a){return L(this,4,a)};p.getHeight=function(){return J(this,5)};p.setHeight=function(a){return L(this,5,a)};p.Tk=function(){return ui(this,6,0)};p.Op=function(a){return L(this,6,a)};p.Wv=function(){return pi(this,6)};function MXi(a){wl.call(this,"saep");this.D=new LXi(a)}v(MXi,R7);MXi.prototype.C=g("D");function NXi(a){I(this,a,"snep",-1,null,null)}x(NXi,H);NXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ua(4,b);return Y(a)};NXi.messageId="snep";p=NXi.prototype;p.getType=function(){return ui(this,1,0)};p.setType=function(a){return L(this,1,a)};p.clearType=function(){return Bi(this,1)};p.hasType=function(){return pi(this,1)};p.getText=function(){return J(this,2)};
p.hasText=function(){return pi(this,2)};p.getTitle=function(){return J(this,3)};p.setTitle=function(a){return L(this,3,a)};function OXi(a){wl.call(this,"snep");this.D=new NXi(a)}v(OXi,R7);OXi.prototype.C=g("D");function PXi(a){I(this,a,"spep",-1,QXi,null)}x(PXi,H);var QXi=[4];PXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);0<b.length&&ei(a,4,b);b=J(this,5);null!=b&&F(a,5,b);b=J(this,6);null!=b&&F(a,6,b);b=J(this,7);null!=b&&a.Ba(7,b);return Y(a)};PXi.messageId="spep";PXi.prototype.getTitle=function(){return J(this,2)};PXi.prototype.setTitle=function(a){return L(this,2,a)};
PXi.prototype.tf=function(a,b){return Ji(this,4,a,b)};function RXi(a){wl.call(this,"spep");this.D=new PXi(a)}v(RXi,R7);RXi.prototype.C=g("D");function SXi(a){I(this,a,"stbep",-1,null,null)}x(SXi,H);SXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ba(4,b);b=J(this,5);null!=b&&a.Ba(5,b);b=J(this,6);null!=b&&a.Ba(6,b);return Y(a)};SXi.messageId="stbep";p=SXi.prototype;p.getFunctionName=function(){return J(this,2)};p.Rg=function(){return J(this,3)};p.qk=function(a){L(this,3,a)};p.getUrl=function(){return J(this,5)};
p.$q=function(){return J(this,6)};function TXi(a){wl.call(this,"stbep");this.D=new SXi(a)}v(TXi,R7);TXi.prototype.C=g("D");function UXi(a){I(this,a,"sttep",-1,null,null)}x(UXi,H);UXi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);return Y(a)};UXi.messageId="sttep";UXi.prototype.getText=function(){return J(this,1)};UXi.prototype.hasText=function(){return pi(this,1)};UXi.prototype.jk=function(){return J(this,2)};UXi.prototype.Yd=function(a){L(this,2,a)};function VXi(a){wl.call(this,"sttep");this.D=new UXi(a)}v(VXi,R7);VXi.prototype.C=g("D");function WXi(){Gl.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new lWi(b);a.dispatchEvent(b);break;case "paep":b=new BXi(b);a.dispatchEvent(b);break;case "rfep":b=new EXi(b);a.dispatchEvent(b);break;case "sfep":b=new GXi(b);a.dispatchEvent(b);break;case "step":b=new IXi(b);a.dispatchEvent(b);break;case "saep":b=new MXi(b);a.dispatchEvent(b);break;case "snep":b=new OXi(b);a.dispatchEvent(b);break;case "spep":b=new RXi(b);a.dispatchEvent(b);break;case "stbep":b=new TXi(b);
a.dispatchEvent(b);break;case "sttep":b=new VXi(b);a.dispatchEvent(b);break;case "scpep":b=new KXi(b),a.dispatchEvent(b)}}}v(WXi,Gl);WXi.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};WXi.prototype.Na=function(){this.C&&this.C.unsubscribe("13",this.D);Gl.prototype.Na.call(this)};function XXi(a,b){Gl.call(this);this.D=new Kl(this);this.oa(this.D);this.C={};this.F=a;this.H=b}v(XXi,Gl);p=XXi.prototype;p.start=function(){this.D.listen(this.H,"sfep",w(this.jOa,this));this.D.listen(this.H,"step",w(this.fwb,this))};function YXi(a,b,c,d){var e=void 0;e=void 0===e?ya:e;d=void 0===d?ya:d;d=w(a.ewb,a,b,e,d);a=a.F;b=["ruid",Ha({}),a.C.C,a.D,a.C.H,b,a.C.ea,c];b=$o(vk(bp(U7(a,a.C.Ea),"POST"),2),b).Gr();d&&(xk(b,w(a.cwb,a,d)),wk(b,w(a.pdc,a,d)));b.Se()}
p.dwb=function(a,b,c,d,e,f){f.rr()?(a=J(f,2),this.C[a]=new ZXi(a,b,d,e),c(a,yi(f,3,!1))):(b=new FXi,L(b,2,6),e(b))};p.ewb=function(a,b,c,d){d.rr()?b():(c(),b=new FXi,L(b,1,a),L(b,2,6),this.jOa(new GXi(b.Gb())))};p.fwb=function(a){a=a.C();var b=J(a,1);if(le(this.C,b)){var c=sfa(this.C,b);(0,c.gwb)(a);c.dispose();pe(this.C,b)}};p.jOa=function(a){a=a.C();var b=J(a,1);if(le(this.C,b)){var c=sfa(this.C,b);(0,c.pLb)(a);c.dispose();pe(this.C,b)}a="Google Apps Script: "+a.Kf();window.console.log(a)};
p.Na=function(){Xf(this.C);Gl.prototype.Na.call(this)};function ZXi(a,b,c,d){B.call(this);this.C=b;this.gwb=c;this.pLb=d}v(ZXi,B);ZXi.prototype.getFunctionName=g("C");function $Xi(a){var b=a.iL,c=a.id,d=a.Rjc,e=a.eba,f=a.zHb,h=a.QY,k=a.wva;return T('<div class="'+U(a.Ds)+'" aria-labelledby="title'+U(c)+'" tabindex="0"'+(b?' role="complementary"':' role="region"')+'><div class="'+U(d)+'"><div class="'+U(e)+'" id="title'+U(c)+'"></div><div class="'+U(f)+'" tabindex="0" title="'+U("Close sidebar")+'" aria-label="'+U("Close sidebar")+'" role="button">'+gw(k)+'</div></div><div class="'+U(h)+'"></div></div>')}
function aYi(a){a=a.caption;return T('<div class="'+U("docs-script-button-bar-text")+" "+U("docs-titlebar-button")+" "+U("goog-inline-block")+'" tabindex="0">'+Er(a)+"</div>")}function bYi(a){a=a.text;return T('<div class="'+U("docs-script-button-bar-bubble-content")+'">'+Er(a)+"</div>")}
function cYi(a){var b=a.iconName,c=a.title;a=a.description;return T('<div class="'+U("script-promo-menu-item-content")+'"><div class="'+U("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+U(b)+'.svg"/></div><div class="'+U("script-promo-menu-item-text")+'"><div class="'+U("script-promo-menu-item-title")+'">'+Er(c)+'</div><div class="'+U("script-promo-menu-item-description")+'">'+Er(a)+"</div></div></div>")}
function dYi(a){var b=a.functionName;a=a.aGa;return T('<div class="'+U("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+U("goog-inline-block")+" "+U("func-entry-rb")+'">&nbsp;</div><div class="'+U("goog-inline-block")+" "+U("func-entry-func")+'">'+Er(b)+'</div><div class="'+U("goog-inline-block")+" "+U("func-entry-lib")+'">'+Er(a)+"</div></div>")}
function eYi(a){var b=a.ids,c=a.description;a=a.xlc;var d='<div class="'+U("script-help-dialog-content")+'"><div class="'+U("script-help-dialog-content-left")+" "+U("goog-inline-block")+(a?" "+U("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(d+='<div class="'+U("script-help-dialog-content-section")+" "+U("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">'+T('<div class="'+(U("script-help-dialog-content-title-caution-icon")+
'"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'))+
"<span>",d+="Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>"):(d+='<div class="'+U("script-help-dialog-content-section")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Er(c)+"</div></div>"));d+='</div><div id="'+U(b.oca)+'" class="'+U("script-help-dialog-buttons")+" "+U("goog-inline-block")+'"></div></div>';return T(d)}
function fYi(a){var b=a.aLb;a='<p class="'+U("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Er(b)+"</strong>:");a=a+c+('</p><textarea class="'+U("jfk-textinput")+" "+U("script-reportissue-dialog-description")+'"></textarea><p class="'+U("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(U("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+U("script-reportissue-dialog-nonanonymous-control")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-checkbox")+" "+U("jfk-checkbox")+'"></div></div><div class="'+U("script-reportissue-dialog-nonanonymous-label")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-optional-text")+" "+U("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Er(b)+" </strong>can follow up.");a=a+b+"</div></div>";return T(a)}
function gYi(a,b){a=a||{};a=a.qc;var c='<div class="'+U("func-actions")+'">';c+=Eu({id:"func-action-new",content:Jr("New"),style:0},b);c+=Eu({id:"func-action-run",content:Jr("Run"),style:0,Jd:"jfk-button-collapse-right"},b);c+=Eu({id:"func-action-edit",content:Jr("Edit"),style:0,Jd:"jfk-button-collapse-left"},b);c+=Eu({id:"func-action-reload",content:Jr(""+gw(a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload")),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+U("func-header")+
'"><div class="'+U("func-header-rb")+" "+U("goog-inline-block")+'"></div><div class="'+U("func-header-func")+" "+U("goog-inline-block")+'">';c=c+'Function</div><div class="'+(U("func-header-lib")+" "+U("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(U("func-entries")+'" role="radiogroup" tabindex="0"></div>');return T(c)}function hYi(){var a='<div class="'+U("func-loading")+'">';return T(a+"Fetching scripts\u2026</div>")}
function iYi(){var a='<div class="'+U("func-none")+'">';return T(a+"No scripts found</div>")};function jYi(){}v(jYi,gt);jYi.prototype.kc=m("func-entry");jYi.prototype.Vg=m(!1);jYi.prototype.Ca=function(a){return Br(dYi,{functionName:a.getFunctionName(),aGa:a.Emc},void 0,a.qa())};Ca(jYi);function kYi(a,b,c,d,e,f){jt.call(this,null,d||jYi.getInstance(),e);this.b4a=a;this.D=void 0!==f?f:null;this.Emc=b;this.C=c;this.Lf(16,!0);this.Lf(32,!0);rt(this,16,!0);lt(this,16,!1)}v(kYi,jt);kYi.prototype.Np=function(a){jt.prototype.Np.call(this,a);a&&this.getElement()&&this.getElement().focus()};kYi.prototype.$q=g("D");kYi.prototype.getFunctionName=g("C");kYi.prototype.rc=function(a){jt.prototype.rc.call(this,a);this.Jb(a);this.getElement()&&xm(this.getElement(),a)};function lYi(a,b){Xv.call(this,void 0,void 0,a);this.O=b||!1;this.Ms=new m_a;this.oa(this.Ms);this.Be=new ct;this.oa(this.Be);this.H=new Fu("");this.oa(this.H);this.C=new Fu("");this.oa(this.C);this.F=new Fu("");this.oa(this.F);this.L=new Fu("");this.oa(this.L);a=new Es(a);a.set("close","Close",!1,!0);Ds(this,!1);Hs(this,a);this.setTitle("Script manager")}v(lYi,Xv);p=lYi.prototype;
p.reset=function(a){this.Ms.clear();this.od(!0);0===a?(a=Br(hYi,{},void 0,this.qa()),a=new jt(a),a.Lf(32,!1),this.Ha(a,!0)):1===a&&(a=Br(iYi,{},void 0,this.qa()),a=new jt(a),a.Lf(32,!1),this.Ha(a,!0))};p.focus=function(){if(this.xb()&&0<this.Ms.uh()){var a=this.Ms.qf();a&&a.Np(!0)}else Xv.prototype.focus.call(this)};p.od=function(a){a=Xv.prototype.od.call(this,a);this.Ms.clear();mYi(this);return a};
p.Af=function(a,b,c){Xv.prototype.Af.call(this,a,b,c);a instanceof kYi&&(b=a.isChecked(),this.Ms.hd(a),1==this.Ms.uh()||b)&&(p_a(this.Ms,a),a.Np(!0));mYi(this)};p.Ca=function(){Xv.prototype.Ca.call(this);var a=this.zb();fs(a,"script-explorer-contents");zr(a,gYi,{qc:this.O});a=rm(sm(a));this.H.Wa(a[0]);this.F.Wa(a[1]);this.C.Wa(a[2]);this.L.Wa(a[3]);Ts(this,"run")};
p.Ia=function(){Xv.prototype.Ia.call(this);this.Be.Pf(this.zb());mYi(this);this.addEventListener("dialogselect",xe(!0));Al(this,"action",this.d0a,void 0,this);Al(this.Be,"key",this.G0a,void 0,this);var a=new Fs("new",this.H.getContent());Al(this.H,"action",w(this.dispatchEvent,this,a));a=new Fs("run",this.F.getContent());Al(this.F,"action",w(this.dispatchEvent,this,a));a=new Fs("edit",this.C.getContent());Al(this.C,"action",w(this.dispatchEvent,this,a));a=new Fs("reload",this.L.getContent());Al(this.L,
"action",w(this.dispatchEvent,this,a))};p.Ad=function(){Xv.prototype.Ad.call(this);this.Be.detach();Dl(this,"action",this.d0a,void 0,this);Dl(this.Be,"key",this.G0a,void 0,this);Fl(this.H);Fl(this.F);Fl(this.C);Fl(this.L)};p.zb=function(){var a=Xv.prototype.zb.call(this),b=rm(a);return 0<b.length?b[2]:a};p.d0a=function(a){mYi(this);a.target instanceof kYi&&(p_a(this.Ms,a.target),a.target.Np(!0))};
p.G0a=function(a){var b=this.Ms.uh();if(0<b)switch(a.keyCode){case 38:this.Ms.jf(zk(this.Ms.wi()-1,b));a.preventDefault();this.focus();break;case 40:this.Ms.jf(zk(this.Ms.wi()+1,b)),a.preventDefault(),this.focus()}};function mYi(a){var b=!!a.Ms.qf();a.F.setVisible(b);a.C.setVisible(b)};function nYi(a,b){this.D=a;this.C=b}function oYi(a){a.D.H&&ZWi(a.C,function(){if(O("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.AV();var b=a.D.ma;if(b&&(b=a.C.getExtension(new oWi(b))||tXi(a.C,b))){var c=a.C,d=c.C.O;d&&(gXi(c.C),c=w(c.C.uO,c.C),pYi(d,S7(b),c))}}})};function qYi(){B.call(this);this.F=new Lk}v(qYi,$u);qYi.prototype.C=function(){return this.F.Id()};function mXi(a,b){a.F.set(b.getId(),b)}qYi.prototype.Rc=function(){this.F.clear()};function lXi(a,b){S.call(this,b);this.C=a}v(lXi,S);
lXi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=this.C==(Mu(),Ju)?"Do more with Docs":this.C==(Mu(),m1a)?"Do more with Forms":this.C==(Mu(),Ku)?"Do more with Sheets":this.C==(Mu(),Lu)?"Do more with Slides":"Do more with Docs",b=this.C==(Mu(),Ju)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Mu(),m1a)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Mu(),Ku)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Mu(),Lu)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Mu(),Ju)?"addon_docs_promo":this.C==(Mu(),m1a)?"addon_forms_promo":this.C==(Mu(),Ku)?"addon_sheets_promo":this.C==(Mu(),Lu)?"addon_slides_promo":"addon_docs_promo",d=this.qa();this.Gc(Br(cYi,{title:a,description:b,iconName:c},void 0,d))};function rYi(){}v(rYi,zt);rYi.prototype.Ca=function(a){a=zt.prototype.Ca.call(this,a);Xr(a,"menuitem");return a};rYi.prototype.kc=m("goog-control");rYi.prototype.xo=function(a){a=zt.prototype.xo.call(this,a);a.push("menu-button","goog-inline-block");return a};Ca(rYi);function sYi(a,b,c,d,e){B.call(this);this.O=b;this.R=c;this.D=a;this.H={};this.Aa={};this.xa={};this.ma=[];this.ea=[];this.F=d||null;this.L=e||null;this.C=new qYi;this.J=new qYi;this.Ea=new Kl;this.oa(this.Ea);this.Ja=[]}v(sYi,B);sYi.prototype.Na=function(){Xf(this.H);B.prototype.Na.call(this)};sYi.prototype.RA=function(a){return le(this.H,a)};
function tYi(a,b,c){c=c?[c]:je(a.H);for(var d=0;d<c.length;d++)for(var e=c[d].Bb(),f=0;f<e.jc();f++){var h=e.Bc(f);if(h instanceof Et&&h.getId()==b||h instanceof Pt&&(h=tYi(a,b,h)))return h}return null}
function uYi(a,b,c,d,e){if(J(b,3)){var f=si(b,7)||!1,h=b.Rg(),k=J(b,10),l=new Et("");l.wc(b.Ie()||String(Ha(l)));var n=[jm(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=a0a(l,O("macros-exec"),[d]),a.ma.push(d),n.push(d));l.setContent(n);b=new gWi(J(b,4),J(b,3),void 0,J(b,9)||void 0,void 0,b.$q()||void 0);su(a.O,l,O("macros-exec"),null,xe(b),wWi(3,e));l.Oa(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Or(O("macros-exec"),[b],xe(e),xe(e))[0]));return l}if(!b.Rg())return new It;if(0<b.vh().length){l=
new Jt;f=b.vh();for(h=0;h<f.length;h++)l.Ha(uYi(a,f[h],c,d,e),!0);a=new Pt(b.Rg());a.wc(b.Ie()||String(Ha(a)));a.re(l);qXi(l.La(),!0);return a}throw Error("Unsupported menu item type.");}sYi.prototype.Ma=function(a,b){return Wd(a.getName(),b.getName())};function pXi(a,b,c,d,e){if(b.oka()){var f=new hWi,h=String(Ha(f));L(f,1,h);b.Ha(uYi(a,f,d),!0)}d=new Et("Help");d.wc(String(Ha(d)));su(a.O,d,O("macros-extension-help"),null,xe(c),wWi(3,e));d.Oa(!0);b.Ha(d,!0)}
function oXi(a,b,c){var d=new Et("");d.wc("addon-menu-install-"+S7(c));su(a.O,d,O("macros-extension-install-start"),vu,xe(S7(c)),wWi(3,c));d.Oa(!0);b.Ha(d,!0)}function nXi(a){fv(a.F,"docs-macros-extension-promo")||ev(a.F,"docs-macros-extension-promo",[a.J,null]);fv(a.F,"docs-macros-extensions")||ev(a.F,"docs-macros-extensions",[a.C]);a.F.Bb("docs-extensions-menu",!0);ax()&&a.F.Bb("macros-extension-add-ons-menu",!0)}
function pYi(a,b,c){var d=c||ya;(c=a.C.F.get(b))?-1===a.Ja.indexOf(b)?(b=nn(w(function(e){e.dispatchEvent("load")},a,c),1E4),b=w(function(e,f,h){this.D.Xea("docs-extensions-menu");e.yg(!0);e.OG();on(h);f()},a,c,d,b),a.Ea.Nc(c,"load",b)):(a.D.Xea("docs-extensions-menu"),c.rI(),c.yg(!0),c.OG(),d()):d()}function qXi(a,b){ax()&&(fs(a,"ia-menu"),b||fs(a,"ia-primary-menu"))};function vYi(a,b){var c=a.wva,d=a.iL;a='<div class="'+U(a.Ds)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+U("addon-sidebar-header")+'"><div class="'+U("addon-sidebar-title")+'" id="addon-sidebar-title">';a=a+"Document add-ons</div>"+(Eu({Jd:"addon-sidebar-close docs-material",content:Jr(""+gw(c)),style:4,title:"Close sidebar"},b)+'</div><div class="'+U("addon-sidebar-content")+'"><div class="'+U("addon-sidebar-banner")+'"></div><div class="'+
U("addon-sidebar-introduction")+'"></div></div><div class="'+U("addon-sidebar-empty-caption")+'"><div class="'+U("addon-sidebar-empty-title")+'">');a=a+'No document add-ons</div><div class="'+(U("addon-sidebar-empty-description")+'">');return T(a+"This document doesn't include any add-ons</div></div></div>")}
function wYi(a){var b=a.JFb;a=a.GFb;return T('<img class="'+U("addon-sidebar-banner-image")+'" src='+Mr(Or(b))+" alt="+Mr(a)+' /><div class="'+U("addon-sidebar-banner-image-overlay")+'"></div>')};function xYi(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled;a=a.CBc;return T('<div class="'+U("addon-sidebar-card")+'" aria-label="'+U(c)+'" tabindex="0" role="region"><div class="'+U("addon-sidebar-card-header")+'"><div class="'+U("addon-sidebar-card-icon")+'">'+(b?'<img class="'+U("addon-sidebar-card-icon-image")+'" src='+Mr(Or(b))+" alt="+Mr(c)+" />":"")+'</div><div class="'+U("addon-sidebar-card-header-content")+'"><div class="'+U("addon-sidebar-card-title")+'"><div class="'+
U("addon-sidebar-card-title-caption")+(a?" "+U("addon-sidebar-card-two-line-title-caption"):"")+'">'+Er(c)+"</div>"+(f?T('<div class="'+(U("addon-sidebar-card-check")+'"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="')+U("#455A64")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>'):"")+'</div><div class="'+
U("addon-sidebar-card-category")+'">'+Er(d)+"</div></div></div>"+(e?'<div class="'+U("addon-sidebar-card-summary")+'">'+Er(e)+"</div>":"")+"</div>")};function yYi(){}v(yYi,dD);yYi.prototype.kc=m("docs-material-menu-button-flat-primary");yYi.prototype.Qn=function(){return Br(Wmc,{className:"docs-material-menu-button-flat-primary-dropdown"})};Ca(yYi);function zYi(a,b,c,d,e){c=void 0===c?yYi.getInstance():c;Qt.call(this,a,b,c,d,e)}v(zYi,Qt);function AYi(){}v(AYi,dD);AYi.prototype.kc=m("docs-material-menu-button-raised-primary");AYi.prototype.Qn=function(){return Br(Wmc,{className:"docs-material-menu-button-raised-primary-dropdown"})};Ca(AYi);function BYi(a,b,c,d,e){c=void 0===c?AYi.getInstance():c;Qt.call(this,a,b,c,d,e)}v(BYi,Qt);function CYi(a,b,c,d,e){B.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.eb=e||Sl()}v(CYi,B);
function DYi(a,b){if(!b)return EYi(a);b=b.vh();if(1==b.length&&J(b[0],3)){var c=EYi(a);b=b[0];c.Oa(!!si(b,7));b=new gWi(J(b,4),J(b,3),void 0,J(b,9)||void 0);su(a.D,c,O("macros-exec"),{enabled:!0},xe(b),a.F);return c}c=new Jt(a.eb);for(var d=0;d<b.length;d++)c.Ha(FYi(a,b[d]),!0);b=[jm("Use")];a=a.C?new BYi(b,c,void 0,a.eb):new zYi(b,c,void 0,a.eb);a.Xd("Use");a.Ob("addon-sidebar-card-menu-button");a.Oa(!0);return a}
function FYi(a,b){if(J(b,3)){var c=b.Rg(),d=new Et("");d.Ob(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([jm(c)]);c=new gWi(J(b,4),J(b,3),void 0,J(b,9)||void 0);su(a.D,d,O("macros-exec"),{enabled:!0},xe(c),a.F);d.Oa(!!si(b,7));return d}if(!b.Rg())return new It;if(0<b.vh().length){d=new Jt(a.eb);c=b.vh();for(var e=0;e<c.length;e++)d.Ha(FYi(a,c[e]),!0);b=new Pt(b.Rg());b.Ob(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.re(d);return b}throw Error("Unsupported menu item type.");}function EYi(a){var b=[jm("Use")];a=a.C?new kuf(b,a.eb):new hP(b,a.eb);a.Xd("Use");a.Ob("addon-sidebar-card-button");a.Oa(!1);return a};function GYi(a,b,c,d,e){S.call(this,e);this.C=a;this.ma=b;this.R=si(this.C,19)||!1;this.H=!(!si(this.C,10)&&!si(this.C,9));this.L=new qu(void 0,void 0,!0,uw.getInstance());this.oa(this.L);this.ea=wWi(10,this.C);this.J=new jt(void 0,void 0,e);this.oa(this.J);this.F=new CYi(this.L,c,this.ea,d,e);this.oa(this.F);if(this.H)a=DYi(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Mu(),Ju:c="Add to Docs";break a;case Mu(),Lu:c="Add to Slides";break a;case Mu(),Ku:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[jm(c)];d=a.C?new kuf(d,a.eb):new hP(d,a.eb);d.Xd(c);d.Ob("addon-sidebar-card-button");d.Oa(!1);su(a.D,d,O("macros-extension-install-start"),{enabled:!0},xe(S7(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new hP([jm("Help")],a.eb);c.Xd("Help");c.Ob("addon-sidebar-card-button");c.Oa(!1);c.Yd("Help");su(a.D,c,O("macros-extension-help"),{enabled:!0},xe(S7(b)),a.F);this.O=c}v(GYi,S);
GYi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=J(this.C,15)||"";a&&(a=gl(new fl(a),"https").toString());var b=this.qa();a={icon:a,title:this.C.getName(),category:this.C.Mj(),isInstalled:this.H,summary:J(this.C,14),CBc:Mf};b=Br(xYi,a,void 0,b);this.mb(b);this.Gc(b)};GYi.prototype.Gc=function(a){S.prototype.Gc.call(this,a);a=this.Da("addon-sidebar-card-title-caption");Xr(a,"button");this.Ha(this.J);this.J.Wa(a)};
GYi.prototype.Ia=function(){S.prototype.Ia.call(this);su(this.L,this.J,O("macros-manage-extensions"),{},xe(T7(this.C)),this.ea);HYi(this);!this.H&&this.R&&(this.Ha(this.O,!0),this.O.Oa(!0))};GYi.prototype.Na=function(){Wf(this.D);Wf(this.O);S.prototype.Na.call(this)};function IYi(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),Wf(a.D),a.D=DYi(a.F,b),a.xb()&&HYi(a))}
function HYi(a){a.Ha(a.D,!0);a.H||(a.D.Oa(a.ma&&!a.R),a.ma?a.R&&a.D.Yd("Add-on not available in G Suite Marketplace"):a.D.Yd("Disabled for your organization"))};function JYi(a,b,c){MR.call(this,c);this.D={};this.C=[];this.R=!1;this.H=a;this.ma=b;this.J={};this.F=new eK(this.qa(),"addon-sidebar-spinner");this.Ha(this.F);this.O=new Fu(void 0,this.qa());this.L=this.ea=!1}v(JYi,MR);p=JYi.prototype;p.Ca=function(){MR.prototype.Ca.call(this);var a={Ds:"addon-sidebar",wva:Rp("close-white"),iL:y(A(),"docs-eal")};a=Br(vYi,a,void 0,this.qa());this.mb(a);this.Gc(a)};
p.Gc=function(a){MR.prototype.Gc.call(this,a);this.F.render(this.zb());a=this.F.La();bs(a,"Loading");Xr(a,"status");Zr(a,"live","polite")};p.Ia=function(){MR.prototype.Ia.call(this);KYi(this,!1);LYi(this,!1);this.O.Wa(this.Da("addon-sidebar-close"));this.getHandler().Ye(this.O.La(),Cl,w(this.kOa,this)).listen(this.getElement(),"keyup",this.Zfc);this.ea&&sXi(this)};p.zb=function(){return this.bb("addon-sidebar-content")};
function sXi(a){a.F.setVisible(!1);LYi(a,a.H);KYi(a,0==a.C.length);MYi(a,a.L);NYi(a);od(a.C,function(b){var c=S7(b);b=new GYi(b,this.R,this.L,this.ma,this.qa());IYi(b,this.J[c]);this.Ha(b,!0);this.D[c]=b},a)}function NYi(a){ee(a.D,function(b){this.removeChild(b,!0);Wf(b)},a);oe(a.D)}function KYi(a,b){if(a.xb()){var c=a.Da("addon-sidebar-empty-caption");Q(c,b)}b&&LYi(a,!1)}
function LYi(a,b){if(a.xb()){var c=a.Da("addon-sidebar-introduction");b&&!ym(c)&&wm(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");Q(c,b)}}function rXi(a){return 0==a.C.length?null:(a=J(a.C[0],16)||J(a.C[0],17))?gl(new fl(a),"https").toString():null}
function MYi(a,b){if(a.xb()){js(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Da("addon-sidebar-banner");b?(b=rXi(a))&&zr(c,wYi,{JFb:b,GFb:a.C[0].getName()}):mm(c)}}p.bLb=function(a,b){return Wd(a.getName(),b.getName())};p.Zfc=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.kOa(),a.stopPropagation())};p.kOa=function(){this.setVisible(!1);LYi(this,!1);this.H=!1;O("docs-focus-editor").kb()};p.Vg=m(!1);function OYi(a,b){YR.call(this,a,b)}v(OYi,YR);OYi.prototype.wm=function(){return O("macros-addon-sidebar-focus")};OYi.prototype.Bf=function(){return O("macros-addon-sidebar")};OYi.prototype.np=function(a){var b=this.Pb;b.xb()||b.render();YR.prototype.np.call(this,a)};OYi.prototype.K9a=function(a){a&&this.Bf().isVisible()&&this.np(!0)};function PYi(a,b,c){this.C=a;this.F=b;this.D=c;Object.defineProperties(this,{path:{get:w(this.hwb,this),set:w(this.mxc,this)},invoke:{get:w(this.ARb,this),set:w(this.jxc,this)},arity:{get:w(this.uMb,this),set:w(this.Swc,this)}})}p=PYi.prototype;p.hwb=g("C");p.mxc=da("C");p.ARb=g("F");p.jxc=da("F");p.uMb=g("D");p.Swc=da("D");function QYi(a,b,c,d,e){S.call(this,e);this.L=a;this.D=b;this.J=c;this.C=d}v(QYi,S);
QYi.prototype.Ca=function(){var a=hd(A(),"docs-tfh"),b=this.L;a&&(b=Ie(b,{allow_parent:a}));a=CXa(this.qa());lf(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.mb(a);va("payload",this.D,a);va("adapter.hostFunctions",this.J,
a);Oa("adapter.getSessionId",w(this.H,this),a);Oa("adapter.getState",w(this.F,this),a)};QYi.prototype.Vg=m(!1);QYi.prototype.H=function(){var a=this.C().C;return null!==a?String(a):null};QYi.prototype.F=function(){return this.C().getState()};function RYi(a,b,c,d,e,f,h,k,l){Xv.call(this,void 0,void 0,l);var n=w(this.setVisible,this,!1),q=w(this.H,this),t=w(this.F,this);e&&this.setTitle(e);this.Lg=f||500;this.We=h||300;this.C=new QYi(a,b,[new PYi("google.script.host.close",n,0),new PYi("google.script.host.closeDialog",n,0),new PYi("google.script.host.editor.focus",w(d.Db,d,3),0),new PYi("google.script.host.setWidth",q,1),new PYi("google.script.host.setHeight",t,1)],c,l);this.Ha(this.C);Ds(this,!!k);Hs(this,null)}v(RYi,Xv);
RYi.prototype.H=function(a){!isFinite(a)||0>a||Xq(this.zb(),Math.min(a,Math.floor(.8*dm().width)))};RYi.prototype.F=function(a){!isFinite(a)||0>a||Yq(this.zb(),Math.min(a,Math.floor(.8*dm().height)))};RYi.prototype.Ca=function(){Xv.prototype.Ca.call(this);fs(this.getElement(),"script-app-dialog");var a=this.zb();fs(a,"script-app-contents");Xq(a,Math.min(this.Lg,Math.floor(.8*dm().width)));Yq(a,Math.min(this.We,Math.floor(.8*dm().height)));this.C.render(a)};RYi.prototype.Vg=m(!1);function SYi(a){MR.call(this,a);this.C=this.D=this.F=this.H=null}v(SYi,MR);p=SYi.prototype;p.sea=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};p.focus=function(){this.C.getElement().focus()};p.zb=g("D");
p.Ca=function(){var a=this.qa(),b={id:this.getId(),Ds:"script-application-sidebar",Rjc:"script-application-sidebar-header",eba:"script-application-sidebar-title",zHb:"script-application-sidebar-close",QY:"script-application-sidebar-content",wva:Rp("close-white"),iL:y(A(),"docs-eal")};b=Br($Xi,b,void 0,a);this.mb(b);this.H=a.bb("script-application-sidebar-title",b);this.F=a.bb("script-application-sidebar-close",b);this.D=a.bb("script-application-sidebar-content",b)};
p.Ia=function(){MR.prototype.Ia.call(this);this.getHandler().Ye(this.F,Cl,w(this.sea,this))};p.Vg=m(!1);p.Na=function(){delete this.H;delete this.F;delete this.D;delete this.C;MR.prototype.Na.call(this)};function TYi(a,b){YR.call(this,a,b)}v(TYi,YR);TYi.prototype.wm=function(){return O("macros-application-focus")};TYi.prototype.Bf=function(){return O("macros-application-sidebar")};function UYi(a,b){var c=null;c=c||ur("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});nf(c.location,a);b!=ya&&(a=new tgc(function(){return c?c.closed:!0}),a.Dx=b,a.start(100,-1))};function VYi(a,b,c,d,e){Xv.call(this,void 0,!0,c);this.H=a;this.F=d||ya;zs(this,b);this.setVisible(!0);this.Ni=!0;Gs(this,!1);Hs(this,(new Es).tf(bYa,!0).tf(Ls,!1,!0));this.setTitle(e||"Authorization Required");Ts(this,bYa.key)}v(VYi,Xv);VYi.prototype.Ia=function(){Xv.prototype.Ia.call(this);this.addEventListener("dialogselect",this.C)};VYi.prototype.Ad=function(){Xv.prototype.Ad.call(this);this.removeEventListener("dialogselect",this.C)};
VYi.prototype.C=function(a){"cancel"!=a.key?UYi(this.H,this.F):this.F();this.setVisible(!1)};function WYi(a){Xv.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Ni=!0;this.setTitle("Message details");Hs(this,cYa())}v(WYi,Xv);WYi.prototype.Ca=function(){Xv.prototype.Ca.call(this);var a=this.zb();fs(a,"script-error-dialog-content");this.C=jm(this.F);a.appendChild(this.C)};WYi.prototype.Na=function(){Xv.prototype.Na.call(this);this.C&&om(this.C)};function XYi(a){B.call(this);this.C=a}v(XYi,B);function YYi(a,b){var c=$d("Running script ");c=fm("SPAN",null,c);b=b?Qu(c,"Cancel",b,"info",!0):Pu(c,"info",!0);a.C.postMessage(b);return b.getId()}function ZYi(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(uf(b)+" experienced an error");b=fm("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Qu([b],"Details",function(){(new WYi(d)).setVisible(!0)},"warning",!0))}XYi.prototype.Na=function(){delete this.C};function $Yi(){B.call(this);this.C=null;this.D=new Kl;this.oa(this.D)}v($Yi,B);$Yi.prototype.Na=function(){aZi();bZi(this);B.prototype.Na.call(this)};function bZi(a){a.D.Rc();a.C&&(a.C.dispose(),a.C=null);aZi()}function aZi(){var a=Xl("docs-script-button-bar");a&&mm(a)};var cZi=new KF(["http","https"]);function dZi(a){a=Af(a);if(Zd(a)||ae(a,'"'))return null;var b=Qk(1,a);return b?cZi.contains(b.toLowerCase())?a:null:null};function eZi(a,b,c,d,e,f,h){h=void 0===h?!1:h;Xv.call(this);this.Ti=Zd(Af(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.xa=d;this.H=dZi(e);this.ea=dZi(f);this.L=h;this.R=rr(this,fZi);this.C=gS("Learn more");this.Ha(this.C);this.F=new Fu("Report an issue");this.Ha(this.F);this.O=new Fu("View in store");this.Ha(this.O);this.setTitle($d("Help for "+a));a=new Es;a.tf({key:Ls.key,caption:"Close"},!1,!0);Hs(this,a);Ts(this,"ok")}v(eZi,Xv);p=eZi.prototype;
p.Ca=function(){Xv.prototype.Ca.call(this);var a=this.zb();zr(a,eYi,{description:this.Ti,ids:this.R,xlc:this.L});fs(a,"script-help-dialog")};
p.Ia=function(){Xv.prototype.Ia.call(this);var a=this.qa().getElement(this.R.oca);this.L?(this.F.render(a),this.getHandler().listen(this.F,"action",this.w1a),this.C.render(a),this.getHandler().listen(this.C,"action",this.lOa)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.lOa)),this.F.render(a),this.getHandler().listen(this.F,"action",this.w1a),this.O.render(a),this.getHandler().listen(this.O,"action",this.Hic))};
p.lOa=function(){this.L?ur("https://support.google.com/docs?p=GSM_migration"):this.H&&ur(this.H)};p.w1a=function(){this.ea?ur(this.ea):(this.ma(),this.dispose())};p.Hic=function(){this.xa();this.dispose()};var fZi={oca:"script-help-dialog-buttonbar"};function gZi(a,b,c,d){wl.call(this,"Yl");this.title=d}v(gZi,wl);function hZi(a,b,c,d,e,f){Xv.call(this,void 0,void 0,f);this.H=b;this.F=d;this.L=e;this.C=null;this.setTitle(a);Ds(this,!0);a=new Es(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,iZi[d]);a.D="0";Hs(this,a)}v(hZi,Xv);p=hZi.prototype;p.Ca=function(){Xv.prototype.Ca.call(this);var a=this.qa(),b=this.zb();fs(b,"script-prompt-contents");for(var c=a.Ca("DIV"),d=this.H.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ca("BR")),c.appendChild(Gm(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ca("INPUT"),b.appendChild(this.C))};
p.Vg=m(!1);p.Ia=function(){Xv.prototype.Ia.call(this);this.getHandler().listen(this,"dialogselect",w(this.iwb,this))};p.focus=function(){Xv.prototype.focus.call(this);this.C&&this.C.focus()};p.iwb=function(a){this.L(Number(a.key),this.F?this.C.value:null)};var iZi={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function jZi(a,b){Xv.call(this);this.H=a;this.F=b;Hs(this,(new Es).tf({key:"send",caption:"Send"},!0).tf({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new Bu;this.Ha(this.C)}v(jZi,Xv);p=jZi.prototype;p.Ca=function(){Xv.prototype.Ca.call(this);Ts(this,"send");var a=this.zb();fs(a,"script-reportissue-dialog-content");zr(a,fYi,{aLb:this.F})};
p.Ia=function(){Xv.prototype.Ia.call(this);this.C.Wa(this.Da("script-reportissue-dialog-nonanonymous-checkbox"));this.Bbb();var a=this.getHandler();a.listen(this.Da("script-reportissue-dialog-description"),"input",this.Bbb);a.listen(this,"dialogselect",this.jwb)};p.Od=function(){return this.Da("script-reportissue-dialog-description").value};p.Bbb=function(){var a=!Zd(this.Od());Js(this.D,"send",a)};p.jwb=function(a){if("send"!=a.key)return!0;this.H(this.Od(),this.C.isChecked());return!0};function kZi(a,b){B.call(this);this.D={};this.F={};this.L=0;this.J=b;this.C=a;this.C.vK(w(this.kwb,this))}v(kZi,B);p=kZi.prototype;p.connect=function(a){this.C.isConnected();this.C.connect(a)};p.isConnected=function(){return this.C.isConnected()};p.I8b=function(a,b){var c=lZi(this,b[0]),d=lZi(this,b[1]);b=Id(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
p.kwb=function(a,b){if(Sd(a,"callback.")&&le(this.D,a)){var c=sfa(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(pe(this.D,d),pe(this.F,a),pe(this.F,d));pe(this.D,a);c.call(this,b)}};function lZi(a,b){return w(function(c){c=null!=c?kn(c):null;this.C.send(b,c)},a)}p.Na=function(){B.prototype.Na.call(this);delete this.J;delete this.D;delete this.F;delete this.L;delete this.C};function mZi(a,b,c,d){c=new $B({role:0,ph:c,cn:"ide.api.ch",tp:1});c.oz=b;kZi.call(this,c,d||5E3);this.H=a;a=w(this.O,this);this.C.zf("method.getContainerInfo",w(this.I8b,this,a),!0)}v(mZi,kZi);mZi.prototype.O=function(){return NYe(this.H.call())};mZi.prototype.Na=function(){var a=this.C;kZi.prototype.Na.call(this);a.dispose();delete this.H};function nZi(a,b,c,d,e){B.call(this);this.H=a;this.L=b;this.R=c;this.F=d||null;this.J=e||null;this.C=this.D=null}v(nZi,B);nZi.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;nf(this.D.location,this.H)}else this.D=ur(this.H,{target:this.L});if(this.J)try{this.C=new mZi(this.J,this.D,this.R),this.C.connect(),nn(w(this.O,this,!0),1E5)}catch(a){this.C=null}};
nZi.prototype.O=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};nZi.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};nZi.prototype.Na=function(){B.prototype.Na.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function oZi(a,b,c,d,e,f,h,k,l){Gl.call(this);this.R=[];this.Ja=!!k;this.F=a;this.O=b;this.oa(this.O);this.Ea=new $Yi;this.oa(this.Ea);this.C=new XYi(Nu.getInstance());this.oa(this.C);this.D=null;this.xa=new TYi(new SYi,l);this.ea=null;e&&(this.ea=new OYi(new JYi(f,h),l));this.H=new lYi(void 0,k);this.H.Vd(this);this.oa(this.H);this.F.Ah(this.H);this.ma=c;this.Aa=d;this.L=this.J=null}v(oZi,Gl);function hXi(a){return a.ea?a.ea.Pb:null}p=oZi.prototype;p.qc=g("Ja");
function pZi(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Li(e,KWi,4),h=0;h<f.length;h++){var k=f[h];k=new kYi(e.getId(),e.getName(),k.getName());c.Ha(k,!0)}0===c.jc()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function qZi(a,b){var c=Xl("docs-script-button-bar");c&&(mm(c),Zd(Af(a))||(a=new Fu(a),a.Ob("docs-titlebar-button"),a.render(c),Al(a,"action",b)))}
function iXi(a,b,c){a.L&&!a.L.isDisposed()&&(Yv(a.F,a.L),a.L.dispose());a.L=new jZi(b,c);a.L.Ni=!0;a.F.Ah(a.L);a.L.setVisible(!0)}
p.Byc=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Er(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Nr(e))+'" target="_blank">'+(Er(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Nr(e))+'" target="_blank">'+(Er(a)+" help</a>.")),c+=a),c+="</p>");c=T(c);
oYe(d,"Report an issue",yr(c),void 0,void 0,"Close")};p.Ayc=function(){oYe(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function gXi(a){a.dispatchEvent("am")&&(a=a.Aa,a.C.isVisible()&&a.C.hide(),a.D.xb()||a.D.render(a.F||void 0),a.D.show())}p.uO=function(){this.dispatchEvent("Xl")&&this.Aa.D.hide()};p.mtc=function(a,b,c,d,e){a=new nZi(a,"MacroService"+Gha(c),b,e,d);this.R.push(a);a.open()};p.Z0=function(a){ur(a)};
p.Na=function(){Gl.prototype.Na.call(this);Xf(this.R)};function rZi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,K,P,R,ba){u=void 0===u?!1:u;z=void 0===z?null:z;P=void 0===P?!1:P;B.call(this);this.L=a;this.R=l;this.Ta=k;this.Aa=n;this.O=b;this.xa=c;this.J=d;this.D=K;this.H=new Kl(this);this.oa(this.H);this.Qa=q;this.Ra=z;this.ma=new XXi(this.xa,this.J);this.oa(this.ma);this.Pa=P;a=this.Aa;c=this.Pa;u=void 0===u?!1:u;this.C=new oZi(e,h,q,t,sZi(a),c,a,u,E);this.oa(this.C);this.Ja=new HWi;h=0;b.D?b.C&&(h=2):h=1;this.F=new YWi(this.Aa,e,f,this.C,this.Ja,this.L,this.xa,
this.R,h,this.D,R,ba);this.oa(this.F);this.Ea={};this.ea=this.Ma=null}v(rZi,B);p=rZi.prototype;
p.start=function(){if(Zn(this.L.F,1,1)){this.H.listen(this.J,"amep",w(this.lwb,this));this.H.listen(this.J,"stbep",w(this.twb,this));this.H.listen(this.J,"sttep",w(this.uwb,this));this.H.listen(this.J,"spep",w(this.rwb,this));this.H.listen(this.J,"saep",w(this.pwb,this));this.H.listen(this.J,"snep",w(this.qwb,this));this.H.listen(this.J,"paep",w(this.nwb,this));this.H.listen(this.J,"rfep",w(this.owb,this));this.H.listen(this.C,"dialogselect",w(this.E3b,this));this.H.listen(rH.getInstance(),"Vc",w(this.mwb,
this));this.Ta(w(this.A3b,this));var a=this.L.C;O("macros-exec").Ab(wp,this.v3b,this);O("macros-resume").Ab(wp,this.odc,this);O("macros-manage").Ab(wp,w(a.Us,a,w(this.i8b,this)));O("macros-editor").Ab(wp,this.CAa,this);O("macros-extensions").Ab(wp,w(this.i0a,this));O("macros-manage-extensions").Ab(wp,w(this.h8b,this));O("macros-extension-menu-promo").Ab(wp,w(this.i0a,this));O("macros-extension-disabled").Ab(wp,this.L1b,this);O("macros-extension-help").Ab(wp,this.M3b,this);O("macros-extension-install-start").Ab(wp,
this.S6b,this);O("macros-trigger-0").Ab(wp,w(this.OE,this,"0"));O("macros-trigger-1").Ab(wp,w(this.OE,this,"1"));O("macros-trigger-2").Ab(wp,w(this.OE,this,"2"));O("macros-trigger-3").Ab(wp,w(this.OE,this,"3"));O("macros-trigger-4").Ab(wp,w(this.OE,this,"4"));O("macros-trigger-5").Ab(wp,w(this.OE,this,"5"));O("macros-trigger-6").Ab(wp,w(this.OE,this,"6"));O("macros-trigger-7").Ab(wp,w(this.OE,this,"7"));O("macros-trigger-8").Ab(wp,w(this.OE,this,"8"));O("macros-trigger-9").Ab(wp,w(this.OE,this,"9"));
this.ma.start();tZi(this.Aa,this.Pa)&&(O("macros-addon-sidebar-focus").Oa(!0),O("macros-addon-sidebar-focus").kb(void 0,wWi(19)));oYi(new nYi(this.O,this.F));a=this.O.O;var b=!this.O.C,c=this.xa,d=this.R().getState()||void 0;d=["ruid",Ha({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);$o(bp(U7(c,c.C.Ja),"POST").setContent(""),d).Gr().Se()}};
function uZi(a){pZi(a.C,null);var b=w(function(c){c.rr()?pZi(this.C,Li(c,MWi,2)):(this.C.C.C.postMessage(Pu("Could not load scripts.","warning",!0)),pZi(this.C,[]))},a);VWi(a.xa,b)}
function vZi(a,b,c,d,e,f){if(d){gXi(a.C);var h=w(function(){var t=tXi(this.F,b);t&&!si(t,4)&&(L(t,4,!0),jXi(this.F))},a);var k=w(function(){this.C.uO();this.L.Pq.dispatchEvent(new xn(!0))},a);var l=w(function(t){this.C.uO();8!=t.sF()&&ZYi(this.C.C,c,t.Kf())},a);fXi(a.F)}else{var n=YYi(a.C.C),q=w(function(t){this.ma.F.cancel(t);Ou(this.C.C.C,n)},a);h=w(function(t){Ou(this.C.C.C,n);n=YYi(this.C.C,Ia(q,t))},a);k=w(function(t){Ou(this.C.C.C,n);if(t.o7()){t=this.C.C;var u=$d("Canceled script ");t.C.postMessage(Pu(u,
"info",!1,2500))}else t=this.C.C,u=$d("Finished script "),t.C.postMessage(Pu(u,"info",!1,2500));this.L.Pq.dispatchEvent(new xn(!0))},a);l=w(function(t){Ou(this.C.C.C,n);8!=t.sF()&&ZYi(this.C.C,c,t.Kf())},a)}a.Qa.Db(3);zqe(a.L.C,w(a.Tvc,a,b,c,h,k,l,d,e,f))}p.Tvc=function(a,b,c,d,e,f,h,k){var l=this.R().getState()||void 0,n=this.ma;c=void 0===c?ya:c;d=void 0===d?ya:d;e=void 0===e?ya:e;e=w(n.dwb,n,a,b,c,d,e);n.F.n3a(a,b,l,e,f,h,k)};
p.mwb=function(a){var b=Gd(this.F.D),c={};b=ha(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+S7(d)]={name:d.getName(),"cws-id":J(d,1),"gsm-application-id":J(d,18),"app-key":S7(d)};ue(a.oG,c)};p.L1b=function(a){a.data==this.Ma&&(a=this.C,a.dispatchEvent("Wl")&&a.xa.Pb.sea())};
p.lwb=function(a){a=a.C().Bb();var b={},c=wZi(this,a);if(1==ui(a,11,0)){var d=J(a,4);d=tXi(this.F,d)}else d=void 0;var e=d,f=e&&(si(e,10)||si(e,9))||!1,h=e&&si(e,19)||!1;d=this.Ja;var k=c,l=J(a,4),n=1==ui(a,11,0);f=new FWi(a,k,n,f,h);f.setVisible(!0);0==ui(a,11,0)&&(l=f.getLabel());d.C[ui(a,11,0)][l]=f;d.dispatchEvent("$l");(d=hXi(this.C))&&J(a,9)&&(1==J(a,12)||5==J(a,12))&&(l=J(a,4),d.J[l]=a,l&&l in d.D&&IYi(d.D[l],a));c=c.reverse();if(d=this.C.O){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])Bi(f,
5);else{if(this.Ea[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=nu(O("macros-exec"),[k]),n=0;n<d.ma.length;n++){var q=d.ma[n];ym(q)==k&&wm(q,"")}this.Ea[h]=f.Ie();b[h]=!0}if(1==ui(a,11,0)){b=null!=e?e:null;c=[];e=J(a,4);f=!!J(a,9)&&3!=J(a,12);l=d.C.F.get(e);l||(l=new Pt(""),l.wc(e),h=J(a,10),l.setContent(jm(h)),l.Oa(2==d.R?!1:f&&1==d.R?!1:!0),d.J.Rc(),mXi(d.C,l),nXi(d));f||d.ea.push(e);f=new Jt;!b||si(b,10)||si(b,9)||si(b,19)||(oXi(d,f,b),h=new hWi,k=String(Ha(h)),L(h,1,k),f.Ha(uYi(d,h,c),!0));h=
b&&(si(b,10)||si(b,9))||!1;if(!b||h||!si(b,19))for(a=a.vh(),h=0;h<a.length;++h)f.Ha(uYi(d,a[h],c,void 0,b?b:void 0),!0);b&&pXi(d,f,e,c,b);d.xa[e]=c;l.re(f);qXi(f.La(),!0);l.dispatchEvent("load");d.Ja.push(e)}else{b=a.Rg();if(d.RA(b)){d.RA(b);c=d.H[b];delete d.H[b];d.D.removeChild(c,!0);if(d.L)for(e=d.Aa[b],l=0;l<e.length;++l)d.L.uR(e[l]);delete d.Aa[b];c.dispose()}10<=ie(d.H)||(b=[],a.vh(),c=a.Rg(),a=uYi(d,a,b,"Ctrl+Alt+Shift+").Bb(),qXi(a.La(),!1),a=new Xu(c,a,rYi.getInstance(),void 0,!0),e=d.D.jc()?
d.D.jc()-1:0,d.D.Af(a,e,!0),d.H[c]=a,d.Aa[c]=b)}}};p.twb=function(a){a=a.C();var b=a.Rg();b?qZi(b,w(function(c){var d=Af(c.getUrl());Zd(d)||this.C.Z0(d);d=Af(c.getFunctionName());Zd(d)||vZi(this,J(c,1),d,J(c,4)||void 0,void 0,c.$q()||void 0)},this,a)):aZi()};
p.uwb=function(a){var b=a.C();a=b.getText();b=b.jk();var c=this.C.Ea,d=Xl("docs-script-button-bar");d&&(bZi(c),Zd(Af(a))||(a=Br(aYi,{caption:a}),lm(d,a),Zd(Af(b))||(c.C=new xt,c.C.Ob("docs-script-button-bar-bubble"),c.C.setContent(Br(bYi,{text:b})),c.C.Bi(a),yt(c.C,!0),c.C.gC=!1,c.C.setPosition(1,1),c.C.Uo(!1),c.C.render(d),c.D.listen(a,"mouseover",w(c.C.setVisible,c.C,!0)).listen(a,"mouseout",w(c.C.setVisible,c.C,!1)))))};
p.rwb=function(a){this.C.uO();var b=a.C(),c=yi(b,6,!1);a=c?J(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):J(b,3);var d=J(b,7),e=this.C,f=b.getTitle(),h=J(b,4),k=yi(b,5,!1);b=w(this.Nbc,this,J(b,1),c,d);e.D&&(e.D.setVisible(!1),Yv(e.F,e.D));e.D=new hZi(f,a,h,k,b);e.D.Ni=!0;e.F.Ah(e.D);e.D.setVisible(!0)};p.Nbc=function(a,b,c,d,e){var f=new CXi;L(f,1,d);L(f,3,b);L(f,4,c);null!==e&&L(f,2,e);O("macros-resume").kb([a,kn(f.Gb())])};
p.pwb=function(a){a=a.C();var b=nze(M(a,kS,9));var c={};c.mid=this.O.L;b=Ie(b,c);switch(a.Tk()){case 1:var d=this.C;c=J(a,3);var e=this.R,f=a.getTitle()||void 0;if(d.dispatchEvent(new gZi(b,c,e,f))){var h=d.ma;d=d.xa.Pb;d.xb()||(d.render(),d.resize());d.sea();var k=d.qa();k.Ce(d.H,f||"Apps Script application");f=w(h.Db,h,3);d.C=new QYi(b,c,[new PYi("google.script.host.close",w(d.sea,d),0),new PYi("google.script.host.editor.focus",f,0)],e,k);Yf(d.C,f);d.Ha(d.C,!0);O("macros-application-focus").kb()}this.Ma=
J(a,7)||null;break;default:c=this.C,e=J(a,3),f=this.R,h=a.getTitle()||void 0,d=a.getWidth()||void 0,k=a.getHeight()||void 0,a=yi(a,8,!1),c.D&&(c.D.setVisible(!1),Yv(c.F,c.D)),c.D=new RYi(b,e,f,c.ma,h,d,k,a),c.D.Ni=!0,c.F.Ah(c.D),c.D.setVisible(!0)}};p.qwb=function(a){a=a.C();var b=a.getType();this.Ra(b,a.getText(),a.getTitle()||void 0,J(a,4)||void 0)};
p.nwb=function(a){if(Us().C){if(!this.ea||this.ea.isDisposed()){a=Sl();var b=Cm(a,"docs-hub-open-external-appbarbutton");this.ea=new Hud(b,a,"A script attached to this file needs your permission to run. To give permission, open in a new tab and rerun the script.","Authorization required");this.oa(this.ea);lr(this.ea,b)}}else a=a.C(),(b=M(a,yXi,3))&&(pi(b,2)||pi(b,11))?(b=new oWi(J(b,2),J(b,11)),si(a,4)?(b=this.F.getExtension(b),null!=b&&si(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),
a=a.getUrl(),new VYi(a,(new $w).format(""),void 0,void 0,b)):(a=a.getUrl(),new VYi(a,(new $w).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.F.AV(b)):(a=a.getUrl(),new VYi(a,(new $w).format("A script attached to this document needs your permission to run."),void 0,void 0,void 0))};p.owb=function(a){a=a.C();vZi(this,J(a,1),a.getFunctionName(),J(a,4)||void 0,void 0,a.$q()||void 0)};
p.v3b=function(a){a=a.data;var b=tXi(this.F,a.C);!b||si(b,9)?vZi(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.F.AV(T7(b))};p.odc=function(a){gXi(this.C);var b=a.data;a=b[0];b=b[1];var c=w(function(){this.C.C.C.postMessage(Pu("Error resuming script execution","warning",!0))},this);YXi(this.ma,a,b,c)};p.i8b=function(){this.C.H.setVisible(!0);uZi(this)};
p.CAa=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new fl(vXi(this.O,a?a:void 0));b&&(a=b.editorUri?new fl(b.editorUri):a,b.filename&&a.xc("f",b.filename),b.lineNumber&&(a.xc("l",b.lineNumber),a.xc("s",b.lineNumber)));b=this.L.D;var c=null;Fo(this.L.C)||(c=fje("Loading\u2026",{target:"MacroService"+Gha(b)}));this.L.C.Us(w(this.C.mtc,this.C,a.toString(),this.O.F,b,this.R,c))};p.i0a=function(){this.F.AV()};
p.h8b=function(a){if(a.data)this.F.AV(a.data);else{a=this.F;var b=eXi(a,!0),c=a.R;var d=c.F;b=BWi(d,d.D,b,void 0,!0);d=CWi(d,b);c.C=d;d=c.C;c.D.Ah(d);d.setVisible(!0);fXi(a)}};
p.M3b=function(a){var b=this.F,c=tXi(b,a.data);if(c){var d=T7(c);a=w(b.U7a,b,d,S7(c),c.getName(),J(c,6)||void 0,J(c,11)||void 0);d=w(b.AV,b,d);var e=si(c,19)||void 0,f=b.C,h=c.getName(),k=Af(J(c,7)),l=J(c,6)||void 0;c=J(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(Yv(f.F,f.J),f.J.dispose());f.J=new eZi(h,k,a,d,l,c,e);f.J.Ni=!0;f.F.Ah(f.J);f.J.setVisible(!0);fXi(b)}};
p.S6b=function(a){if(a.data){var b=tXi(this.F,a.data);if(null!=b)if(a=this.F,b=T7(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;oYe(a.ea,"Oops",b,void 0,void 0,"Close")}jXi(a)}else{var c=a.getExtension(b);c&&si(c,9)?(b=a.getExtension(b).getName(),b=$d(b+" is already installed"),a.C.C.C.postMessage(Pu(b,"info",!1,2500)),jXi(a)):a.AV(b)}}};
p.E3b=function(a){"edit"==a.key?(a=a.target.Ms.qf(),a=vXi(this.O,a?a.b4a:void 0),this.CAa(new xp({editorUri:a}))):"new"==a.key?this.CAa(new xp({editorUri:this.O.ea})):"reload"==a.key?uZi(this):"run"==a.key&&(a=a.target.Ms.qf(),vZi(this,a.b4a,a.getFunctionName(),void 0,void 0,a.$q()))};p.OE=function(a){(a=this.Ea[a])&&(a=tYi(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};p.A3b=function(){for(var a=this.C,b=0;b<a.R.length;b++){var c=a.R[b];c.close();c.dispose()}a.R=[]};
function wZi(a,b){var c=[];J(b,3)&&c.push(b);b=b.vh();for(var d=0;d<b.length;d++)c=c.concat(wZi(a,b[d]));return c}p.getView=g("C");function sZi(a){return a==(Mu(),Ju)||a==(Mu(),Lu)||a==(Mu(),Ku)}function tZi(a,b){return b&&(a==(Mu(),Ju)||a==(Mu(),Ku))};function xZi(a,b,c,d,e,f,h){B.call(this);var k=this;this.C=a;this.L=b;this.eb=e;this.F=d;this.ma=new Il;this.D=f;this.xa=h;this.R=new ou(this);this.oa(this.R);this.R.Ab(wlb,sp,this.J);this.ea=new Kl(this);this.oa(this.ea);this.ma.wb(this.F.F,function(){return k.J()});this.H=new e3a(this.eb.Lb(),!0);this.oa(this.H);this.O={};this.J()}v(xZi,B);xZi.prototype.J=function(){var a=yZi(this),b=this.L.Bb(Rz.getId(),!0);b.od(!0);gv(this.L,b,[new lQe(a,this.C)]);fs(b.getElement(),"waffle-action-menu")};
function yZi(a){var b=Array.from(a.F.C.values());tVi(b,function(t){return nh(t,8)});var c=Array.from(a.F.D.values());Av(a.xa,Ggd(0<b.length,0<c.length));Qz.setProperty("visible",!0);Pz.setProperty("visible",!0);var d={};c={};b=ha(b);for(var e=b.next();!e.done;c={Hpa:c.Hpa},e=b.next()){e=e.value;var f=nh(e,1),h=e.getFunctionName(),k=nh(e,8),l=jh(e,9)?nh(e,9):null,n="recorded-action-"+f+":"+h,q=a.C.Ne(n);q||(q=(new Tp(n)).enabled(!0),q.Fa(29583),q=q.build(),c.Hpa=new gWi(f,h,void 0,void 0,void 0,jh(e,
12)?e.$q():void 0),q.Ab(wp,function(t){return function(){a.C.Ga("macros-exec").kb(t.Hpa)}}(c)),G2a(a.H,[q]),a.C.Gn(q),a.D&&a.D.Vh(q));q.setProperty("label",k);zZi(a,l)&&q.setProperty("keys",[l]);null==l&&null!=q.getProperty("keys")&&q.setProperty("keys",null);d[n]=q}ee(a.O,function(t,u){d[u]||(t.setProperty("keys",null),a.C.sP(u),a.D&&a.D.uR(u),Wf(t))});a.O=d;return je(d)}function zZi(a,b){return!wlb.xd()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.C[jc(b)]||[]).length};function AZi(a,b){this.aGa=a;this.$na=b};function BZi(){var a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
EO(void 0,void 0,void 0,void 0,void 0,Jr('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>'));a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+EO(void 0,void 0,void 0,void 0,void 0,Jr('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>'));return T(a+"</div></div></div></div>")}
;function CZi(a,b){S.call(this,b);this.R=a;this.J=new At("",new ew,this.qa());this.Ha(this.J);this.F=new At("",new ew,this.qa());this.Ha(this.F);this.D=new qu;this.oa(this.D);this.H=null;this.C=0}v(CZi,S);p=CZi.prototype;p.Ca=function(){this.mb(Br(BZi))};
p.Ia=function(){S.prototype.Ia.call(this);this.O=new xV(this.qa(),void 0,"relative");this.L=new xV(this.qa(),void 0,"absolute");this.O.Wa(this.Da("waffle-recording-toast-relative"));this.L.Wa(this.Da("waffle-recording-toast-absolute"));var a=re(tu);qe(a,"selected",!0);var b=pq(new oq,6).build();su(this.D,this.O,Tz,a,void 0,b);su(this.D,this.L,Uz,a,void 0,b);su(this.D,this.J,this.R.Ga("recorded-action-stop"),void 0,void 0,b);su(this.D,this.F,Oz,void 0,void 0,b);this.H=new tJ(this.Da("waffle-recording-toast-expand"),
this.Da("waffle-recording-toast-bottom"),ylb.isVisible(),void 0,this.qa());this.oa(this.H);this.getHandler().listen(this.H,"toggle",this.Ccc);this.J.Wa(this.Da("waffle-recording-toast-stop"));this.F.Wa(this.Da("waffle-recording-toast-cancel"))};p.setVisible=function(a){var b=this.La();Q(b,a);Zr(b,"hidden",!a);a&&(a=this.qa().Lb(),a=em(a)||window,b=Zq(this.La()),this.La().style.left=Math.max(Math.floor(dm(a).width/2-b.width/2),0)+"px")};
function DZi(a,b){a.Da("waffle-recording-toast-default-content").style.opacity=0;var c=a.Da("waffle-recording-toast-new-content");a.qa().Ce(c,b);0!=a.C?EZi(a):(on(a.C),a.C=nn(function(){return EZi(a)},400))}function EZi(a){var b=a.Da("waffle-recording-toast-new-content");hs(b,"waffle-recording-toast-slide-in");on(a.C);a.C=nn(function(){fs(b,"waffle-recording-toast-slide-in");on(a.C);a.C=nn(function(){return FZi(a)},2200)})}
function FZi(a){var b=a.Da("waffle-recording-toast-default-content"),c=a.Da("waffle-recording-toast-new-content");hs(c,"waffle-recording-toast-slide-in");b.style.opacity=1;on(a.C);a.C=nn(function(){a.C=0},400)}p.Ccc=function(a){ylb.setVisible(a.JI)};p.Na=function(){on(this.C);S.prototype.Na.call(this)};function GZi(a,b,c,d,e){B.call(this);var f=this;this.L=a;this.J=c;this.D=d;this.C=N().GVb()(N().tu()(),N().fUb()(),V7(this),Tz.xd(),function(h){h="Action "+(N().FVb()(f.C)+(": "+h));HZi(f,h)},N().aZa()());N().rZa()(this.C);this.H=new CZi(e);this.oa(this.H);this.Ea=new ou(this);this.oa(this.Ea);this.Ea.Ab(Tz,wp,this.Cic,this).Ab(Uz,wp,this.Bic,this).Ab(O("docs-doc-copy-made"),wp,this.b2b,this).Ab(O("macros-exec"),wp,this.Mdc,this).Ab(lgb,wp,function(h){return IZi(f,h.data,2)},this).Ab(rgb,wp,function(h){return IZi(f,
h.data,3)},this).Ab(kgb,wp,function(h){return IZi(f,h.data,1)},this).Ab(mgb,wp,function(h){return IZi(f,h.data,5)},this).Ab(ghb,wp,function(h){return IZi(f,h.data,4)},this).Ab(Dx,wp,function(h){h=h.data;switch(h.F){case "all-objects-for-all-datasources":N().vVb()(f.C,V7(f));break;case "all-objects-for-single-datasource":N().wVb()(f.C,V7(f),h.D);break;case "specific-ids":var k=h.C;if(!(0<(y(A(),"feds")?N().jya()(k):[]).length)){var l=h.C[0];h=N().rF()(l);k=null;switch(h){case 4:k=JZi(f,l,!1);break;
case 1:case 3:case 5:(l=N().EWa()(l,iU(f.J)))&&0<l.length&&(k=eo(l[0]),k=po(oo(no(ho(),k.gb()),k.Zb()),k.Mb()).build(),l=wVi(),3==h?(xVi(l),Dh(l,6,k)):1==h?(xVi(l),Dh(l,5,k)):5==h&&(xVi(l),Dh(l,4,k)),k=l.build().pb());break;case 2:(l=N().DWa()(l))&&0<l.length&&(k=vVi(l[0]).build().pb())}k&&N().vZa()(f.C,V7(f),h,k)}}}).Ab(wgb,wp,function(){return N().xVb()(f.C,V7(f),!1)},this).Ab(jgb,wp,this.w0b,this).Ab(ngb,wp,function(h){return N().rVb()(f.C,V7(f),h.data.pb())},this);this.F=new Il;this.oa(this.F);
this.F.wb(a.$a,function(){N().LVb()(f.C,!0,V7(f))});this.F.wb(a.Pa,function(h){if(h.D){var k=h.C.D();"docs-edit"==k?"ritz-waffle"==h.C.C&&N().IVb()(f.C,V7(f)):"docs-undo"==k?(HZi(f,"Undo previous action"),N().MVb()(f.C)):"docs-redo"==k&&(HZi(f,"Redo previous action"),N().JVb()(f.C))}});this.F.wb(b.xa,function(h){h.C||N().CVb()(f.C,V7(f),h.D)});this.F.wb(this.D.yb,function(h){return KZi(f,h)});this.F.wb(this.D.Pc,function(){f.ma=V7(f)});this.F.wb(this.D.Lc,function(h){switch(h.D){case "find-next-occurrence":N().sVb()(f.C,
f.ma,V7(f),h.C.pb());break;case "replace-current-occurrence":N().yVb()(f.C,V7(f),h.C.pb())}f.ma=null});this.F.wb(this.D.$a.D,function(h){N().BVb()(f.C,V7(f),h.F,h.H,h.J,h.L,h.id,h.C,h.D)});this.F.wb(b.Pq,function(){N().pVb()(f.C,f.Aa,V7(f),f.xa);f.Aa=null;f.xa=null});this.F.wb(this.D.Qc,function(h){N().qVb()(f.C,f.O.D.C.pb(),h.getSelection().C.pb(),f.O.C.pb());f.O=null});this.ea=new Kl(this);this.oa(this.ea);this.O=this.ma=this.xa=this.Aa=this.R=null;this.ea.listen(this.D.C,"na",this.wwb).listen(this.D.C,
"ta",this.vwb);this.H.render();this.H.setVisible(!0);LZi(this);setTimeout(function(){return yG("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}v(GZi,B);p=GZi.prototype;p.vwb=function(){this.R=V7(this)};p.wwb=function(a){!a.nG&&$I(this.D)&&(void 0!==a.nY?(a=a.nY,N().DVb()(this.C,this.R,V7(this),a)):(a=this.D.C.C.Td(),DZi(this.H,"Activating sheet "+a),N().EVb()(this.C,this.R,V7(this),a)),this.R=null)};
function HZi(a,b){DZi(a.H,b);yG("Macro recorder "+b)}function MZi(a){return N().HVb()(a.C,V7(a))}p.Mdc=function(a){this.xa=a.data.functionName;this.Aa=V7(this)};function KZi(a,b){var c=V7(a);a.ea.Nc(a.D,"dc",function(){var d=V7(a);switch(b.H){case "adjust-next-data-region-edge":N().oVb()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":N().uVb()(a.C,c,d,b.D,b.C);break;case "select-all":N().zVb()(a.C,c,d);break;case "select-rows-columns":N().AVb()(a.C,c,d,"c"==b.F)}})}
p.b2b=function(a){a=a.data;N().tVb()(this.C,V7(this),a.C)};p.w0b=function(a){a=a.data;var b=this.L.C.getSelection();this.O=new NZi(a,b)};
function IZi(a,b,c){var d=N().vZa(),e=a.C,f=V7(a);a:switch(c){case 4:b=JZi(a,b,!0);break a;case 3:case 1:case 5:var h=RG(a.J);h?(a=to(a.L.C.getSelection()),OZi(b,a,h)?b=null:(a=wDc(h),OZi(b,a,h)?(b=UF(h.Sa().$f(a.y,a.x)),b=null!=b?b:po(oo(no(ho(),h.O.C.C.gb()),a.y),a.x).build(),h=wVi(),3==c?(xVi(h),Dh(h,6,b)):1==c?(xVi(h),Dh(h,5,b)):5==c&&(xVi(h),Dh(h,4,b)),b=h.build().pb()):b=null)):b=null;break a;case 2:if(h=RG(a.J)){a=a.L.C.getSelection();var k=K3e(h);b=k&&oh(a.C,6).Gb().includes(k)?null:(a=I3e(h))&&
b==J3e(h)?vVi(a).build().pb():null}else b=null;break a;default:b=null}d(e,f,c,b)}function OZi(a,b,c){if(!b)return!1;b=c.Sa().$f(b.y,b.x);c=vDc(c,b);return a==c}function JZi(a,b,c){if(c&&(a=a.D.C.C)&&rC(a))return null;b=N().FN()(b);if(!b)return null;(b=N().lT()(b))?(a=wVi(),xVi(a),b=yh(a,2,b).build().pb()):b=null;return b}p.Cic=function(){var a=!N().wZa()(this.C);PZi(this,!0);a&&(DZi(this.H,"Using relative references"),yG("Recording with relative references"))};
p.Bic=function(){var a=N().wZa()(this.C);PZi(this,!1);a&&(DZi(this.H,"Using absolute references"),yG("Recording with absolute references"))};function PZi(a,b){N().KVb()(a.C,b);Tz.rc(b);Uz.rc(!b)}function LZi(a){(a=RG(a.J))&&NL(a)}function V7(a){return a.L.C.getSelection().C.pb()}p.Na=function(){N().GYa()();B.prototype.Na.call(this)};function NZi(a,b){this.C=a;this.D=b};function QZi(a,b,c,d,e){hw.call(this,"Macro saved",Sl(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Ta=a;this.L=b;this.Ra=c;this.Ja=d;this.J=e}v(QZi,hw);QZi.prototype.Ca=function(){hw.prototype.Ca.call(this);var a=mr(this,"script-recorder-edit-link-id");this.Qs("EDIT SCRIPT",a)};QZi.prototype.Ia=function(){hw.prototype.Ia.call(this);this.getHandler().Ye(sr(this,"script-recorder-edit-link-id"),Cl,w(this.Qa,this,this.Ta,this.L,this.Ra))};
QZi.prototype.Qa=function(a,b,c){this.Ja.C(29645);this.J.Ga("macros-editor").kb(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function RZi(a,b,c,d,e,f,h,k,l,n){rv.call(this);var q=this;this.Aa=a;this.ma=b;this.Qa=c;this.Ma=d;this.ea=e;this.H=f;this.Ja=h;this.xa=k;this.L=n;this.J=this.H.ud();this.Ea=new ou(this);this.oa(this.Ea);this.F=null;this.R=!1;this.C=null;this.Pa=l;this.Ea.subscribe(Sz,"action",this.yxc).subscribe(this.J.Ga("recorded-action-stop"),"action",this.szc).subscribe(zlb,"action",this.Wvc).subscribe(Oz,"action",this.PGb).subscribe(Pz,"action",this.ayc).subscribe(Qz,"action",this.hyc);zv(this,SZi(this));zq(this.H,
this);a=["not-revisions","sheet-access-edit",Cv()];var t=new yq(a.concat(["docs-script-recording"]));od([Oz,this.J.Ga("recorded-action-stop"),zlb,xlb,Uz,Tz],function(u){q.H.C(u,t);q.H.D(u,t)});a=new yq(a.concat(["not-docs-script-recording"]));this.H.C(Sz,a);ax()||this.H.D(Sz,a)}v(RZi,rv);p=RZi.prototype;p.yxc=function(){var a=this;this.F=new GZi(this.Qa,this.Ma,this.ea,this.Ja,this.J);Av(this,SZi(this));this.Ja.D.C.Us(function(){ap(vk(bp(a.Aa.Pe("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Se()})};
p.szc=function(){SG(this.ea)&&QK(RG(this.ea),!0);this.F.H.setVisible(!1);N().GYa()();pVi(this.ma)};
p.Wvc=function(a){var b=this,c=a.aGa;a=a.$na;var d=MZi(this.F).sourceCode();TZi(this,kw(this.L,"Saving new macro",Sl(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.R=!0;Av(this,SZi(this));ap(wk(xk(vk(bp(uk(uk(So(this.Aa.Pe("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.NT("scriptId"),h=e.NT("filename");e=Number(PG(e,"lineNumber"));f=new QZi(f,h,e,b.Pa,b.J);lw(b.L,f);TZi(b,f);b.R=!1;UZi(b)}),function(){TZi(b,kw(b.L,
"Failed to save macro",Sl(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.R=!1;if(b.F){var e=b.F;N().rZa()(e.C);e.H.setVisible(!0)}Av(b,SZi(b))}).setTimeout(18E4)).Se()};function UZi(a){Wf(a.F);a.F=null;Av(a,SZi(a))}p.PGb=function(){UZi(this);setTimeout(function(){return yG("Script recording canceled")})};function SZi(a){var b={},c=!!a.F;a=a.R;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}p.ayc=function(){qVi(this.ma,this.xa)};
p.hyc=function(){rVi(this.ma,this.xa)};function TZi(a,b,c){a.C&&(mw(a.L,a.C),a.C.setVisible(!1),Wf(a.C));a.C=b;a.C.render();c&&(new yBf(!0,Sl())).render(bm("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}p.Na=function(){Wf(this.F);this.F=null;this.C&&(Wf(this.C),this.C=null);rv.prototype.Na.call(this)};function VZi(a,b,c,d){1==a&&FRb(uf(c||""),uf(b),void 0!==d?d:-1,!0)};function WZi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,K,P,R,ba){B.call(this);this.R=a;this.ma=b;this.Aa=c;this.Ea=d;this.O=e;this.Qa=f;this.Pa=h;this.C=k;this.F=l;this.Ma=n;this.Ja=q;this.ea=t;this.Ra=u;this.L=new Kl(this);this.oa(this.L);this.xa=new GVi(this.Aa,this.F);this.$a=new RZi(this.Aa,this.O,this.ma,this.R,this.C.D,E,this.F,this.xa,K,P);this.oa(this.$a);this.J=E.ud();this.Ya=new xZi(this.J,this.C.Aa.C,l,this.xa,z,this.C.Aa.Ja,R);this.oa(this.Ya);this.D=null;this.H=ba}v(WZi,B);
WZi.prototype.init=function(){var a=this.C.Aa.Ja;a.Vh(Sz);a.Vh(Oz);a.Vh(this.J.Ga("recorded-action-stop"));a.Vh(Tz);a.Vh(Uz);a.Vh(Pz);a.Vh(Qz);a=this.F.ub.D;var b=this.F.ub.C;b&&(b+=a?"_"+a:"");a=A();var c=y(a,"docs-tintd")&&y(a,"docs-thtea");this.D=new GGe(this.Ea,this.ma.C,this.C.D);this.oa(this.D);var d=this.R,e=PMa(this.Ja),f=QMa(this.Ja),h=this.O,k=this.Qa,l=this.Pa,n=w(this.ea.O,this.ea),q=w(this.D.C,this.D),t=(Mu(),Ku),u=this.Ma,z=this.Ra,E=this.Ea,K=ex(yw.getInstance()),P=this.C.Aa.C;K=void 0===
K?!1:K;c=void 0===c?!1:c;var R=A();R=new uXi(hd(R,"maestro_container_token"),hd(R,"maestro_domain"),hd(R,"maestro_script_editor_uri"),hd(R,"maestro_new_project_uri"),y(R,"docs-emae"),hd(R,"mae-pai"),y(R,"mae-cwssw"),y(R,"mae-aoeba"),y(R,"mae-esme"),hd(R,"mae-dret"),hd(R,"mae-ses"),y(R,"docs-tdd"),y(R,"mae-seitd"));e=new TWi(d.D,String(E),e,void 0);E=new WXi;E.bind(f);f=R.C?2:R.D?0:1;var ba=new qu(void 0,void 0,!0,uw.getInstance());l=l?new sYi(l,ba,f,P,void 0):null;d=new rZi(d,R,e,E,h,k,l,n,q,t,u,
z,K,VZi,XSc,b,c);d.oa(e);d.oa(E);d.start();O("macros-addon-sidebar").Oa(sZi(t));O("macros-addon-sidebar-focus").Oa(tZi(t,c||!1));O("macros-application-focus").Oa(!0);O("macros-application-sidebar").Oa(!0);O("macros-editor").Oa(!R.xa||R.J);O("macros-exec").Oa(!0);O("macros-extension-disabled").Oa(!0);O("macros-extension-help").Oa(!0);O("macros-extension-install-start").Oa(!0);O("macros-extension-menu-promo").Oa(!0);O("macros-manage").Oa(!0);O("macros-resume").Oa(!0);O("macros-trigger-0").Oa(!0);O("macros-trigger-1").Oa(!0);
O("macros-trigger-2").Oa(!0);O("macros-trigger-3").Oa(!0);O("macros-trigger-4").Oa(!0);O("macros-trigger-5").Oa(!0);O("macros-trigger-6").Oa(!0);O("macros-trigger-7").Oa(!0);O("macros-trigger-8").Oa(!0);O("macros-trigger-9").Oa(!0);null!=this.H&&(a=y(a,"docs-isctp"),this.H.ea=a,this.L.listen(d.J,"scpep",w(this.Va,this)));this.L.listen(wG,"runMacro",w(this.Ta,this))};WZi.prototype.Va=function(a){null!=this.H&&(a=si(a.C(),1),this.H.ea=a)};
WZi.prototype.Ta=function(a){var b=a.payload;a=rd(N().zT()(),wpa);a=vd(a,function(c){return c.getFunctionName()==b});null!=a&&jh(a,1)?this.J.Ga("macros-exec").kb(new gWi(nh(a,1),b,void 0,void 0,void 0,jh(a,12)?a.$q():void 0)):xG("Script function "+(b+" could not be found"))};function XZi(a){var b=a.WGa;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Er(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Er(b)+" to run macro.");return T(a+b+"</div></div>")};function YZi(a,b){Xv.call(this,void 0,void 0,b);this.kq=!1;Gs(this,!1);this.F=new Dv;this.Ha(this.F);this.H=new cW(this.qa());this.Ha(this.H);this.L=new Dv("Number");this.Ha(this.L);this.C=new cW(this.qa());this.Ha(this.C);Hs(this,(new Es).tf({key:"discard",caption:"Discard"},!1).tf(aYa,!0))}v(YZi,Xv);p=YZi.prototype;
p.Ca=function(){Xv.prototype.Ca.call(this);y(A(),"docs-egmd")?(fs(Cs(this),"waffle-record-script-dialog-gm"),Ts(this,"save")):fs(Cs(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.zb().appendChild(Br(XZi,{WGa:Op?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
p.Ia=function(){Xv.prototype.Ia.call(this);this.F.Wa(this.Da("waffle-record-script-name-input"));y(A(),"docs-egmd")||fs(this.Da("waffle-record-script-name"),Wuf.getInstance().kc());this.F.setValue("Untitled Macro");var a=this.F.La();this.H.setPosition(3,2);this.H.render();this.H.Bi(a);fW(this.H,a);eW(this.H);this.L.Wa(this.Da("waffle-record-script-shortcut-input"));y(A(),"docs-egmd")||fs(this.Da("waffle-record-script-shortcut"),Wuf.getInstance().kc());var b=this.L.La();this.C.setPosition(3,2);this.C.render();
this.C.Bi(b);fW(this.C,b);eW(this.C);this.getHandler().listen(this,"dialogselect",this.xwb).listen(a,["focus","blur","change"],this.T9b).listen(b,["focus","blur","change"],this.nfc)};p.focus=function(){Xv.prototype.focus.call(this);Gv(this.F)};p.T9b=function(){""!=this.F.getValue()&&eW(this.H)};p.nfc=function(){ZZi(this)&&eW(this.C)};
p.xwb=function(a){var b=this,c=pq(new oq,12).build();if("discard"==a.key)Oz.kb(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||dW(this.H,"Must not be empty.",!0),ZZi(this)||setTimeout(function(){dW(b.C,"Must be a number from 0 to 9 or blank.",!0)}),$Zi(this)&&setTimeout(function(){dW(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&ZZi(this)&&!$Zi(this)){a=this.F.getValue();var d=this.L.getValue();zlb.kb(new AZi(a,d),c)}else a.preventDefault()};
function ZZi(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function $Zi(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return N().zT()().map(wpa).some(function(c){return jh(c,9)&&nh(c,9)==b})};function a_i(){Rn.apply(this,arguments)}v(a_i,Rn);a_i.prototype.F=function(){return WZi};a_i.prototype.H=function(){return YZi};a_i.prototype.C=function(a,b,c,d){return new LVi(a,b,c,d,void 0)};a_i.prototype.D=function(a,b,c){return new aWi(a,b,c,void 0)};Do("ritzmaestro",a_i);
