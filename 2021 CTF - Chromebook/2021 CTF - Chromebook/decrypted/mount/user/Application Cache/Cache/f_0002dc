function nkh(a){C.call(this,a)}v(nkh,C);nkh.prototype.getStatus=function(){return this.message.getStatus()};function okh(a){this.hb=ch(a,-1,0)}v(okh,fh);okh.prototype.toBuilder=function(){return new nkh(this)};okh.prototype.getStatus=function(){return rh(this,1,0)};function pkh(a){C.call(this,a)}v(pkh,C);pkh.prototype.getStatus=function(){return this.message.getStatus()};function qkh(a){this.hb=ch(a,-1,0)}v(qkh,fh);qkh.prototype.toBuilder=function(){return new pkh(this)};
qkh.prototype.getStatus=function(){return rh(this,1,0)};function rkh(a,b){return new Qm(function(c,d){mH(a,"/dbx/createSchedule",[],b.pb(),function(e){c(gh(okh,JSON.stringify(e.we())))},d)})}function skh(a,b){return new Qm(function(c,d){mH(a,"/dbx/updateSchedule",[],b.pb(),function(e){c(gh(qkh,JSON.stringify(e.we())))},d)})}function tkh(a){if(!N().Oha()(a)||N().iNb()(a))return!1;a=N().rF()(a);return y3b.has(a)}
function ukh(a){var b=[];a=ha(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,tkh(c)&&b.push(c);return b}function vkh(a){if(a.L.sf())return[];var b=[];a.C.forEach(function(c,d){l3b.has(c.D)&&tkh(d)&&b.push(d)});return b}function wkh(a){a.xb()&&phf(a.F)}function xkh(){var a=void 0===a?hh(G1e):a;return new F1e(a)}function ykh(){var a=void 0===a?hh(I1e):a;return new H1e(a)}function zkh(a){C.call(this,a)}v(zkh,C);function Akh(a,b){return Dh(a,1,b)}function Bkh(a){this.hb=ch(a,-1,0)}
v(Bkh,fh);Bkh.prototype.toBuilder=function(){return new zkh(this)};function Ckh(){var a=void 0===a?hh(Bkh):a;return new zkh(a)}function Dkh(a){C.call(this,a)}v(Dkh,C);function Ekh(a,b){return yh(a,1,b)}function Fkh(a,b){return Dh(a,2,b)}function Gkh(a){this.hb=ch(a,-1,0)}v(Gkh,fh);Gkh.prototype.toBuilder=function(){return new Dkh(this)};function Hkh(){var a=void 0===a?hh(Gkh):a;return new Dkh(a)}
function a3(a,b,c,d){S.call(this,d);this.Ya=c;this.Va=a;this.state=3;this.C=null;this.Ra=this.ma=!1;this.$a=new ou(this);this.oa(this.$a);this.Ta=new lff(500,500,"dbxScheduleOnCompleteAuth");this.oa(this.Ta);Ikh(this)}v(a3,S);function Ikh(a){a.$a.Ab(Vgb,wp,function(b){b=b.data;Jkh(a,36713,b);Kkh(a,b,null)}).Ab(Wgb,wp,function(b){b=b.data;Jkh(a,36714,b);Lkh(a,b,null)}).Ab(Xgb,wp,a.rb).Ab(Ygb,wp,a.jb).Ab(Ix,vp,a.refresh)}
function Kkh(a,b,c,d){d=void 0===d?!0:d;var e=Akh(Ckh(),b);c&&yh(e,2,c);rkh(lH.getInstance(),e.build()).then(function(f){return Mkh(a,b,f.getStatus(),nh(f,2),!0,d)},function(){a.vma()})}function Lkh(a,b,c,d){d=void 0===d?!0:d;var e=Fkh(Ekh(Hkh(),a.C.getId()),b);c&&yh(e,3,c);skh(lH.getInstance(),e.build()).then(function(f){return Mkh(a,b,f.getStatus(),nh(f,2),!1,d)},function(){a.vma()})}
a3.prototype.rb=function(){if(Ix.isEnabled()){var a=kU(this.C);Jkh(this,36715,a);a=a.toBuilder().Oa(!0).build();Lkh(this,a,null)}};a3.prototype.jb=function(){if(Ix.isEnabled()){var a=kU(this.C);Jkh(this,36716,a);a=a.toBuilder().Oa(!1).build();Lkh(this,a,null)}};function Jkh(a,b,c){var d=new FWd;c=Nkh(c.Li());d=L(d,10,c);d=eZe(d);d=sq(pq(new oq,75),d).build();a.Ya.C(b,d)}function Nkh(a){switch(a.Li()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function Okh(a){a.state=3;a.refresh();A2e().then(function(b){a.isDisposed()||(b=sh(b,1,Y1e).Gb(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Ra?(a.Ra=!1,a.show()):a.refresh())},function(){Nu.getInstance().postMessage(Pu("Error loading schedule configuration.","error",!0))})}function Pkh(a){return a.C&&lh(kU(a.C),1)?(ph(a.C.getStatus(),1),!0):!1}
function Mkh(a,b,c,d,e,f){a.DGa(!0);switch(c){case 1:a.focus();Okh(a);wG.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;mff(a.Ta,d,function(h){a.isDisposed()||(a.DGa(!1),e?Kkh(a,b,h,!1):Lkh(a,b,h,!1))});break;default:a.vma()}}a3.prototype.show=function(){3==this.state?this.Ra=!0:(this.Ya.C(116122),this.state=1==this.state?2:5,this.refresh())};function Qkh(a,b){ivf.call(this,a,b)}v(Qkh,ivf);Qkh.prototype.O=function(){this.refresh()};Qkh.prototype.refresh=function(){if(this.xb()){var a=Ix.isEnabled();a=this.J&&this.L&&a&&0<vkh(this.H).length;this.C.Oa(a)}};Qkh.prototype.R=m("Refresh all");function Rkh(a){a=a||{};var b=Hr(void 0,null)?18:void 0;b='<svg xmlns="http://www.w3.org/2000/svg" width="'+U(b)+'px" height="'+U(b)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+U(Hr(void 0,null)?"#188038":void 0)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
b=T(b);a=""+QV(Fr({title:"Refresh options",Ds:"waffle-dataconnector-refresh-sidebar",Dz:Jr(""+b),fq:Jr('<div class="'+U("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+U("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),sN:!0,qF:Jr('<div class="'+U("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a));return T(a)};function Skh(){}v(Skh,Nt);Skh.prototype.kc=m("docs-calendar-select");Skh.prototype.Qn=function(a){a=a.Ca("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ca("DIV",["docs-icon","goog-inline-block"],a.Ca("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));fs(a,"docs-material");return a};Ca(Skh);function Tkh(){return T('<div><div class="'+U("waffle-dataconnector-refresh-date-input-date-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function Ukh(a,b,c){void 0===b&&WO.getInstance();S.call(this,c);this.D=new SK("",c);this.Ha(this.D);this.C=null;this.setDate(new Date)}v(Ukh,S);p=Ukh.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(Br(Tkh))};p.Ia=function(){S.prototype.Ia.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-date-input-date-select"));this.setDate(this.F);this.getHandler().listen(this.D,"action",this.wrb)};p.getDate=g("F");
p.wrb=function(){var a=this;null==this.C?Vkh(this,function(){return Wkh(a)}):Wkh(this)};function Wkh(a){a.C.position(a.La());a.C.Da("goog-date-picker").focus();null!=a.D.getValue()&&a.C.Zwc(a.getDate())}function Vkh(a,b){Bo("datepicker",function(){var c=Eo("datepicker");a.C=c.C(a.qa());a.Ha(a.C);a.C.render(a.Da("waffle-dataconnector-refresh-date-input-date-picker"));a.C.pob();a.getHandler().listen(a.C,"change",a.Z0b);b()})}p.Z0b=function(a){this.setDate(new Date(a.C.getTime()));this.C.hide();this.D.La().focus()};
p.setDate=function(a){this.F=new Date(a);this.F.setMinutes(0);this.F.setSeconds(0);this.F.setMilliseconds(0);var b=this.D,c=b.setValue;a=(new Vw(Xw.MONTH_DAY_YEAR_MEDIUM)).format(a);c.call(b,a);this.xb()&&(wm(this.D.La(),""+this.D.getValue()),bs(this.D.La(),"Start date:"+this.D.getValue()))};var Xkh=new qv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function Ykh(a,b){a=void 0===a?cD.getInstance():a;for(var c=new Jt,d=1;28>=d;d++)c.Ha(new Et(Xkh.format({DAY:d}),d),!0);IU.call(this,c,a,b)}v(Ykh,IU);function Zkh(){var a='<div class="'+U("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'" aria-label="';a+=Lr("Add day to repeat on");a+='"></div></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>';return T(a)};var $kh=new qv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function alh(a){S.call(this,a);this.D=new S;this.Ha(this.D);this.C=new Ykh(zt.getInstance(),a);bu(this.C,"Add day");this.Ha(this.C);this.F=new blh}v(alh,S);p=alh.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(Br(Zkh));this.D.Wa(this.Da("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Da("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
p.Ia=function(){S.prototype.Ia.call(this);wm(this.Da("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.Lpc).listen(this,"Ee",this.Trc)};p.Lpc=function(){var a=this.C.getValue();p_a(this.C.ck,null);clh(this,a);this.dispatchEvent("change")};p.Trc=function(a){a=a.target;var b=tr(this.D,a);this.F.remove(b)&&(this.D.removeChild(a,this.xb()),this.dispatchEvent("change"))};
function clh(a,b){if(!a.F.has(b)){var c=new jff($kh.format({DAY:b}),a.qa());b=a.F.add(b);a.D.Af(c,b,a.xb())}}p.Id=function(){return this.F.C};function dlh(a,b){for(var c=0;c<b.length;c++)clh(a,b[c])}function blh(){this.C=[]}blh.prototype.add=function(a){var b=Kd(this.C,a);Bd(this.C,a,-b-1);return-b-1};blh.prototype.has=function(a){return-1<md(this.C,a)};blh.prototype.remove=function(a){return Ed(this.C,a)};function elh(){}v(elh,ord);elh.prototype.Ca=function(a){return a.qa().Ca("INPUT",{type:"number",max:"100",min:"1"})};Ca(elh);function flh(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-new-title")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-enable-switch")+'"></div></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-label-separator")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+U("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ';a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+
'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+
'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+
'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-time-select-label")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-time-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-time-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return T(a)};function glh(){for(var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+U(b)+'" class="'+U("waffle-dataconnector-refresh-weekday-select")+'"></div>';return T(a+"</div>")};function hlh(a){a=a.name;return T('<div class="'+U("waffle-dataconnector-refresh-weekday-toggle")+'">'+Er(a)+"</div>")};function ilh(a,b,c,d){At.call(this,void 0,jlh.getInstance(),d);this.F=a;this.D=c;this.C=b;this.Lf(16,!0)}v(ilh,At);ilh.prototype.Eo=function(a){At.prototype.Eo.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};ilh.prototype.getName=g("F");function jlh(){}v(jlh,zt);jlh.prototype.Ca=function(a){var b=Br(hlh,{name:a.getName()});gs(b,this.xo(a));return b};jlh.prototype.kc=m("waffle-dataconnector-refresh-weekday-toggle");Ca(jlh);function klh(a){S.call(this,a);this.C=llh(this,a)}v(klh,S);klh.prototype.Ca=function(){S.prototype.Ca.call(this);this.mb(Br(glh))};klh.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);wm(this.Da("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.Ef("waffle-dataconnector-refresh-weekday-select")[c]);bs(b.La(),b.D)})};klh.prototype.Id=function(){return this.C.filter(function(a){return a.isChecked()}).map(function(a){return a.C})};
function llh(a,b){var c=(Qw.FIRSTDAYOFWEEK+1)%7,d=Qw.NARROWWEEKDAYS.map(function(e,f){return new ilh(e,(f+6)%7+1,Qw.WEEKDAYS[f],b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Ha(e)});return d};var mlh=new qv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function nlh(a,b,c,d){a3.call(this,a,b,c,d);this.R=new Zff(0,elh.getInstance(),d);this.R.setValue("1");this.Ha(this.R);a=new Jt;a.Ha(new Et("hours",4),!0);a.Ha(new Et("days",1),!0);a.Ha(new Et("weeks",2),!0);a.Ha(new Et("months",3),!0);this.D=new IU(a,Skh.getInstance(),d);this.D.jf(0);this.D.wc("waffle-dataconnector-refresh-schedule-frequency");this.Ha(this.D);this.L=new alh(d);this.Ha(this.L);this.Ea=new klh(d);this.Ha(this.Ea);this.F=new IU(olh(),Skh.getInstance(),d);this.F.jf((new Date).getHours());
this.F.wc("waffle-dataconnector-refresh-schedule-time");this.Ha(this.F);this.Aa=new Ukh(0,ord.getInstance(),d);this.ea=new IU(olh(),Skh.getInstance(),d);this.ea.jf((new Date).getHours());this.Ha(this.Aa);this.J=new VO("Cancel");this.Ha(this.J);this.xa=new Bw("Save",d);this.Ha(this.xa);this.Ja=new At("",VG.getInstance(),d);this.Ha(this.Ja);this.Qa=new At("Setup now",VG.getInstance(),d);this.Ha(this.Qa);this.Pa=new At("",VG.getInstance(),d);this.Ha(this.Pa);this.H=new nS(d);this.H.Xd("Enable schedule");
this.Ha(this.H);this.Ma=b;this.O=new ogf(d);this.O.Ob("waffle-dataconnector-refresh-schedules-new-info-icon");this.O.setVisible(!1);this.ib=new kV(!0,"#0f9d58")}v(nlh,a3);p=nlh.prototype;
p.Ca=function(){a3.prototype.Ca.call(this);this.mb(Br(flh));var a=this.Da("waffle-dataconnector-refresh-schedules-new-title");a.id=mr(this,"waffle-dataconnector-refresh-schedules-new-title");Zr(this.La(),"labelledby",a.id);bs(a,"Scheduled refresh");wm(a,"Scheduled refresh");a=this.O.C;a.setContent(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Da("waffle-dataconnector-refresh-schedules-new-header-title"));
a=a.zb();Zr(rm(this.O.La())[0],"labelledby",a.id)};
p.Ia=function(){var a=this;a3.prototype.Ia.call(this);this.J.render(this.Da("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ja.render(this.Da("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.xa.render(this.Da("waffle-dataconnector-refresh-schedules-new-save-btn"));
this.Qa.render(this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"));this.Pa.render(this.Da("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-new-time-select"));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.ib.render(this.Da("waffle-dataconnector-refresh-schedules-new-spinner"));
this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-select"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"));b3(this,!1);c3(this,!1);plh(this,!0);Rt(this.F,new Wr(null,13));Rt(this.ea,new Wr(null,13));wm(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");wm(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),"Repeat every");wm(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label"),
"Start date");var b=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label");b.id=mr(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");Zr(this.D.La(),"labelledby",b.id);Zr(this.R.La(),"labelledby",b.id);b=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label");b.id=mr(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");Zr(this.F.La(),"labelledby",b.id);b=this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label");b.id=mr(this,
"waffle-dataconnector-refresh-schedules-new-start-date-label");Zr(this.Aa.La(),"labelledby",b.id);this.getHandler().listen(this.Ja,"action",this.show).listen(this.J,"action",this.yrb).listen(this.xa,"action",this.Brb).listen(this.Qa,"action",this.show).listen(this.H,"action",this.zrb).listen(this.D,"change",this.Arb).listen(this.L,"change",this.QH).listen(this.Ea,"change",this.QH).listen(this.L,"change",this.QH).listen(this.F,"change",this.QH).listen(this.ea,"change",this.QH).listen(this.R,"action",
this.QH).listen(this.Pa,"action",this.Crb).listen(this.La(),"keydown",this.xrb);[this.D,this.F,this.ea,this.J].forEach(function(c){a.getHandler().listen(c.La(),"focus",function(){var d=a.Aa;d.C&&d.C.isVisible()&&d.C.hide()})});0<Array.from(this.Va.C.keys()).length?(Q(this.La(),!0),Okh(this)):Q(this.La(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-new-spinner");
Q(e,!1);Q(f,!1);Q(a,!1);Q(b,!1);Q(c,!1);Q(d,!1);Q(h,!1);js(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:Q(e,!0);break;case 2:Q(c,!0);Q(a,!0);Q(d,!0);js(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;qlh(this);rlh(this);this.QH();this.J.Oa(!0);this.O.setVisible(!0);dlh(this.L,[1]);break;case 3:Q(h,!0);break;case 5:Q(c,!0);Q(f,!0);Q(a,!0);Q(d,!0);js(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",
!0);k=!0;slh(this);qlh(this);rlh(this);a=kU(this.C);this.H.Jb(!!lh(a,1));b=a.Li().Li();this.D.setValue(b);switch(b){case 4:c3(this,!1);b3(this,!1);break;case 1:c3(this,!1);b3(this,!1);this.F.setValue(qh(a.Li(),2));break;case 2:c3(this,!0);b3(this,!1);c=this.Ea;d=ER(a.Li(),4).Gb();e=ha(c.C);for(f=e.next();!f.done;f=e.next())f.value.Jb(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Jb(!0);this.F.setValue(qh(a.Li(),2));break;case 3:c3(this,!1),b3(this,!0),dlh(this.L,ER(a.Li(),5).Gb()),this.F.setValue(qh(a.Li(),
2))}c=jh(a.Li(),7)?new Date(ph(a.Li(),7)):new Date;this.Aa.setDate(c);4===b?this.ea.setValue(c.getHours()):this.F.setValue(qh(a.Li(),2));this.R.setValue(rh(a.Li(),6,1).toString());this.QH();this.J.Oa(!0);this.O.setVisible(!0);break;case 4:Q(f,!0),Q(b,!0),slh(this),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-text"),Pkh(this)?(a=this.C.getStatus(),wm(b,"Next: "),b=new Date(1E3*ph(a,2)),a=new Date(1E3*ph(a,3)),this.Ja.setContent(Hm(this.qa(),vgf(b,a,this.Ma,!0,!0))),Q(this.Da("waffle-dataconnector-refresh-schedules-new-label-separator"),
!1)):(wm(b,"Paused"),this.Ja.setContent("Edit"),Q(this.Da("waffle-dataconnector-refresh-schedules-new-label-separator"),!0))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Vk":"Uk"))}};function slh(a){var b=!!lh(kU(a.C),1),c=Ix.isEnabled();a.H.Jb(b);a.H.Oa(c)}function qlh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=nh(a.C.sb(4,O1e),1))&&(c+=" Currently running as "+a);wm(b,c)}
function rlh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-fullview-text");if(Pkh(a)){var c=a.C.getStatus(),d=new Date(1E3*ph(c,2));c=new Date(1E3*ph(c,3));var e=a.qa();e.od(b);e.appendChild(b,Hm(e,df(Ze("Next: "),vgf(d,c,a.Ma,!1,!0))))}else wm(b,"");a.Pa.setContent(ugf(a.Ma))}p.yrb=function(){tlh(this)};function tlh(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-new-title").focus()}
p.Arb=function(){switch(this.D.getValue()){case 4:c3(this,!1);b3(this,!1);plh(this,!0);break;case 1:c3(this,!1);b3(this,!1);plh(this,!1);break;case 2:b3(this,!1);c3(this,!0);plh(this,!1);break;case 3:c3(this,!1),b3(this,!0),plh(this,!1)}this.QH()};function plh(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);Q(a.Da("waffle-dataconnector-refresh-schedules-new-time-select"),!b);Q(a.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
p.Brb=function(){this.xa.Oa(!1);this.J.Oa(!1);var a=this.D.getValue(),b=xkh().EP(a);if(2===a)for(var c=ha(this.Ea.Id()),d=c.next();!d.done;d=c.next())d=d.value,eh(b.hb,4,Hoa).add(d);else if(3===a)for(c=ha(this.L.Id()),d=c.next();!d.done;d=c.next())d=d.value,eh(b.hb,5,Hoa).add(d);c=this.Aa.getDate();4===a&&c.setHours(this.ea.getValue());c=c.getTime();zh(b,7,c);4!==a&&(a=this.F.getValue(),Ah(b,2,a));a=parseInt(this.R.getValue(),10);Ah(b,6,a);b=Ah(ykh().EP(b),3,1);2==this.state?(b.Oa(!0),Vgb.kb(b.build())):
(b.Oa(this.H.isChecked()),Wgb.kb(b.build()))};p.zrb=function(){var a=this;if(4==this.state){var b=this.H.isChecked();this.H.Jb(!b);this.H.Oa(!1);if(b){var c=ulh(this);c.render();c.setVisible(!0);c.getResult().then(function(){Wf(c);Xgb.kb()},function(){Wf(c);slh(a)})}else Ygb.kb()}};p.xrb=function(a){27==a.keyCode&&this.ma&&(tlh(this),a.stopPropagation())};p.Crb=function(){kA.kb()};
p.QH=function(){var a=!!this.D.qf(),b=3!==this.D.getValue()||0<this.L.Id().length,c=2!==this.D.getValue()||0<this.Ea.Id().length,d=!!this.F.qf()||4===this.D.getValue(),e=!!this.ea.qf()||4!==this.D.getValue(),f=Ix.isEnabled(),h=parseFloat(this.R.getValue());h=Number.isInteger(h)&&0<h&&100>=h;this.xa.Oa(a&&b&&c&&d&&e&&f&&h)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-new-title").focus()};p.DGa=function(a){this.H.Oa(a)};
function b3(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function c3(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function ulh(a){var b=new gzf;b.Ob("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=kU(a.C);switch(c.Li().Li()){case 1:var d="Daily ";break;case 2:d=vlh();var e=ER(c.Li(),4).Gb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(ER(c.Li(),5).Gb().map(function(l){return mlh.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=sgf(a.Ma);var h=new Date(La()),k=new Date(1E3*ph(f,2));f=new Date(1E3*ph(f,3));d+=tgf(k,f,c)+" ("+X$a(Z$a(c,h))+")";a="Will run as "+nh(a.C.sb(4,O1e),1);a=df(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),cf("H4",void 0,"Schedule"),Ze(d),cf("BR"),Ze(a));zs(b,a);return b}
p.vma=function(){Nu.getInstance().postMessage(Pu("Error saving schedule.","error",!0));this.xa.Oa(!0);this.J.Oa(!0);this.H.Oa(!0)};function vlh(){var a=(Qw.FIRSTDAYOFWEEK+1)%7,b=Qw.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}
function olh(){for(var a=new Jt,b=new Date(La()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=tgf(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new Et(c[b].label,c[b].value),a.Ha(d,!0);return a};function wlh(a,b,c){B.call(this);this.C=a;this.J=b;this.L=c;this.F=[];this.H=[];this.D=[]}v(wlh,B);wlh.prototype.Na=function(){xlh(this);B.prototype.Na.call(this)};function ylh(a,b,c){var d=RG(a.C);b.forEach(function(e){var f=e.rect;f&&NC(f)&&(d&&iU(a.C)==e.gid?(e=kxc(d,f,zlh(c)),a.oa(e),e.setVisible(!0),a.F.push(e)):Alh(a,e.gid,c))})}
function Blh(a,b,c){var d=RG(a.C);b.forEach(function(e){if(d){var f=gL(d.J,e);if(f&&f.xb()&&f instanceof uyf){a.D.push(f);fs(JX(f.D),zlh(c));return}}(e=a.L.J.Gk(e))&&Alh(a,e.gb(),c)})}function Alh(a,b,c){b=P3e(a.J,b);fs(b.La(),zlh(c));a.H.push(b)}function zlh(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function xlh(a){Xf(a.F);a.F=[];a.H.forEach(function(b){is(b.La(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.H=[];a.D.forEach(function(b){is(JX(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.D=[]};function Clh(){return T('<div class="'+U("waffle-dataconnector-refresh-all-pane")+'"><div class="'+U("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function Dlh(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function Elh(a,b){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+Dlh(null,b))}function Flh(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function Glh(a){a=a.title;a='<div class="'+U("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+NVb()+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Er(a)+'</div><div class="'+
U("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return T(a+"Running\u2026</div></div></div>")};function Hlh(a,b,c,d,e,f,h){S.call(this,h);this.C=a;this.ma=b;this.ea=c;this.R=d.L;this.L=e;this.D=new wlh(e,f,d);this.oa(this.D);this.O=new Smc;this.H=new kV(!1,"#0f9d58");this.F=this.J=!0}v(Hlh,S);p=Hlh.prototype;p.Ca=function(){this.mb(Br(Glh,{title:this.ma}));var a=this.Da("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=mr(this,"waffle-dataconnector-refresh-all-dbobject-item-title");Xr(a,"heading");Zr(this.La(),"labelledby",a.id)};
p.Ia=function(){S.prototype.Ia.call(this);fs(this.La(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.La(),"click",this.zNa).listen(this.La(),"keydown",this.Erb).listen(this.La(),["mouseenter","focus"],this.Drb).listen(this.La(),["mouseleave","blur"],this.i_b);Ilh(this)};
function Ilh(a){var b=lU(a.R,a.C),c=b.getType(),d=a.La();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":ls(d,"valid-highlight","error-highlight");a.F=!1;break;case "loading":case "no-results":case "fetch-successful":ls(d,"error-highlight","valid-highlight");a.F=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":Jlh(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");Klh(a);break;case "offline":Klh(a);break;case "loading":Jlh(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");Llh(a);break;case "fetching-results":Jlh(a,"waffle-dataconnector-refresh-all-dbobject-item-running");Llh(a);break;case "no-results":Mlh(a);Klh(a);break;case "fetch-successful":b=ph(b.C,8);b=a.O.format(b);wm(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);bs(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);Jlh(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");Klh(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}p.Oa=function(a){this.J=a;var b=this.La();this.qa().Th(b,a);a?ls(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):ls(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
p.Drb=function(){var a=this;switch(this.ea){case 1:case 3:case 5:var b=N().EWa()(this.C,iU(this.L)).map(function(c){return uD(eo(c))});ylh(this.D,b,this.F);break;case 2:b=N().DWa()(this.C);Blh(this.D,b,this.F);break;case 4:N().CWa()(this.C).forEach(function(c){Alh(a.D,c,a.F)})}};p.i_b=function(){xlh(this.D)};function Jlh(a,b){Mlh(a);Q(a.Da(b),!0)}
function Klh(a){a.H.setActive(!1);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function Llh(a){a.H.setActive(!0);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);Q(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.Erb=function(a){13===a.keyCode&&this.zNa()};p.zNa=function(){if(this.J){var a=new ED("refresh-db-object-request");a.dVa=this.C;this.dispatchEvent(a)}};
function Mlh(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return Q(a.Da(b),!1)})};function Nlh(a,b,c,d,e,f,h,k){S.call(this,k);this.O=a;this.H=new Set(b);this.xa=c;this.R=c.L;this.F=[];this.ea=f;this.ma=h;this.J=d;this.D=this.C=null;e&&(this.C=new Olh(this.qa()),this.D=new VV(this.J,this.qa(),!0));this.L=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}v(Nlh,S);p=Nlh.prototype;p.Ca=function(){if(this.D){var a=fm("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.mb(a);this.Ha(this.D,!0);this.D.setContent(Br(Dlh));fs(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.mb(Br(Elh))};
p.Ia=function(){S.prototype.Ia.call(this);this.D||wm(this.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.J);Plh(this);Qlh(this);var a=this.getHandler();this.C&&(this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.ycc))};function Rlh(a){var b=a.getHandler();a.F.forEach(function(c){b.Hc(c,"refresh-db-object-request",a.p1a)})}
function Qlh(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.p1a)})}function Plh(a){var b=a.Da("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.H.forEach(function(c){var d=N().rF()(c);c=new Hlh(c,Slh(a,d),d,a.xa,a.ea,a.ma,a.qa());a.F.push(c);c.render(b)})}
function Slh(a,b){switch(b){case 1:return"Pivot table "+Tlh(a,1);case 2:return"Chart "+Tlh(a,2);case 3:return"Function "+Tlh(a,3);case 4:return"Preview";case 5:return"Extract "+Tlh(a,5);default:throw Error("Unexpected DbObjectType");}}function Tlh(a,b){var c=a.L.get(b);a.L.set(b,c+1);return 0==c?"":c.toString()}function Ulh(a){a.L.forEach(function(b,c,d){return d.set(c,0)})}
p.ycc=function(){var a=this,b=Array.from(this.H).filter(function(c){return l3b.has(lU(a.R,c).D)});Dx.kb(new lze(b,"all-objects-for-single-datasource",this.O))};p.p1a=function(a){a=a.dVa;l3b.has(lU(this.R,a).D)&&Dx.kb(new lze([a],"specific-ids"))};function Vlh(a){a.F.forEach(function(b){return Ilh(b)})}function Wlh(a,b){a.C&&(b=b.filter(function(c){return jh(c,3)&&a.H.has(c.Rl())}),Xlh(a.C,b))}p.expand=function(){this.D.getHeader().Jb(!0)};p.Hd=g("O");
function Ylh(a,b){a.J=b;a.D?a.D.getHeader().setContent(b):wm(a.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}p.Oa=function(a){this.C&&this.C.Oa(a);this.F.forEach(function(b){return b.Oa(a)})};function Olh(a){S.call(this,a);this.D=new VO("Refresh",this.qa());this.Ha(this.D);this.C=new hvf;this.Ha(this.C)}v(Olh,S);Olh.prototype.Ca=function(){this.mb(Br(Flh))};
Olh.prototype.Ia=function(){S.prototype.Ia.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function Xlh(a,b){var c=0;b.forEach(function(d){return c+=parseInt(d.uq(),10)});shf(a.C,c);a.D.Oa(!0)}Olh.prototype.Oa=function(a){this.D.Oa(a)};function Zlh(a,b,c,d){S.call(this,d);this.F=a;this.J=a.L;this.D=new S;this.Ha(this.D);this.C=[];this.H=b;this.L=c}v(Zlh,S);Zlh.prototype.Ca=function(){this.mb(Br(Clh))};Zlh.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);this.D.Wa(this.Da("waffle-dataconnector-refresh-all-datasources-container"));$lh(this);this.getHandler().listen(this.F.C,"ua",function(b){return amh(a,b)})};
function $lh(a){var b=a.D.od(!0);Xf(b);a.C=[];b=bmh(a);if(1==b.size)b=b.entries().next().value,cmh(a,b[0],b[1],!1),fs(a.D.La(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ha(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);cmh(a,d,e,!0)}hs(a.D.La(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function dmh(a){var b=bmh(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.Hd();if(b.has(d)){var e=b.get(d);Rlh(c);Xf(c.F);c.F=[];Ulh(c);c.H=new Set(e);Plh(c);Qlh(c)}else emh(a,c);b.delete(d)}),b.forEach(function(c,d){return cmh(a,d,c,!0)})):$lh(a)}function emh(a,b){a.C=a.C.filter(function(c){return b!=c});Wf(b)}function cmh(a,b,c,d){var e=N().lT()(b);e=wF(a.F.C,e).Td();b=new Nlh(b,c,a.F,e,d,a.H,a.L,a.qa());a.C.push(b);a.D.Ha(b,!0)}
function bmh(a){var b=new Map;ukh(a.J).forEach(function(c){var d=N().FN()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function fmh(a,b){a.C.forEach(function(c){return Wlh(c,b)})}function gmh(a){a.C.forEach(function(b){b.C&&qhf(b.C.C)})}function hmh(a){a.C.forEach(function(b){b.C&&(b=b.C,phf(b.C),b.D.Oa(!1))})}function imh(a){a.C.forEach(function(b){return Vlh(b)})}Zlh.prototype.Oa=function(a){this.C.forEach(function(b){return b.Oa(a)})};
function amh(a,b){3==wF(a.F.C,b.jh).getSheetType()&&(a=a.C.find(function(c){return c.J==b.C}))&&Ylh(a,b.Bm)};function jmh(a,b,c){b=void 0===b?bD.getInstance():b;jt.call(this,"",void 0,c);a&&kmh(a);this.C=new lmh(a,b,c);this.Ha(this.C)}v(jmh,jt);p=jmh.prototype;p.Ca=function(){this.C.Ca();this.mb(this.C.La())};p.hd=function(a){a.Um(!0);this.C.hd(a)};p.Rs=function(a,b){a.Um(!0);this.C.Rs(a,b)};p.Gg=function(a){return this.C.Gg(a)};p.uh=function(){return this.C.uh()};p.Id=function(){return this.C.C.map(function(a){return a.getValue()})};
function mmh(a,b){a=a.C;for(var c=ha(a.C),d=c.next();!d.done;d=c.next())d.value.Jb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.uh();e++){var f=a.Gg(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Jb(!0),c.push(f),0==--d))break}a.C=c}a.cH()}p.Bb=function(){return this.C.Bb()};p.re=function(a){kmh(a);this.C.re(a)};p.wc=function(a){this.C.wc(a)};function kmh(a){for(var b=0;b<a.jc();b++)a.Bc(b).Um(!0)}function lmh(a,b,c){b=void 0===b?bD.getInstance():b;JU.call(this,a,b,c);this.C=[]}
v(lmh,JU);lmh.prototype.re=function(a){JU.prototype.re.call(this,a);this.C=[];this.cH()};lmh.prototype.xq=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Bb();Zea(this.C,a,function(c,d){return Ld(tr(b,c),tr(b,d))})}else Dd(this.C,a);this.cH();this.dispatchEvent("change")};lmh.prototype.J=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Rg()}).join(", ");return a||""};function nmh(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
U("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-date-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-time-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return T(a)};var omh=new qv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function pmh(a,b,c,d){a3.call(this,a,b,c,d);this.Ma=y(A(),"fdsrfu")?1:4;a=new Jt;a.Ha(new Et("Every day",1),!0);a.Ha(new Et("Every week",2),!0);a.Ha(new Et("Every month",3),!0);this.H=new JU(a,bD.getInstance(),d);bu(this.H,"Add frequency");this.H.wc("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Ha(this.H);this.D=new jmh(void 0,bD.getInstance(),d);bu(this.D.C,"Add date");this.D.wc("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");
this.Ha(this.D);var e=this.Ma;a=new Jt;var f=new Date(La());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=tgf(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new Et(c[e].label,c[e].value),a.Ha(f,!0);this.J=new JU(a,bD.getInstance(),d);bu(this.J,"Add time");this.J.wc("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Ha(this.J);this.O=new VO("Cancel");this.Ha(this.O);this.R=
new Bw("Save",d);this.R.Oa(!1);this.Ha(this.R);this.ea=new At("",VG.getInstance(),d);this.Ha(this.ea);this.Ea=new At("Setup now",VG.getInstance(),d);this.Ha(this.Ea);this.Aa=new At("",VG.getInstance(),d);this.Ha(this.Aa);this.F=new nS(d);this.F.Xd("Enable schedule");this.Ha(this.F);this.xa=b;this.L=new ogf(d);this.L.Ob("waffle-dataconnector-refresh-schedules-info-icon");this.L.setVisible(!1);this.Ja=new kV(!0,"#0f9d58")}v(pmh,a3);p=pmh.prototype;
p.Ca=function(){a3.prototype.Ca.call(this);this.mb(Br(nmh));var a=this.Da("waffle-dataconnector-refresh-schedules-title");a.id=mr(this,"waffle-dataconnector-refresh-schedules-title");Xr(a,"heading");Zr(this.La(),"labelledby",a.id);a=this.L.C;a.setContent(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-header-title"));a=a.zb();Zr(this.L.La(),"labelledby",
a.id)};
p.Ia=function(){a3.prototype.Ia.call(this);this.O.render(this.Da("waffle-dataconnector-refresh-schedules-cancel-btn"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-save-btn"));this.Ea.render(this.Da("waffle-dataconnector-refresh-schedules-setup-btn"));this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Da("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-date-select"));this.Ja.render(this.Da("waffle-dataconnector-refresh-schedules-spinner"));qmh(this,!1);Rt(this.J,new Wr(null,13));this.getHandler().listen(this.ea,"action",this.show).listen(this.O,"action",this.Grb).listen(this.R,"action",this.Jrb).listen(this.Ea,"action",this.show).listen(this.F,"action",this.Hrb).listen(this.H,"change",this.Irb).listen(this.D,
"change",this.q4).listen(this.J,"change",this.q4).listen(this.Aa,"action",this.Krb).listen(this.La(),"keydown",this.Frb);0<Array.from(this.Va.C.keys()).length?(Q(this.La(),!0),Okh(this)):Q(this.La(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-spinner");
Q(e,!1);Q(f,!1);Q(a,!1);Q(b,!1);Q(c,!1);Q(d,!1);Q(h,!1);js(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.L.setVisible(!1);switch(this.state){case 1:Q(e,!0);break;case 2:Q(c,!0);Q(a,!0);Q(d,!0);js(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;rmh(this);smh(this);this.q4();this.O.Oa(!0);this.L.setVisible(!0);break;case 3:Q(h,!0);break;case 5:Q(c,!0);Q(f,!0);Q(a,!0);Q(d,!0);js(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;tmh(this);rmh(this);smh(this);a=kU(this.C);this.F.Jb(!!lh(a,1));b=a.Li().Li();this.H.setValue(b);switch(b){case 1:qmh(this,!1);break;case 2:mmh(this.D,ER(a.Li(),4).Gb());qmh(this,!0);break;case 3:mmh(this.D,ER(a.Li(),5).Gb()),qmh(this,!0)}this.J.setValue(qh(a.Li(),2));this.q4();this.O.Oa(!0);this.L.setVisible(!0);break;case 4:Q(f,!0),Q(b,!0),tmh(this),b=this.Da("waffle-dataconnector-refresh-schedules-overview-text"),Pkh(this)?(a=this.C.getStatus(),wm(b,"Next: "),b=new Date(1E3*ph(a,2)),a=
new Date(1E3*ph(a,3)),this.ea.setContent(Hm(this.qa(),vgf(b,a,this.xa,!0,!0)))):(wm(b,"Paused"),this.ea.setContent("Edit"))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Vk":"Uk"))}};function tmh(a){var b=!!lh(kU(a.C),1),c=Ix.isEnabled();a.F.Jb(b);a.F.Oa(c)}function rmh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=nh(a.C.sb(4,O1e),1))&&(c+=" Currently running as "+a);wm(b,c)}
function smh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-fullview-text");if(Pkh(a)){var c=a.C.getStatus(),d=new Date(1E3*ph(c,2));c=new Date(1E3*ph(c,3));var e=a.qa();e.od(b);e.appendChild(b,Hm(e,df(Ze("Next: "),vgf(d,c,a.xa,!1,!0))))}else wm(b,"");a.Aa.setContent(ugf(a.xa))}p.Grb=function(){umh(this)};function umh(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-title").focus()}
p.Irb=function(){var a=this.H.getValue();mmh(this.D,[]);switch(a){case 1:qmh(this,!1);break;case 2:qmh(this,!0);a=this.D;var b=a.re,c=new Jt,d=vmh();d=ha(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Ha(new Et(e.label,e.value),!0);a=b.call(a,c);Wf(a);break;case 3:qmh(this,!0);a=this.D;b=a.re;c=new Jt;for(d=1;28>=d;d++)c.Ha(new Et(omh.format({DAY:d}),d),!0);a=b.call(a,c);Wf(a)}this.q4()};
p.Jrb=function(){this.R.Oa(!1);this.O.Oa(!1);var a=this.H.getValue(),b=xkh().EP(a);if(2===a){a=ha(this.D.Id());for(var c=a.next();!c.done;c=a.next())c=c.value,eh(b.hb,4,Hoa).add(c)}else if(3===a)for(a=ha(this.D.Id()),c=a.next();!c.done;c=a.next())c=c.value,eh(b.hb,5,Hoa).add(c);a=this.J.getValue();Ah(b,2,a);b=Ah(ykh().EP(b),3,1);2==this.state?(b.Oa(!0),Vgb.kb(b.build())):(b.Oa(this.F.isChecked()),Wgb.kb(b.build()))};
p.Hrb=function(){var a=this;if(4==this.state){var b=this.F.isChecked();this.F.Jb(!b);this.F.Oa(!1);if(b){var c=wmh(this);c.render();c.setVisible(!0);c.getResult().then(function(){Wf(c);Xgb.kb()},function(){Wf(c);tmh(a)})}else Ygb.kb()}};p.Frb=function(a){27==a.keyCode&&this.ma&&(umh(this),a.stopPropagation())};p.Krb=function(){kA.kb()};p.q4=function(){var a=!!this.H.qf(),b=1===this.H.getValue()||0<this.D.Id().length,c=!!this.J.qf(),d=Ix.isEnabled();this.R.Oa(a&&b&&c&&d)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-title").focus()};
p.DGa=function(a){this.F.Oa(a)};function qmh(a,b){Q(a.Da("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function wmh(a){var b=new gzf;b.Ob("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=kU(a.C);switch(c.Li().Li()){case 1:var d="Daily ";break;case 2:d=vmh();var e=ER(c.Li(),4).Gb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(ER(c.Li(),5).Gb().map(function(l){return omh.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=sgf(a.xa);var h=new Date(La()),k=new Date(1E3*ph(f,2));f=new Date(1E3*ph(f,3));d+=tgf(k,f,c)+" ("+X$a(Z$a(c,h))+")";a="Will run as "+nh(a.C.sb(4,O1e),1);a=df(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),cf("H4",void 0,"Schedule"),Ze(d),cf("BR"),Ze(a));zs(b,a);return b}
p.vma=function(){Nu.getInstance().postMessage(Pu("Error saving schedule.","error",!0));this.R.Oa(!0);this.O.Oa(!0);this.F.Oa(!0)};function vmh(){var a=(Qw.FIRSTDAYOFWEEK+1)%7,b=Qw.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function xmh(a,b,c,d,e,f){tV.call(this,f);this.F=b.L;this.L=a;this.R=d;this.pP=new Zlh(b,c,this.R,this.qa());this.Ha(this.pP);this.D=new Qkh(this.F,f);this.oa(this.D);this.C=null;this.ea=y(A(),"fdsrfu");this.J=null;this.O=e}v(xmh,tV);p=xmh.prototype;p.Ca=function(){tV.prototype.Ca.call(this);this.mb(Br(Rkh,{id:this.getId()}));this.D.render(this.Da("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
p.Ia=function(){var a=this;tV.prototype.Ia.call(this);ymh(this);this.getHandler().listen(this,["Uk","Vk"],this.Kdc);this.pP.render(this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget"));zmh(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=vkh(a.F);Dx.kb(new lze(b,"all-objects-for-all-datasources"))});this.D.refresh();Q(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function Amh(a){null!=a.C&&(Wf(a.C),Wf(a.J),ymh(a))}
p.uoa=function(){null!=this.C&&this.C.show()};function Bmh(a,b){fmh(a.pP,b);var c=0;b.forEach(function(d){return c+=parseInt(d.uq(),10)});a.D.Fm(c)}function zmh(a,b){a.pP.Oa(b);b?a.D.refresh():a.D.C.Oa(b)}
p.Kdc=function(a){var b=this;a="Vk"===a.type;Q(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),a);zmh(this,!a);Lq(this.zb(),"overflow-y",a?"hidden":"auto");Wf(this.J);a?(Cmh(this),setTimeout(function(){if(b.C.xb()){var c=b.C.La();b.J=new ow(c,b.qa());b.oa(b.J);pw(b.J);c.focus()}},500)):this.resize()};function ymh(a){a.C=a.ea?new nlh(a.F,a.L,a.O,a.qa()):new pmh(a.F,a.L,a.O,a.qa());a.Ha(a.C);a.C.render(a.La());Q(a.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
p.resize=function(){if(this.C)if(this.C.ma)Cmh(this);else{var a=Zq(this.zb()).height-Zq(this.C.La()).height,b=this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget");Yq(b,a)}};function Cmh(a){var b=Zq(a.La()).height-Zq(a.Da("waffle-sidebar-title")).height-10;Lq(a.C.La(),"max-height",b+"px")};function Dmh(a,b,c){qU.call(this,a,b);var d=this;this.C=c;this.F=new Il;this.oa(this.F);this.F.wb(this.C.H,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.Pb,dmh(e.pP),0<vkh(e.F).length||e.dispatchEvent("close-sidebar");Emh(d);imh(d.Pb.pP)});this.D.listen(wG,"show-db-objects-refresh-sidebar",this.H)}v(Dmh,qU);Dmh.prototype.Bf=function(){return Fgb};Dmh.prototype.wm=function(){return Ggb};
function Emh(a){var b=vkh(a.C),c=a.Pb;0==b.length?wkh(c.D):(gmh(c.pP),jvf(c.D),yqe(a.C,b,function(d){a.isDisposed()||c.isDisposed()||Bmh(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new LH(d[0].Rl(),d[0].nf()),hmh(c.pP),c.D.Fz(d))}))}Dmh.prototype.H=function(a){var b=this;Amh(this.Pb);Emh(this);rU(this);a.uoa&&this.Pb.uoa();Km(function(){b.Pb.La().focus()})};function Fmh(){Rn.apply(this,arguments)}v(Fmh,Rn);Fmh.prototype.C=function(){return Dmh};Fmh.prototype.D=function(){return xmh};Do("dbrefresh",Fmh);
