Cod.prototype.O$=y(458,function(){if(!this.isDisposed()){var a=this.Ja(Dod.qta),b=hh("Estimating\u2026");qh(a,b);this.Dc()&&(gq(a,!0),a=this.Ja(Dod.Naa),gq(a,!1))}});Fod.prototype.O$=y(457,function(){this.C["refresh-query"].O$()});Ood.prototype.O$=y(456,function(){this.C.O$()});function eyp(){return Vt.qb().C.newDatasourceFromOnboarding}function fyp(){return!!Vt.qb().C.showBigQueryProjectSelectionOnStart}function gyp(a){var b=[];a.C.forEach(function(c,d){dj(c,2)||b.push(d)});return b}
function hyp(a){qj.call(this,a)}z(hyp,qj);hyp.prototype.getError=function(){return this.message.getError()};function iyp(a){this.Ib=Zi(a,-1,0)}z(iyp,$i);iyp.prototype.yb=function(){return new hyp(this)};iyp.prototype.getError=function(){return lj(this,1,0)};function jyp(a){qj.call(this,a)}z(jyp,qj);jyp.prototype.getStatus=function(){return this.message.getStatus()};jyp.prototype.Mh=function(){return this.message.Mh()};jyp.prototype.Kg=function(){return this.message.Kg()};jyp.prototype.Nh=function(){return this.message.Nh()};
function kyp(a){this.Ib=Zi(a,-1,0)}z(kyp,$i);u=kyp.prototype;u.yb=function(){return new jyp(this)};u.getStatus=function(){return lj(this,6,0)};u.Mh=function(){return lj(this,7,0)};u.Kg=function(){return kj(this,8)};u.Nh=function(){return kj(this,9)};function lyp(a){qj.call(this,a)}z(lyp,qj);lyp.prototype.getStatus=function(){return this.message.getStatus()};function myp(a){this.Ib=Zi(a,-1,0)}z(myp,$i);myp.prototype.yb=function(){return new lyp(this)};
myp.prototype.getStatus=function(){return lj(this,1,0)};function nyp(a){qj.call(this,a)}z(nyp,qj);u=nyp.prototype;u.gj=function(){return this.message.gj()};u.Fu=function(){return this.message.Fu()};u.Uj=function(){return this.message.Uj()};u.Wv=function(){return this.message.Wv()};u.qq=function(){return this.message.qq()};function oyp(a){this.Ib=Zi(a,-1,0)}z(oyp,$i);u=oyp.prototype;u.yb=function(){return new nyp(this)};u.gj=function(){return this.rc(1,zj)};u.Fu=function(){return hj(this,2)};
u.Uj=function(){return jj(this,3)};u.Wv=function(){return dj(this,5)};u.qq=function(){return hj(this,5)};function pyp(a){var b=void 0===b?cj(oyp):b;b=new nyp(b);return yj(b,1,a)}function qyp(a){qj.call(this,a)}z(qyp,qj);function ryp(a){this.Ib=Zi(a,-1,0)}z(ryp,$i);ryp.prototype.yb=function(){return new qyp(this)};function syp(a){qj.call(this,a)}z(syp,qj);function typ(a){this.Ib=Zi(a,-1,0)}z(typ,$i);typ.prototype.yb=function(){return new syp(this)};function uyp(a,b){return wj(a,1,b)}
function vyp(a){qj.call(this,a)}z(vyp,qj);vyp.prototype.oea=function(a){return this.message.oea(a)};function wyp(a){this.Ib=Zi(a,-1,0)}z(wyp,$i);wyp.prototype.yb=function(){return new vyp(this)};wyp.prototype.oea=function(a){return nj(this,2,a,oyp)};function xyp(a){qj.call(this,a)}z(xyp,qj);xyp.prototype.oea=function(a){return this.message.oea(a)};function yyp(a){this.Ib=Zi(a,-1,0)}z(yyp,$i);yyp.prototype.yb=function(){return new xyp(this)};yyp.prototype.oea=function(a){return nj(this,1,a,oyp)};
function zyp(a){qj.call(this,a)}z(zyp,qj);zyp.prototype.getStatus=function(){return this.message.getStatus()};function Ayp(a){this.Ib=Zi(a,-1,0)}z(Ayp,$i);Ayp.prototype.yb=function(){return new zyp(this)};Ayp.prototype.getStatus=function(){return lj(this,1,0)};function Byp(a,b){return new Dn(function(c,d){Ho(Xl(Yl(Wl(Ko(Vl(a.C.ji("/answers/tablemetadata"),"did",b),"POST"),2),function(e){e=aj(iyp,JSON.stringify(e.gh()));c(e)}),function(){d()})).Di()})}
function Cyp(a,b){return new Dn(function(c,d){qx(a,"/dbx/createDelegation",[],b.Mb(),function(e){c(aj(myp,JSON.stringify(e.gh())))},d)})}function Dyp(a,b){return new Dn(function(c,d){qx(a,"/dbx/updateDelegation",[],b.Mb(),function(e){c(aj(Ayp,JSON.stringify(e.gh())))},d)})}function Eyp(a){Date.now()-a.D>a.F&&(a.D=Date.now(),a.C.clear())}function Fyp(a,b){return a.C.has(b)?a.C.get(b):null}
function Gyp(a,b){var c=new Set;b.forEach(function(d){a.X.add(d);c.add(d)});x3c(a,c,"dbobjectmodel-event-update")}function Hyp(a,b){a.D&&a.F&&b.forEach(function(c){a.D.C.has(c)?Fyp(a.D,c)||a.F.C(116202):a.F.C(1162031)})}function Iyp(a,b){a.F.C(36994);b||a.F.C(36995)}function Jyp(a,b,c,d){T_j(a.J,b,function(e){var f=e.filter(function(h){return 2==h.gj().getState()});c(f);e=e.filter(function(h){return 2!=h.gj().getState()});d(e)},d,!0,2)}
function Kyp(a,b){if(a.R&&b&&a.F){b=Yk().jDc()(b.Cb());Kf(b)||Eyp(a.D);for(var c=[],d=0;d<b.length;d++){var e=b[d];a.D.C.has(e)?(e=Fyp(a.D,e),Iyp(a,e)):c.push(e)}Kf(c)||Jyp(a,c,function(f){f.forEach(function(h){h=h.Fu();a.D.C.set(h,!0);Iyp(a,!0)})},function(f){f.forEach(function(h){var k=h.gj();k=dj(h,1)&&37==k.ai();h=h.Fu();a.D.C.set(h,!k);Iyp(a,!k)})})}}function Lyp(a,b,c,d){T_j(a.J,b,function(e){var f=e.filter(function(h){return 2!=h.gj().getState()});0==f.length?c(e):d(f)},d,!0)}
function Myp(a,b,c,d){AFk(a.J,b,c,d,!0)}function Nyp(a){var b=px.qb();return new Dn(function(c,d){oFk(b,"/dbx/delegations",function(e){c(aj(typ,JSON.stringify(e.gh())))},d,["data",a.Mb()])})}function Oyp(a){var b=px.qb();return new Dn(function(c,d){qx(b,"/charts/score",[],a.Mb(),function(e){e=aj(kyp,JSON.stringify(e.gh()));c(e)},d)})}function Pyp(a){var b=px.qb();b.F=a;b.C&&b.F.tW(b.C)}
function Qyp(a,b,c){return new Dn(function(d,e){qYb(c,function(){qx(a,"/dbx/refreshSlicerObject",a.D?["esid",a.D]:[],b.Mb(),function(f){f=aj(yyp,JSON.stringify(f.gh()));d(f)},function(){var f=GXj(FXj().Mc(3),31).va();f=pyp(f).va();var h=void 0===h?cj(yyp):h;h=new xyp(h);f=wj(h,1,f).va();e(f)})})})}
function Ryp(a,b,c){return new Dn(function(d,e){qYb(c,function(){qx(a,"/dbx/refreshObject",a.D?["esid",a.D]:[],b.Mb(),function(f){f=aj(wyp,Nl(f.gh(),Ara));d(f)},function(){var f=GXj(FXj().Mc(3),31).va();f=pyp(f).va();var h=void 0===h?cj(wyp):h;h=new vyp(h);f=wj(h,2,f).va();e(f)})})})}
function Syp(a,b,c){return new Dn(function(d,e){qYb(c,function(){qx(a,"/dbx/validateCalculatedColumn",[],b.Mb(),function(f){f=aj(jFk,JSON.stringify(f.gh()));d(f)},function(){var f=GXj(FXj().Mc(3),31).va();f=kFk(f).va();e(f)})})})}function Typ(a){return a.D["ritz-DisplayCountBigsheetsPromo"]}function Uyp(a){a.ma&&a.ma.Je(a.Ua(),a.X?5:1,new Ap(0,a.X?50:0,12,a.X?0:50))}function Vyp(a,b,c,d,e,f,h,k,l){ey.call(this,a,b,c,d,e,l);this.F=new Ood(h,d.Bd(),k,l);this.Pa(this.F,!0);this.H=f;this.D=null}
z(Vyp,ey);Vyp.prototype.Ia=function(){var a=this.Da().Ia("DIV","waffle-dbsource-container");this.Ob(a)};Vyp.prototype.Qa=function(){ey.prototype.Qa.call(this);this.D=new Pt(this.Ua(),this.Da());Qt(this.D)};Vyp.prototype.Yf=function(){hi(this.D);ey.prototype.Yf.call(this)};Vyp.prototype.focus=function(){var a=this.F;a.D.isVisible()&&a.D.isEnabled()&&(a.D.Ua().focus(),a.D.Oz(!0));this.H.Mc(2)};
function Wyp(a){var b=a.R.C.C;if(ev(b))return Yk().fHb()(b.Cb());(b=MGk(a))||(b=(b=fGd(a))?gGd(a,b):null);if(b||(b=(b=NGk(a))?Yk().Dma()(b):null))return b;b=Pw(a.mb());return gGd(a,b)}function Xyp(a,b){[a.R,a.Ga].forEach(function(c){return c.setPosition(b)});a.D.some(function(c){c.C.setPosition(b)})}
function Yyp(){var a=px.qb(),b=Zyp();return new Dn(function(c){qx(a,"/dbx/getBigsheetsPromoRelevance",[],b.Mb(),function(d){d=aj(ryp,JSON.stringify(d.gh()));c(d)},function(){var d=void 0===d?cj(ryp):d;d=new qyp(d);d=vj(d,1,0).va();c(d)})})}function $yp(a){a=a||{};return XKk(a.color,a.tad)}function azp(a){qj.call(this,a)}z(azp,qj);function bzp(a,b){return tj(a,1,b)}azp.prototype.jg=function(){return this.message.jg()};function czp(a,b){return tj(a,2,b)}function dzp(a){this.Ib=Zi(a,-1,0)}z(dzp,$i);
dzp.prototype.yb=function(){return new azp(this)};dzp.prototype.jg=function(){return hj(this,2)};function ezp(){var a=void 0===a?cj(dzp):a;return new azp(a)}function fzp(a){qj.call(this,a)}z(fzp,qj);function gzp(a,b){return yj(a,2,b)}function hzp(a){this.Ib=Zi(a,-1,0)}z(hzp,$i);hzp.prototype.yb=function(){return new fzp(this)};function izp(){var a=void 0===a?cj(hzp):a;return new fzp(a)}function jzp(a){qj.call(this,a)}z(jzp,qj);function kzp(a){this.Ib=Zi(a,500,0)}z(kzp,$i);kzp.prototype.yb=function(){return new jzp(this)};
function Zyp(){return cj(kzp)}function lzp(a){qj.call(this,a)}z(lzp,qj);function mzp(a,b){return bwa(a,1,b)}function nzp(a){this.Ib=Zi(a,-1,0)}z(nzp,$i);nzp.prototype.yb=function(){return new lzp(this)};function ozp(){var a=void 0===a?cj(nzp):a;return new lzp(a)}function pzp(){var a=void 0===a?cj(typ):a;return new syp(a)}function qzp(a){qj.call(this,a)}z(qzp,qj);function rzp(a){this.Ib=Zi(a,-1,0)}z(rzp,$i);rzp.prototype.yb=function(){return new qzp(this)};function szp(a){qj.call(this,a)}z(szp,qj);
function tzp(a){this.Ib=Zi(a,-1,0)}z(tzp,$i);tzp.prototype.yb=function(){return new szp(this)};function uzp(a){qj.call(this,a)}z(uzp,qj);function vzp(a,b){return tj(a,1,b)}function wzp(a,b){return yj(a,2,b)}function xzp(a){this.Ib=Zi(a,-1,0)}z(xzp,$i);xzp.prototype.yb=function(){return new uzp(this)};function yzp(){var a=void 0===a?cj(xzp):a;return new uzp(a)}function zzp(a,b){return{title:a,body:b}}function g7(a){return zzp("Query failed",a)}function Azp(a){return a?RVc[a]||"other":"other"}
function Bzp(a,b){var c=b.ai(),d=b.$p();if(0==a)return g7(jMk(d));switch(c){case 36:case 20:case 56:case 55:case 45:case 46:case 49:case 50:case 51:case 53:case 54:return g7(kMk(3,d,b));case 37:return g7(YLk(d));case 6:return a=(new ct("{objectType, select, chart {The data source took too long to return this chart. Please try again.} pivot_table {The data source took too long to return this pivot table. Please try again.} formula {The data source took too long to return this formula result. Please try again.} record {The data source took too long to return this extract. Please try again.} datasource_preview {The data source took too long to return this preview. Please try again.} other {The data source took too long to return data. Please try again.}}")).format({objectType:Azp(a)}),
zzp("Timed out",iMk(a,d));case 8:return b=SVc.format(nf(pf(),"febpr")?5E4:3E4),c=SVc.format(nf(pf(),"femdrr")?5E4:25E3),b=(new ct("{objectType, select, chart {Results exceed {maxRows} rows. Update this chart and try again.}pivot_table {Update the number of rows and/or columns to a maximum of {dbPivotTableMaxRows} by using filtering, grouping, or customizing number of rows and/or columns. Then, try again.}formula {Results exceed {maxRows} rows. Update this function and try again.} record {Results exceed {dbRecordMaxRows} rows. Update this extract and try again.} datasource_preview {Results exceed {maxRows} rows. Update this connected sheet and try again.} other {Results exceed {maxRows} rows. Update this query and try again.}}")).format({objectType:Azp(a),
maxRows:TVc,dbPivotTableMaxRows:b,dbRecordMaxRows:c}),zzp(1==a?"Rows and/or columns exceed limit":"Too many rows",iMk(b,d));case 18:return zzp("Unsupported type",MY("The query returns a type which is currently not supported."));case 19:return g7(aMk());case 22:return g7(bMk());case 26:return g7(MY("The column type of connected data is not compatible with the operation."));case 30:return g7(MY("Sorting by an array column is not supported for connected sheets and extracts."));case 32:return zzp("Too many customized number of rows & columns",
MY("Your pivot table contains one or more array database columns. Only one can have customized number of rows or columns."));case 33:return g7(dMk());case 35:return d=(new ct("{objectType, select, chart {A column referenced by this chart is not available.} pivot_table {A column referenced by this pivot table is not available.} formula {A column referenced by this formula is not available.} record {A column referenced by this extract is not available.} datasource_preview {The column settings do not match the data source. Try removing sorts, filters and calculated columns and try again.} other {A column referenced by this object is not available.}}")).format({objectType:Azp(a)}),
d=MY(d),g7(d);case 34:return d=(new ct("{objectType, select, chart {A calculated column referenced by this chart no longer exists. Update and try again.} pivot_table {A calculated column referenced by this pivot table no longer exists. Update and try again.} formula {A calculated column referenced by this formula no longer exists. Update and try again.} record {A calculated column referenced by this extract no longer exists. Update and try again.} datasource_preview {A calculated column referenced by this preview no longer exists. Update and try again.} other {A calculated column referenced by this object no longer exists. Update and try again.}}")).format({objectType:Azp(a)}),
d=MY(d),g7(d);case 38:return g7(jMk(null));case 39:return g7(cMk());case 40:return g7(MY("A calculated column has an invalid formula. Update and try again."));case 15:return g7(ZLk(hj(b,6).toUpperCase()));case 14:return g7($Lk(hj(b,6).toUpperCase()));case 42:return g7(eMk());case 43:return g7(fMk());case 44:return g7(gMk());case 47:return g7(MY("The delegated access settings are invalid. The delegated access has been disabled. Please refresh again."));case 48:return g7(MY("Refresh using delegation is unavailable now. Please disable delegated access in connection settings or try again later."));
case 52:return g7(MY("You can not refresh with delegated credentials because you are not in the same organization as the credential owner."))}return g7(jMk(d))}
function Czp(a,b){a=Bzp(a,b);if(dj(b,11)&&dj(b.rc(11,twa),5)){var c=b.rc(11,twa),d=hj(c.wj(),2);if(d&&0!=d.length){var e=hj(c.rc(8,rwa),2),f=!!e&&0<e.length,h=dj(b,8)&&0<jj(b,8),k=new Date(jj(b,8)),l=(new du(1)).format(k);k=(new du(5)).format(k);2==lj(c,1,0)?c=h?"A scheduled refresh created by "+(d+(" failed at "+(k+(" on "+(l+". \n\n"))))):"A scheduled refresh created by "+(d+" failed. \n\n"):(c=h?f?"A query created by "+(d+(" using "+(e+("'s credentials failed at "+(k+(" on "+(l+". \n\n"))))))):
"A query created by "+(d+(" failed at "+(k+(" on "+(l+". \n\n"))))):f?"A query created by "+(d+(" using "+(e+"'s credentials failed. \n\n"))):"A query created by "+(d+" failed. \n\n"),b=b.ai(),f&&(37==b||52==b)&&d!=e&&x8b.isEnabled()&&nf(pf(),"fedd")&&(c+="To attempt refreshing using your own credentials, disable delegated access in connection settings and try again. \n\n"));b=nh("span",{"class":"waffle-dataconnector-error-user"},lh(c))}else b=null}else b=null;if(!b)return a;b=oh([b,a.body]);return{title:a.title,
body:b}}function Dzp(a,b,c,d){this.D=a;this.C=b;this.F=c;this.H=d}Dzp.prototype.Fu=n("D");Dzp.prototype.Cb=n("H");function Ezp(){var a=new gu,b="Configure a project in the Google Cloud Platform console to continue. "+(a.Xd("a",{"class":"goog-inline-block",href:"https://connectedsheets.page.link/addproject",target:"_blank"})+("Learn more"+a.Wd("a")));return a.format(b)}
function Fzp(a){var b=LY(a);a=hj(b,5);b=b.rc(4,OJk);var c=hj(b,3)||"";b=c+(c?".":"")+hj(b,2)+"."+b.getName();b=QJk("select * from `"+b+"`");a=tj(b,5,a).va();b=pLk();b=vj(b,2,2);return nLk(b,a).va()}
function Gzp(){var a='<div class="'+V("waffle-bigquerydbsourcesettingsdialog-project-section")+'"><div class="'+V("waffle-bigquerydbsourcesettingsdialog-project-heading")+'"><h3 class="'+V("waffle-bigquerydbsourcesettingsdialog-project-title")+'">';a=a+'Choose a cloud project</h3></div><div class="'+(V("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper")+'"></div></div>');return zq(a)}
function Hzp(){var a='<div class="'+V("waffle-bigquerydbsourcesettingsdialog-footer-wrapper")+'"><p class="'+V("waffle-bigquerydbsourcesettingsdialog-footer-message")+'">';return zq(a+'Your use of BigQuery is governed by the <a href="https://cloud.google.com/terms/" target="_blank">Google Cloud Platform Terms of Service</a>.</p></div>')}
function Izp(a,b,c,d){bZ.call(this,"waffle-bigquerydbsourcesettingsdialog",d);d=c?"Edit data connection":"Add data connection";this.setTitle(this.Da().Ia("SPAN",void 0,d));this.O=a;this.J=b;this.R=c||null;this.C=new $Uk(void 0,this.Da());this.Pa(this.C);this.F=null;this.D=new yVk(this.Da());this.D.ld("waffle-bigquerydbsourcesettingsdialog-info-icon");this.D.setVisible(!1);this.Pa(this.D)}z(Izp,bZ);
Izp.prototype.Ia=function(){bZ.prototype.Ia.call(this);vq(this.Ec(),Gzp);fUk(this).appendChild(xq(Hzp));var a=this.D.C;a.ld("waffle-bigquerydbsourcesettingsdialog-info-bubble");a.setPosition(2,2,0,-8);var b="Displaying the top "+(Bod.format(1E4)+" projects. To use an unlisted project, enter the full project ID in the search bar and press enter.");a.setContent(hh(b));this.D.render(this.Bb("waffle-bigquerydbsourcesettingsdialog-project-heading"));Zq(this.D.Ua(),b);this.C.render(this.Bb("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"));
(this.C.Op||null).setAttribute("placeholder","Search projects");this.Da().Ln(this.C.Ua(),!1)};Izp.prototype.Qa=function(){var a=this;bZ.prototype.Qa.call(this);this.C.bu(!0);LUk(this.O).then(function(b){a.Dc()&&(b&&0!=b.length||a.J.C(36566),Jzp(a,b),a.C.bu(!1))},function(){a.Dc()&&(a.J.C(36685),Js.qb().postMessage(Ls("Could not connect to BigQuery","error",!0)),Jzp(a,[],!0),a.C.bu(!1))})};
function Jzp(a,b,c){c=void 0===c?!1:c;a.D.setVisible(!0);if(0!=b.length||c)Kzp(a,b),a.getHandler().listen(a.C,"action",function(e){return Lzp(a,e,b)});else{c=a.Da();var d=zn(c,Ezp());gq(a.Ja("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"),!1);c.appendChild(a.Ja("waffle-bigquerydbsourcesettingsdialog-project-section"),c.Ia("DIV","waffle-bigquerydbsourcesettingsdialog-error-caption",d))}}function Kzp(a,b){b=Mzp(b);bVk(a.C,b);fVk(a.C);cVk(a.C)}
function Mzp(a){return zf(a,function(b){return new NUk(b.getId(),b.getName())})}function Lzp(a,b,c){b=b.target.mb();var d=b instanceof NUk?b.fba:b.getValue();br(a.Ua(),"waffle-bigquerydbsourcesettingsdialog-transition-out");a.C.fya("translateX(-24px)").then(function(){return a.resolve(new JUk(c,d,d,"db-source-table",a.R))})}
function Nzp(a){a.F=new QYb("Pick your GCP project","Get started by selecting the Google Cloud project containing the dataset you need. You may change the billing project in the next step.",a.Ja("waffle-bigquerydbsourcesettingsdialog-project-section"),a.Da(),"waffle-bigquerydbsourcesettingsdialog-tooltip");a.F.setPosition(0,2);a.F.C.pG=!1;a.F.render(a.Ec());a.getHandler().Ki(a.F.f2(),Dm,function(){a.F.setVisible(!1)})}
function Ozp(){var a='<div class="'+V("waffle-bigquerywrongskudialog-message")+'">';return zq(a+"Thank you for your interest in connected sheets. Unfortunately, you don't have the required G Suite license to gain access.</div>")}function Pzp(){return zq('<div class="'+V("waffle-bigquerywrongskudialog-learn-more-wrapper")+'"></div>')}
function Qzp(a){aZ.call(this,"waffle-bigquerywrongskudialog",a);this.setTitle(this.Da().Ia("SPAN",void 0,"Upgrade to get access"));this.C=new Xt("Learn more",this.Da());this.Pa(this.C)}z(Qzp,aZ);
Qzp.prototype.Ia=function(){aZ.prototype.Ia.call(this);vq(this.Ec(),Ozp);fUk(this).appendChild(xq(Pzp));this.C.render(this.Ja("waffle-bigquerywrongskudialog-learn-more-wrapper"));this.getHandler().listen(this.C,"action",function(){rq("https://connectedsheets.page.link/support")});var a=this.Ja("waffle-bigquerywrongskudialog-message");a.id=oq(this,"waffle-bigquerywrongskudialog-message");Wq(this.Ua(),"describedby",a.id)};
function Rzp(a,b,c,d,e,f,h,k,l){gLk.call(this,d,h,k,l);this.F=a;this.ma=b;this.Aa=c;this.Fa=f;this.oa=e}z(Rzp,gLk);Rzp.prototype.Ia=function(){gLk.prototype.Ia.call(this);this.Ob(xq(mMk,{b3:!1}))};Rzp.prototype.Qa=function(){gLk.prototype.Qa.call(this);null!=this.ma&&(this.C.setValue(Yk().eDc()(this.ma.Mb(),this.F)),this.canEdit&&this.Iea())};Rzp.prototype.vKb=function(){return this.oa.eJc(this.F,jLk(this),dVc(this.Aa))};
Rzp.prototype.d2b=function(a){var b=this;this.J=!0;this.K1a();a=oMk(pMk(rMk(),this.F),a).va();Syp(px.qb(),a,this.Fa).then(function(c){c=c.gj();3==c.getState()?(c="BigQuery error: "+c.$p(),hLk(b,!1,c)):hLk(b,!0,null);iLk(b)},function(){hLk(b,!1,null);iLk(b)})};function Szp(a,b,c){vMk.call(this,a,b,c)}z(Szp,vMk);Szp.prototype.Qa=function(){vMk.prototype.Qa.call(this)};Szp.prototype.UFa=function(){this.C.ld("waffle-calculated-columns-tooltip-help-bubble");vMk.prototype.UFa.call(this)};
Szp.prototype.J=function(){wMk(this,"https://connectedsheets.page.link/calccolhelp");var a="="+(Yk().uA()("RIGHT")+"(orderId, 4)");var b="="+(Yk().uA()("YEAR")+"(startDate)");var c="="+(Yk().uA()("IF")+"(units > 0, total/units, 0)");this.C.setContent(this.Da().Ia("DIV",void 0,NY("waffle-db-object-formula-tooltip-help-bubble-title","Try these formulas"),NY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Do basic math"),NY("waffle-db-object-formula-tooltip-help-bubble-example","=price * quantity"),
NY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Manipulate text"),NY("waffle-db-object-formula-tooltip-help-bubble-example",a),NY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Use dates"),NY("waffle-db-object-formula-tooltip-help-bubble-example",b),NY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Apply conditional logic"),NY("waffle-db-object-formula-tooltip-help-bubble-example",c),this.h9))};function Tzp(a){qj.call(this,a)}z(Tzp,qj);Tzp.prototype.jg=function(){return this.message.jg()};
Tzp.prototype.ov=function(){return this.message.ov()};function Uzp(a){this.Ib=Zi(a,-1,0)}z(Uzp,$i);Uzp.prototype.yb=function(){return new Tzp(this)};Uzp.prototype.jg=function(){return hj(this,1)};Uzp.prototype.ov=function(){return hj(this,3)};function Vzp(a,b,c,d,e){Zw.call(this,153);this.D=a;this.J=b;this.C=c||"";this.R=d;this.O=e}z(Vzp,Zw);Vzp.prototype.Ig=function(){var a=void 0===a?cj(Uzp):a;a=new Tzp(a);a=tj(a,1,this.D);a=tj(a,4,this.J);a=tj(a,3,this.C);a=tj(a,2,this.R);return cwa(a,5,this.O).va()};
function Wzp(a,b,c){zm.call(this,a);this.Aw=b;this.C=c}z(Wzp,zm);function Xzp(a,b,c,d,e,f,h,k,l,m,p){IKk.call(this,a,null==b,e,f,m,p);this.dj=new Szp(m,p,this.Da());this.Pa(this.dj);this.oa=b;null==b?b=null:(e=Pwa(),e.Zo(1,2),b=tj(e,2,b).va());this.V=b;this.$a=c;this.Va=d;this.F=new Rzp(a,this.V,d,f,k,l,m,p,this.Da());this.Pa(this.F);this.Za=h}z(Xzp,IKk);u=Xzp.prototype;u.Wa=function(){IKk.prototype.Wa.call(this)};
u.Ia=function(){IKk.prototype.Ia.call(this);var a=null==this.oa?"Add calculated column":this.canEdit?"Edit calculated column":"View calculated column";this.setTitle(a);var b=iLb(this);b&&Zq(b,a);a=xq(tMk,{canEdit:this.canEdit,JEb:"Calculated column name",description:"Calculated columns let you create new columns for better analysis by using Sheets functions and the current data in your connected sheet."});b=this.Ec();this.Da().appendChild(b,a);this.dj.render(this.Ja(KY.JAb));this.F.render(this.Ja(KY.Hrb))};
u.Qa=function(){IKk.prototype.Qa.call(this);null!=this.V&&(this.C.setValue(Dw(this.V,this.Aw)),this.$bb());this.LGa();this.getHandler().listen(this.F,"validation-update",this.LGa)};u.Yf=function(){IKk.prototype.Yf.call(this)};u.n_b=function(){for(var a=[],b=ea(this.$a),c=b.next();!c.done;c=b.next())c=c.value,dj(fx(c),2)||a.push(c);JKk(this,a)};u.Cob=function(){var a=pUc(this.X,!1,!1,!0,!1);EKk(this.O,a)};
u.hNb=function(){var a=this,b=jLk(this.F);if(!sg(b)){var c=null==this.oa;b=new Vzp(this.Aw,yEk(this.C.getValue()),this.oa,b,gyp(this.Va));var d=c?36645:36647,e=c?36644:36646;$w(b,function(f){a.ma.C(f?e:d,a.Qs);f&&a.dispatchEvent(new Wzp("update",a.Aw,c))});this.Za.C(b)}};u.oLb=function(a){a=a.target.getValue();a=XTc(a,this.Aw);kLk(this.F,a)};u.XLb=function(a){a=a.target.getValue().getName();lLk(this.F,a)};
u.J1a=function(){if(th(this.C.getValue()))var a=null;else a:{var b=this.Va,c=this.C.getValue();a=this.V;c=yEk(c);if(sg(c))a="Calculated column name cannot be empty";else{for(var d=ea(b.C.keys()),e=d.next();!e.done;e=d.next())if(e=e.value,rg(e,c))if(d=null!=a,b=b.C.get(e),d&&a.equals(b))break;else{a="A column named "+(c+" already exists");break a}a=null}}return a};u.sPb=function(){return this.F.O};
function Yzp(){var a='<div class="'+V("waffle-dbanswers-answers-bar")+'"><div class="'+V("waffle-dbanswers-answers-bar-controls")+'"><div class="'+V("waffle-dbanswers-answers-bar-input")+'"></div><div class="'+V("waffle-dbanswers-answers-bar-enable-button")+'">';a=a+'Enable</div></div><div class="'+(V("waffle-dbanswers-answers-bar-message")+'"></div></div>');return zq(a)}
function Zzp(){var a='<div class="'+V("waffle-dbanswers-answers-bar-enable-answers-popup")+'">',b='To perform natural language queries on this data, ask the table owner or admin to follow the <div class="'+(V("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link")+'">setup instructions.</div>');return zq(a+b+"</div>")}
function $zp(a,b){mq.call(this,b);this.F=a;this.C=new Tr;SMb(this.C,0);TMb(this.C,5,5,5,5);xYj(this.C,!0);this.Ca(this.C);this.D=new Zr(null,new Hoe,this.Da());this.Pa(this.D)}z($zp,mq);u=$zp.prototype;u.Ia=function(){var a=xq(Zzp);this.Ob(a);Wq(a,"hidden",!0);gq(a,!1);this.C.mJ(a);this.D.ub(this.Bb("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link"))};u.Qa=function(){mq.prototype.Qa.call(this);this.getHandler().listen(this.D,"action",this.V5c)};
u.xo=function(a){this.C.setPosition(new fs(a,0,!0))};u.setVisible=function(a){this.C.setVisible(a);a&&this.D.Ua().focus()};u.isVisible=function(){return this.C.isVisible()};u.Je=function(){this.C.Je()};u.V5c=function(a){a.stopPropagation();a.preventDefault();a=Cp(new Bp,75).va();this.F.C(36761,a);nf(pf(),"docs-idu")?ola("https://sites.google.com/corp/google.com/data-qna#h.p_Vf6xbc97l9jL"):ola("https://docs.google.com/document/u/1/d/e/2PACX-1vRNytdUb20j3I6WPQXLmmIfOHkWR3a0iPg4ck1AdXzSznrW3USl3NtYGIk34sBQaxl_fSiUPclFqJK4/pub?urp=gmail_link#h.ng0zmdirli5c")};
function aAp(a,b,c,d,e,f){cZ.call(this,a,b,c,LVc.qb(),"db",d,e,f);this.D="";this.V=0;this.oa=new Oz(void 0,this.Da());this.Pa(this.oa);this.X=new $zp(b,this.Da());this.Pa(this.X);this.ma=null}z(aAp,cZ);u=aAp.prototype;u.Sd=function(a){this.Ob(a);var b=xq(Yzp);this.Da().appendChild(a,b);a=this.Bb("waffle-dbanswers-answers-bar-input");this.H.render(a);this.oa.ub(this.Bb("waffle-dbanswers-answers-bar-enable-button"));this.X.render();this.X.xo(this.oa.Ua())};
u.Qa=function(){cZ.prototype.Qa.call(this);this.moa()};u.moa=function(){cZ.prototype.moa.call(this);this.getHandler().listen(this.oa,"action",this.IUc)};u.v1=function(){return YLc(this.J.C)&&nf(pf(),"feda")&&!Cr().C?cZ.prototype.v1.call(this):!1};u.Ya=function(a){this.Dc()&&(0!=this.V&&nf(pf(),"fedaic")?(cZ.prototype.Ya.call(this,!1),bAp(this,!0)):(bAp(this,!1),cZ.prototype.Ya.call(this,a)))};u.jaa=function(){cZ.prototype.jaa.call(this);this.X.isVisible()&&this.X.Je()};
u.UNb=function(a){jKk(a,null,this.D,this.F)};u.EGa=function(){this.D?cAp(this):this.vS();kKk(null,this.D,this.F)};u.vS=function(){cZ.prototype.vS.call(this);this.D="";kKk(null,null,this.F)};u.UOa=function(){return dAp(this.V)};u.Yob=q(!0);
function eAp(a,b){a.D!=b&&(a.D=b,nf(pf(),"fedaic")?(a.ma&&a.ma.cancel(),a.ma=Byp(px.qb(),a.D),Ln(a.ma.then(function(c){a.V=c.getError();c=0==a.V;a.Ya(c);c?a.v1()&&a.EGa():a.vS()},function(c){c instanceof Mn||(a.V=4,a.Ya(!1),a.vS())}),function(){a.ma=null})):a.v1()&&a.EGa())}function cAp(a){if(zVk(a)){var b=a.R;b.D=a.D;b.E5();Pyp(b);b.U$([]);var c=a.J;Xn(function(){a.D&&Ax(c.X,a.D,!0).then(function(d){return fAp(a,d,a.D)})},3E3)}}
function fAp(a,b,c){b.forEach(function(d){var e=XTc(d,c);if(null!=e){var f=a.R;a:{if(d.vd())switch(d.getType()){case 1:case 2:case 4:case 5:case 6:case 7:d="$dim";break a;case 3:d="$met";break a}d="$unu"}BVc(f,e,d)}})}function bAp(a,b){a.oa.setVisible(1==a.V);var c=a.Bb("waffle-dbanswers-answers-bar-message");b=b?dAp(a.V):"";a.Da().Jh(c,b)}u.IUc=function(){this.O.C(36760,AVk(this));this.X.setVisible(!0)};
function dAp(a){switch(a){case 1:return"The admin for this table hasn't enabled Answers yet.";case 2:return"Answers is not yet supported for data sets created by custom query.";case 3:return"The admin for this table hasn't enabled Answers yet.";case 4:return"Answers is unavailable at the moment, please try again later.";case 5:return"This data table is being setup for Answers in the background. Please try again in some time.";default:return""}}
function gAp(){return zq('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2-3.5l6-4.5-6-4.5z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}
function hAp(){return zq('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9-4h2v2h-2zm0-6h2v4h-2z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}function iAp(){var a='<div class="'+V("waffle-dbsource-pill-menuitem")+'">'+wUc();return zq(a+"Learn more about BigQuery</div>")}
function jAp(){var a='<div class="'+V("waffle-dbsource-pill-menuitem")+'">'+hAp();return zq(a+"Send feedback</div>")}function kAp(){var a='<div class="'+V("waffle-dbsource-pill-menuitem waffle-dbsource-configbar-watch-tutorial-menuitem")+'">'+gAp()+"<div>";a=a+'Watch tutorial<div class="'+(V("waffle-dbsource-configbar-watch-tutorial-menuitem-caption")+'">');return zq(a+"Learn the ins and outs of Connected Sheets</div></div></div>")}
function lAp(){return zq('<div class="'+V("waffle-dbsource-configbar-actions")+'"><div class="'+V("waffle-dbsource-configbar-columns-menu-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-chart-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-pivot-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-function-button-wrapper")+
'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-table-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-calculated-column-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-column-insights-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-answers-wrapper")+'"></div></div>')}
function mAp(a){a=a.JOb;var b='<div class="'+V("waffle-dbsource-configbar-wrapper")+'"><div class="'+V("waffle-dbsource-configbar")+'"><div class="'+V("waffle-dbsource-configbar-header")+'"><div class="'+V("waffle-dbsource-configbar-header-icon")+'">'+VKk(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';b+=Mq("Connected sheet name");b+='"></div><div class="'+V("waffle-dbsource-configbar-separator")+'"></div><div class="'+V("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+V("waffle-dbsource-configbar-watch-tutorial-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-send-feedback-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div></div></div>'+lAp()+"</div></div>"+(a?
'<div class="'+V("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>':"");return zq(b)}
function nAp(a){a=a.JOb;var b='<div class="'+V("waffle-dbsource-configbar-wrapper")+'"><div class="'+V("waffle-dbsource-configbar")+'"><div class="'+V("waffle-dbsource-configbar-header")+'"><div class="'+V("waffle-dbsource-configbar-header-icon")+'">'+VKk(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';b+=Mq("Connected sheet name");b+='"></div><div class="'+V("waffle-dbsource-configbar-separator")+'"></div><div class="'+V("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-schedules-widget-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+V("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")+'"></div></div></div>'+lAp()+"</div></div>"+(a?'<div class="'+
V("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>':"");return zq(b)}
function oAp(){var a=zq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#188038" fill-rule="nonzero"><path d="M14.5263158 2C15.3368421 2 16 2.7 16 3.55555556V14.4444444C16 15.3 15.3368421 16 14.5263158 16H3.47368421C2.66315789 16 2 15.3 2 14.4444444V3.55555556C2 2.7 2.66315789 2 3.47368421 2H14.5263158zM3.5 3.5v11h11v-11h-11z"/><path d="M6.75 12.75h-1.5V7.5h1.5zM9.75 12.75h-1.5v-7.5h1.5zM12.75 12.75h-1.5v-3h1.5z"/></g></svg>');return zq(a+"<span>Chart</span>")}
function pAp(){var a=zq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" fill-rule="evenodd" d="M10 13h1.185c.9975 0 1.815-.81 1.815-1.815V10h-2.25l3-3 3 3H14.5v1.185c0 1.83-1.485 3.315-3.315 3.315H10v2.25l-3-3 3-3V13zM8 6V2h6.5454545C15.3454545 2 16 2.72 16 3.6V6H8zM2 6V3.6C2 2.72 2.72 2 3.6 2H6v4H2zm1.6 10c-.88 0-1.6-.6545455-1.6-1.4545455V8h4v8H3.6z"/></svg>');return zq(a+"<span>Pivot table</span>")}
function qAp(){var a=BVk()+"<span>";return zq(a+"Extract</span>")}function rAp(){var a=zq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" d="M15 2H3v1.75L8.143 9 3 14.25V16h12v-2.625H7.286L11.571 9 7.286 4.625H15z"/></svg>');return zq(a+"<span>Function</span>")}function sAp(a){a=a.label;return zq('<span class="'+V("waffle-dbsource-configbar-column-insights-icon")+'">'+Gt("docs-icon-img docs-icon-insights")+"</span><span>"+yq(a)+"</span>")}
function tAp(){var a=zq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path fill="#188038" d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"/></g></svg>');return zq(a+"<span>Calculated column</span>")}function uAp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+gAp()+"<span>";return zq(a+"Watch tutorial</span></span>")}
function vAp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+hAp()+"<span>";return zq(a+"Send feedback</span></span>")}function wAp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+Gt("docs-icon-img docs-icon-info-outline-grey","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return zq(a+"Learn more</span></span>")}
function xAp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+Gt("docs-icon-img docs-icon-settings","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return zq(a+"Connection settings</span></span>")}
function yAp(){return zq('<div class="'+V("waffle-dbsource-configbar-schedules-widget")+'"><div class="'+V("waffle-dbsource-configbar-schedules-widget-content")+'"><div class="'+V("waffle-dbsource-configbar-schedules-widget-last-refresh")+'"><span class="'+V("waffle-dbsource-configbar-schedules-widget-last-refresh-content")+'"></span><span class="'+V("waffle-dbsource-configbar-schedules-widget-last-refresh-divider")+'"></span></div><div class="'+V("waffle-dbsource-configbar-schedules-widget-next-refresh")+
'"><span class="'+V("waffle-dbsource-configbar-schedules-widget-next-refresh-content")+'"></span><span class="'+V("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper")+'"></span></div></div><div class="'+V("waffle-dbsource-configbar-schedules-widget-main-button-wrapper")+'"></div></div>')}
function zAp(a,b){Cy.call(this,wq(wAp),new es(b),lxe.qb(),b);this.C=a;this.D=new Map([["bigquery-helpdoc",x7b],["send-feedback",this.C.Oa("docs-feedback")],["watch-tutorial",L8b]]);this.Me(new as(xq(jAp),"send-feedback",this.Da()));this.Me(new ds(this.Da()));this.Me(new as(xq(kAp),"watch-tutorial",this.Da()));this.Me(new ds(this.Da()));this.Me(new as(xq(iAp),"bigquery-helpdoc",this.Da()))}z(zAp,Cy);
zAp.prototype.Qa=function(){Cy.prototype.Qa.call(this);br(this.Hc().getElement(),"waffle-dbsource-pill-menu");br(this.Hc().getElement(),"docs-gm");this.getHandler().listen(this.Hc(),"action",this.F)};zAp.prototype.F=function(a){a=a.target.mb();a=this.D.get(a);if(a.isEnabled()){var b;a==this.C.Oa("docs-feedback")&&(b={source:"big-sheets-feedback"});a.Nb(b)}};
function AAp(a){var b=a.label;a=a.bq;return zq((a?'<div class="'+V("goog-menuitem-icon")+" "+V("waffle-charteditor-column-filtered-menu-item-icon")+" "+V(a)+'"></div>':"")+'<span class="'+V("waffle-datasource-configbar-columns-menu-item-label")+'">'+yq(b)+"</span>")}function BAp(){return zq('<div class="'+V("waffle-datasource-configbar-columns-menu-spinner-container")+'"></div>')}
function CAp(a){es.call(this,a);this.D=new QY(!1);this.Ca(this.D);this.C=new as(xq(BAp),void 0,this.Da());this.C.UR(!1);this.Pa(this.C)}z(CAp,es);CAp.prototype.Qa=function(){es.prototype.Qa.call(this);br(this.Ua(),"waffle-datasource-configbar-columns-menu")};CAp.prototype.Ia=function(){es.prototype.Ia.call(this);this.C.render(this.Ua());this.D.render(this.C.Ja("waffle-datasource-configbar-columns-menu-spinner-container"))};
CAp.prototype.j1=function(a,b){a=ea(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=XTc(c,b);null!==d&&this.Mm(d,wKk(c.getType()))}};CAp.prototype.Mm=function(a,b){this.Pa(new as(xq(AAp,{label:a,bq:b}),void 0,this.Da()),!0)};function DAp(a,b){var c=a.C.getElement();c&&(fr(c,"waffle-datasource-configbar-columns-menu-loading",b),gq(c,b),a.D.setActive(b))}function EAp(){es.apply(this,arguments)}z(EAp,es);EAp.prototype.Qa=function(){es.prototype.Qa.call(this);br(this.Ua(),"waffle-datasource-configbar-formula-menu")};
EAp.prototype.m1=function(a){var b=this;this.Pa(a,!0);this.getHandler().listen(a,"action",function(){var c=new Kv("insert-formula-function");c.lOa=a.getValue();b.dispatchEvent(c)})};
function FAp(a,b,c,d){mq.call(this,d);this.J=a;this.R=b;this.V=c;this.H=!1;this.F=null;this.D=new Zr("Edit",ex.qb(),d);this.Pa(this.D);this.C=new By("Schedule refresh");this.C.ld("waffle-dbsource-configbar-schedules-widget-main-button");this.C.ld("waffle-dbsource-flat-default");this.Pa(this.C);this.O=new ts(this);this.Ca(this.O);this.O.Fc(lu,Xo,this.refresh)}z(FAp,mq);u=FAp.prototype;u.Ia=function(){mq.prototype.Ia.call(this);this.Ob(xq(yAp))};
u.Qa=function(){mq.prototype.Qa.call(this);this.D.render(this.Ja("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper"));this.C.render(this.Ja("waffle-dbsource-configbar-schedules-widget-main-button-wrapper"));gq(this.Ua(),!1);this.getHandler().listen(this.C,"action",this.AZc).listen(this.D,"action",this.Z_b).listen(Vw,"load-schedules-on-config-bar",this.Oeb);this.Oeb()};
u.refresh=function(){if(!this.isDisposed())if(!this.H||this.V.hj())gq(this.Ua(),!1);else{var a=this.Da(),b=lu.isEnabled();if(null==this.F)this.C.setVisible(!0),gq(this.Ja("waffle-dbsource-configbar-schedules-widget-content"),!1),dr(this.Ua(),"waffle-dbsource-configbar-schedules-widget-highlight"),ms(this.C.Ua(),"Schedule a refresh for all connected objects associated with this sheet",void 0);else{this.C.setVisible(!1);gq(this.Ja("waffle-dbsource-configbar-schedules-widget-content"),!0);br(this.Ua(),
"waffle-dbsource-configbar-schedules-widget-highlight");ms(this.D.Ua(),"Refresh time for all objects related to current datasource",void 0);var c=this.F.getStatus();if(dj(c,4)){gq(this.Ja("waffle-dbsource-configbar-schedules-widget-last-refresh"),!0);var d=new Date(1E3*jj(c,4)),e=!1,f=!0;e=void 0===e?!0:e;f=void 0===f?!1:f;var h=new gu;var k=CVk(this.J);d=(e||d.getDate()!=(new Date).getDate()?pxe.format(d,k)+(f?", ":" "):"")+mxe.format(d,k);h=h.format(d);d=this.Ja("waffle-dbsource-configbar-schedules-widget-last-refresh-content");
a.Te(d);a.appendChild(d,zn(a,oh(nh("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},"Updated: "),nh("span",void 0,h))))}else gq(this.Ja("waffle-dbsource-configbar-schedules-widget-last-refresh"),!1);fj(ZEk(this.F),1)?(h=new Date(1E3*jj(c,2)),d=new Date(1E3*jj(c,3)),h=FVk(h,d,this.J,!1,!1,!1,!0,!0)):h="Paused";d=this.Ja("waffle-dbsource-configbar-schedules-widget-next-refresh-content");a.Te(d);a.appendChild(d,zn(a,oh(nh("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},
dj(c,4)?"Next: ":"Next refresh: "),nh("span",void 0,h))));this.D.setVisible(b)}gq(this.Ua(),!0)}};u.Oeb=function(){var a=this;CFk().then(function(b){a.isDisposed()||(b=mj(b,1,YEk).Lc(),0==b.length?a.F=null:a.F=b[0],a.H=!0,a.refresh())},function(){Js.qb().postMessage(Ls("Error loading schedule configuration.","error",!0));a.H=!1;a.refresh()})};u.AZc=function(){this.Oeb();this.Z_b()};u.Z_b=function(){var a=Cp(new Bp,109).va();this.R.C(116123,a);qQc(!0)};
function GAp(a,b,c,d,e,f,h,k,l){h=void 0===h?null:h;k=void 0===k?null:k;l=void 0===l?null:l;Yt.call(this,a,b,c,d);e||(e=new d0b,this.Ca(e));this.J=e;this.F=f;this.yl=h;this.X=k;this.V=l;this.C=0;this.R=new LYb(this.Rp.IOa(),!0,!0);this.F&&this.F.Hm(this.R)}z(GAp,Yt);u=GAp.prototype;u.hAa=function(a){this.Rp.isVisible()&&!this.isDismissed()&&this.F&&sWb(this.F,this.R);this.C=1;Yt.prototype.hAa.call(this,a);this.C=0};
u.pAa=function(a){Yt.prototype.pAa.call(this,a);this.J.Ht()?c0b(this):Km(this.H,this.J.rea(),ua(this.w9b,this))};u.w9b=function(){this.J.Ht()&&(c0b(this),this.aN())};u.kYa=function(){this.Rp.render(this.yl)};u.show=function(){this.isDismissed()||this.Rp.isVisible()||this.kYa()};u.fAa=function(a){this.C=2;Yt.prototype.fAa.call(this,a);this.C=0};u.gRa=function(a){this.C=3;Yt.prototype.gRa.call(this,a);this.C=0};u.rM=function(){var a=this.isDismissed();Yt.prototype.rM.call(this);!a&&this.X&&this.X(this.C)};
u.qAa=function(a){Yt.prototype.qAa.call(this,a);this.V&&this.V()};u.Je=function(){!this.isDismissed()&&this.Rp.isVisible()&&this.Rp.IOa().Je()};function HAp(){var a='<div class="'+V("waffle-dbsource-previewbar")+'"><div class="'+V("waffle-dbsource-previewbar-content")+'"><span class="'+V("waffle-dbsource-previewbar-text")+'">';a=a+'Preview</span><span class="'+(V("waffle-dbsource-previewbar-info-icon-wrapper")+'"></span></div></div>');return zq(a)}
function IAp(a){var b=a.Sdd;a='<div class="'+V("waffle-dbsource-previewbar-info-bubble-content")+'"><div class="'+V("waffle-dbsource-previewbar-info-bubble-title")+'">';b="This sheet shows a preview of up to "+(yq(b)+" rows");a=a+b+('</div><div class="'+V("waffle-dbsource-previewbar-info-bubble-body")+'"><span>'+bsd()+' </span><span class="'+V("waffle-dbsource-previewbar-info-bubble-link-button")+" "+V("goog-link-button")+'">'+csd()+'</span></div><div class="'+V("waffle-dbsource-previewbar-info-bubble-button-wrapper")+
'"></div></div>');return zq(a)}function JAp(a,b){mq.call(this,b);this.H=a;this.C=new yVk(this.Da(),2,xq($yp,{color:"#5f6368",tad:10}));this.Pa(this.C);this.D=new By("Create extract",this.Da());this.D.ld("waffle-dbsource-flat-default");this.Pa(this.D)}z(JAp,mq);JAp.prototype.Ia=function(){this.Ob(xq(HAp));var a=this.C.C;a.ld("waffle-dbsource-previewbar-info-bubble");a.Dy(!0);Xr(a,!1);a.setPosition(1,2);a.setContent(xq(IAp,{Sdd:500}))};
JAp.prototype.Qa=function(){var a=this;mq.prototype.Qa.call(this);var b=this.Ja("waffle-dbsource-previewbar-info-icon-wrapper");this.C.render(b);var c=this.C.C;this.D.render(c.Ja("waffle-dbsource-previewbar-info-bubble-button-wrapper"));var d=c.Ja("jfk-bubble-closebtn");d.appendChild(xq(bUk));SNb(d,Yq(d));ms(this.C.eY().Ua(),"Show information about this preview",void 0);var e=new Pt(c.Ua(),this.Da());Qt(e);this.Ca(e);if(e=xKk())br(b,e),br(d,e);this.getHandler().listen(this.D,"action",function(){a.getHandler().Td(c,
"hide",a.F);a.C.C.setVisible(!1);a.dispatchEvent("create-extract-button-action")}).listen(this.H,"N",function(){Xn(function(){return a.C.C.Je()})}).listen(this.C.Ua(),"keydown",function(f){var h=a.C.C;h.isVisible()&&9===f.keyCode&&(f.preventDefault(),f.stopPropagation(),f=h.Ja("waffle-dbsource-previewbar-info-bubble-link-button"),a.Da().cI(f).focus())}).listen(c.Ua(),"keydown",function(f){27===f.keyCode&&c.setVisible(!1)}).listen(c,"beforeshow",function(){a.getHandler().$d(c,"hide",a.F)})};
JAp.prototype.F=function(){var a=this.C.eY().getElement();a&&a.focus()};var KAp={enabled:!0,selected:!0,visible:!0},LAp={enabled:!0};function MAp(){zm.call(this,"configbar-dom-focus-out")}z(MAp,zm);function NAp(a,b){zm.call(this,"datasheet-rename");this.xm=a;this.name=b}z(NAp,zm);
function OAp(a,b,c,d,e,f,h,k,l,m,p){mq.call(this,p);p=nf(pf(),"fdsrfu");var r=nf(pf(),"fedpi");this.Ra=a;this.D=b;this.X=c;this.ad=d;this.Ka=b.X;this.qc=k;this.Pb=l;this.Ac=m;this.Qc=f;this.Ga=new us;this.Ca(this.Ga);this.O=new Cy("Columns",new CAp(this.Da()),void 0,this.Da());this.O.ld("waffle-dbsource-configbar-columns-menu-button");this.O.yn(!0);this.Pa(this.O);this.zb=PAp(this,"waffle-dbsource-configbar-chart-button",xq(oAp));this.Jb=PAp(this,"waffle-dbsource-configbar-pivot-button",xq(pAp));
this.Ta=PAp(this,"waffle-dbsource-configbar-table-button",xq(qAp));a=xq(rAp);this.ma=new ls(a,new EAp(this.Da()),Qwe.qb(),this.Da());this.ma.ld("waffle-dbsource-configbar-function-button");this.ma.yn(!0);this.ma.Tu(!0);this.Pa(this.ma);this.Aa=PAp(this,"waffle-dbsource-configbar-calculated-column-button",xq(tAp));this.Fa=this.F=this.Va=null;nf(pf(),"fedciv")&&(this.F=PAp(this,"waffle-dbsource-configbar-column-insights-button",xq(sAp,{label:"Column stats"})),this.Va=new M$j,this.Ca(this.Va));this.V=
new By("Refresh options");this.V.ld("waffle-dbsource-configbar-refresh-options-button");this.V.ld("waffle-dbsource-flat-default");this.Pa(this.V);this.H=null;p?(this.H=PAp(this,"waffle-dbsource-configbar-secondary-button",xq(xAp)),this.$a=new zAp(this.Pb,this.Da()),this.$a.ld("waffle-dbsource-configbar-secondary-button"),this.$a.yn(!0),this.Pa(this.$a),this.ib=new FAp(h,this.X,this.D,this.Da())):(this.sb=PAp(this,"waffle-dbsource-configbar-secondary-button",xq(uAp)),this.rb=PAp(this,"waffle-dbsource-configbar-secondary-button",
xq(vAp)),this.H=new By(xq(Ft,{icon:"docs-icon-img docs-icon-settings"}),this.Da()),this.H.ld("waffle-dbsource-configbar-connection-settings-button"),this.Pa(this.H));(this.C=r?new JAp(e,this.Da()):null)&&this.Pa(this.C);this.Dd=new Map([[this.O,""],[this.zb,"chart"],[this.Jb,"pivot table"],[this.Ta,"table"],[this.ma,"function"],[this.Aa,""],[this.V,""],[this.H,""]]);this.Oc=new Set;nf(pf(),"fedsccm")||this.Oc.add(this.O);this.Kc=new Map([[this.V,X7b],[this.H,F8b],[this.Aa,s8b]]);this.J=null;nf(pf(),
"feda")&&!Cr().C&&(this.J=new aAp(this.D,this.X,this.ad,e,75,this.Da()),this.Pa(this.J));this.hb=this.R=null;this.Fb=!1;this.oa=null;this.Za=new Set}z(OAp,mq);u=OAp.prototype;u.Ia=function(){var a=nf(pf(),"fdsrfu"),b=nf(pf(),"fedpi");this.Ob(xq(a?nAp:mAp,{JOb:b}))};
u.Qa=function(){var a=this;mq.prototype.Qa.call(this);var b=nf(pf(),"fdsrfu");this.O.render(this.Ja("waffle-dbsource-configbar-columns-menu-button-wrapper"));this.zb.render(this.Ja("waffle-dbsource-configbar-chart-button-wrapper"));this.Jb.render(this.Ja("waffle-dbsource-configbar-pivot-button-wrapper"));this.Ta.render(this.Ja("waffle-dbsource-configbar-table-button-wrapper"));this.ma.render(this.Ja("waffle-dbsource-configbar-function-button-wrapper"));this.Aa.render(this.Ja("waffle-dbsource-configbar-calculated-column-button-wrapper"));
this.F&&(this.F.render(this.Ja("waffle-dbsource-configbar-column-insights-button-wrapper")),this.Va.Zj(this.F.Ua()));this.V.render(this.Ja("waffle-dbsource-configbar-refresh-options-button-wrapper"));this.H.render(this.Ja("waffle-dbsource-configbar-connection-settings-button-wrapper"));b?(this.$a.render(this.Ja("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")),this.ib.render(this.Ja("waffle-dbsource-configbar-schedules-widget-wrapper"))):(this.sb.render(this.Ja("waffle-dbsource-configbar-watch-tutorial-button-wrapper")),
this.rb.render(this.Ja("waffle-dbsource-configbar-send-feedback-button-wrapper")),vs(this.Ga,this.sb,L8b,KAp),vs(this.Ga,this.rb,this.Pb.Oa("docs-feedback"),KAp,function(){return{source:"big-sheets-feedback"}}));this.J&&this.J.ub(this.Ja("waffle-dbsource-configbar-answers-wrapper"));this.C&&(this.C.render(this.Ja("waffle-dbsource-configbar-preview-bar-wrapper")),this.getHandler().listen(this.C,"create-extract-button-action",function(){return QAp(a,111)}));vs(this.Ga,this.V,X7b);vs(this.Ga,this.Aa,
s8b);vs(this.Ga,this.H,F8b,LAp,function(){return new gVk(RAp(a),"show-current-source")});this.R=this.Ja("waffle-dbsource-configbar-header-title");this.getHandler().listen(this.zb,"action",this.QPc).listen(this.Jb,"action",this.z2c).listen(this.Ta,"action",function(){return QAp(a,109)}).listen(this.ma,"show",this.FSc).listen(this.Aa,"action",this.sPc).listen(this.V,"action",this.W3c).listen(this.O,"show",this.cRc).listen(this.Ra,"ua",this.C9b).listen(this.R,["focus","mousedown"],this.o0c).listen(this.D,
"external_datasource_status",this.g5c);this.F&&this.getHandler().listen(this.F.Ua(),["mouseenter","focus"],this.hsd).listen(this.F,"action",this.$Qc);this.getHandler().listen(this.C?this.C.Ua():this.J?this.J.getElement():this.F?this.F.Ua():this.Aa.Ua(),"keydown",this.CYc);nf(pf(),"fedsccm")||this.O.setVisible(!1);Cr().C&&(b?(this.V.setVisible(!1),this.H.setVisible(!1),this.$a.setVisible(!1)):(this.sb.setVisible(!1),this.rb.setVisible(!1),this.H.setVisible(!1)));this.refresh()};
u.CYc=function(a){9===a.keyCode&&(a.preventDefault(),this.dispatchEvent(new MAp))};u.setVisible=function(a){gq(this.Ua(),a);if(this.J&&a){var b="",c=fz(this.Ra);c&&c.jg()&&(b=c.jg());eAp(this.J,b)}this.C&&!a&&(b=this.C.C.C,b.setVisible(!1),b.Je());!this.oa||this.oa.isDismissed()||a||this.oa.rM();!this.Fa||this.Fa.isDismissed()||a||this.Fa.rM()};u.isVisible=function(){return hq(this.Ua())};
u.refresh=function(){SAp(this,fz(this.Ra).Pg());var a=this.Ja("waffle-dbsource-configbar-header-subtitle"),b=TAp(this),c=this.Da();b?c.Jh(a,b+" Rows"):c.Jh(a,"");a=!(this.D.hj()||this.D.D.ul());UAp(this,a,vFk(this.Ka,RAp(this)),this.D.xg());this.ib&&this.ib.refresh();this.O.Qe(!1);VAp(this);this.J&&eAp(this.J,RAp(this));this.hb&&(Yn(this.hb),this.hb=null)};function PAp(a,b,c){c=new Oz(c,a.Da());c.ld(b);a.Pa(c);return c}u.QPc=function(){c3c(this.Ka);lQc(null,void 0,RAp(this));this.X.C(36528,WAp())};
u.z2c=function(){c3c(this.Ka);var a=void 0===a?cj(hKc):a;a=new iKc(a);var b=RAp(this);a=tj(a,1,b).va();a=uKc(KJk().yb(),a);a=sj(a,17,!1).va();a=LJk(a);a=new CPk(null,wMc(a),void 0);fQc(a);this.X.C(36527,WAp())};function QAp(a,b){c3c(a.Ka);pQc(RAp(a));a.X.C(36529,WAp(b))}u.FSc=function(){var a=this.ma.Hc();if(a&&0==a.yd()){a=this.ma.Hc();var b=S$j(new R$j(this.D.Ta,a,this.Qc,this.D.D.Wh()),void 0,!0);b=ea(b);for(var c=b.next();!c.done;c=b.next())a.m1(c.value)}c3c(this.Ka)};
u.sPc=function(){this.X.C(36748,WAp())};u.W3c=function(){this.X.C(36749,WAp())};u.$Qc=function(){f$b.Nb(this.F,XAp(this))};u.o0c=function(a){if(!this.R.isContentEditable&&!by(this.D)){this.R.contentEditable=!0;if("focus"===a.type){a=window.getSelection();var b=document.createRange();b.selectNodeContents(this.R);a.removeAllRanges();a.addRange(b)}this.getHandler().listen(this.R,"keydown",this.B9b).listen(this.R,"blur",this.y6c)}};
u.B9b=function(a){switch(a.keyCode){case 13:this.R.blur();break;case 27:YAp(this,!0)}};u.y6c=function(){var a=this;this.Fb||(window.getSelection().removeAllRanges(),this.hb=Xn(function(){a.dispatchEvent(new NAp(fz(a.Ra).Cb(),qn(a.R)));YAp(a,!1)}))};function YAp(a,b){a.R.contentEditable=!1;Hm(a.R,"keydown");Hm(a.R,"blur");b&&SAp(a,fz(a.Ra).Pg())}u.cRc=function(){var a=this,b=this.O.Hc();DAp(b,!0);var c=RAp(this);Ax(this.Ka,c).then(function(d){VAp(a);0<d.length?b.j1(d,c):(a.O.Qe(!1),a.refresh())})};
u.C9b=function(a){SAp(this,a.zv)};u.g5c=function(){null!=ZLc(this.D.C)&&this.refresh()};function SAp(a,b){var c=a.Ja("waffle-dbsource-configbar-header-title");a.Da().Jh(c,b)}u.hsd=function(){O$j(this.Va);T7b.Nb(this.Va,XAp(this))};
function UAp(a,b,c,d){var e=b&&!d,f=null==ZAp(c);a.Dd.forEach(function(h,k){var l=!a.Oc.has(k),m=!a.Kc.has(k)||a.Kc.get(k).isEnabled();k==a.V?k.Ya(b&&l&&m):k!=a.H&&(l=e&&f&&l&&m,k.Ya(l),k==a.Ta&&a.C&&a.C.D.Ya(l));l=ZAp(c);m=TAp(a);var p;k.isEnabled()&&k==a.Ta?p=nf(pf(),"femdrr")?"Insert an extract of up to 50k rows":"Insert an extract of up to 25k rows":k.isEnabled()&&k==a.Aa?p="Add a calculated column":k.isEnabled()&&k==a.V?p="Refresh options for all connections and associated objects":k.isEnabled()&&
k==a.H?p="Update connection settings":p=k.isEnabled()&&m&&h?"Insert "+(h+(" based on "+(m+" rows"))):k.isEnabled()&&h?"Insert "+h:k.isEnabled()||null!=l?k.isEnabled()||37!=l?k.isEnabled()||null==l?"":"There was an error fetching the database schema.":"You don't have access to refresh or edit analysis with this connected data.":"You don't have permission to edit this sheet.";$Ap(k.Ua(),p);k==a.Ta&&a.C&&$Ap(a.C.D.Ua(),p)});a.J&&a.J.Ya(b&&f);a.F&&a.F.Ya(b&&f)}
function $Ap(a,b){ms(a,b,void 0);b&&V6j(a,"waffle-dbsource-configbar-db-object-creation-button-tooltip")}function RAp(a){return fz(a.Ra).jg()}function VAp(a){a=a.O.Hc();for(DAp(a,!1);1<a.yd();)a.Xw(1,!0)}
function aBp(a){if(nf(pf(),"fedciv")&&nf(pf(),"fedcivp")&&a.isVisible()&&a.F&&a.F.isEnabled()&&!bBp(a)){var b=As(a.D.F.C,"ritz-ap");if(!Hr(b).C.dbColumnStatsPromo){var c=a.F.Ua(),d=new QYb("Discover data insights","Now you can quickly learn about data distribution, frequency, and more for any column",c,a.Da());a.Ca(d);a.Fa=new GAp(d,c,!1,a.Da(),a.D.V,a.Ac,a.Ua(),function(){f0b(b,"dbColumnStatsPromo",!0)});a.Ca(a.Fa);a.Za.add(a.Fa);a.Fa.show();a.X.C(116197,WAp())}}}
function bBp(a){for(var b=ea(a.Za),c=b.next();!c.done;c=b.next())c=c.value,c.isDismissed()&&a.Za.delete(c);return 0<a.Za.size||a.C&&a.C.C.C.isVisible()?!0:!1}function TAp(a){return(a=Yk().xOa()(RAp(a)))?Mod.format(parseInt(a,10)):null}function ZAp(a){return a&&dj(a,1)&&!a.Pk()?a.ai():null}function XAp(a){var b=vGb(WAp());return aak($$j(new V$j(a.qc,b)),0<eak(dx(a.qc)).length).va().va()}function WAp(a){a=void 0===a?109:a;var b=Wk(new Vk,!0);return Ep(Cp(new Bp,a),b).va()}
function cBp(a,b,c,d,e,f,h,k,l,m,p){Im.call(this);this.D=a;this.F=b;this.oa=l;this.V=c;this.Fa=d;this.R=e;this.H=f;this.O=h;this.Aa=k;this.J=new Lm(this);this.Ca(this.J);this.ma=m;this.X=p;this.C=null;this.J.listen(this.D,["na","Fa"],this.ANb).listen(this.D,["oa","Ea"],this.j6c).listen(this.F,["acl_change","offline_status","readonly_status"],this.fNc);this.ANb()}z(cBp,Im);u=cBp.prototype;
u.ANb=function(){var a=fz(this.D);if(a&&ev(a)&&(this.C?(this.C.refresh(),this.C.Fb=!1):(this.C=new OAp(this.D,this.F,this.V,this.Fa,this.Aa,this.oa,this.ma,this.H,this.X,this.R),a=this.C.Da(),this.C.render(a.getElement("waffle-dbsource-configbar-id")),this.C.Tg(this),this.J.listen(this.C,"insert-formula-function",this.$6c).listen(this.C,"datasheet-rename",this.uSc).listen(this.C,"configbar-dom-focus-out",this.vRc)),this.C.setVisible(!0),N9j(),a=this.C,!bBp(a))){if(a.H&&a.H.isEnabled()&&nf(pf(),"fedda")&&
x8b.isEnabled()&&!a.oa&&!Cr().C){var b=a.D.F.D["ritz-SessionCountBigsheetsDelegateAccessPromo"];var c=b.getValue();b.setValue(Math.min(c+1,2147483647));3>c||6==c+1?(b=a.H.Ua(),c=new QYb("Delegate access","Allow collaborators of this spreadsheet to refresh and analyze this connected data using your credentials. Go to the connection settings to enable.",b,a.Da()),a.Ca(c),a.oa=new GAp(c,b,!1,a.Da(),a.D.V,a.Ac,a.Ua()),a.Ca(a.oa),a.Za.add(a.oa),a.oa.show(),a.X.C(116174,WAp()),b=!0):b=!1}else b=!1;!b&&
a.C&&null!==TAp(a)&&(b=a.D.F,3<=Wbd(b).getValue()||(b=b.D["ritz-ViewCountDatasourceSheetPreviewBar"],c=b.getValue(),1>c&&(b.setValue(c+1),a=a.C.C.C,a.setVisible(!0),a.Je())))}};u.uSc=function(a){var b=this;a=new cId(a.xm,a.name);$w(a,function(c){c||YAp(b.C,!0)});this.O.C(a)};u.vRc=function(){nyd(cx(this.H))};
u.$6c=function(a){var b=this,c=fz(this.D),d=c.jg();if(d){var e=c.Pg(),f=a.lOa;PGk(this.R,function(h,k){var l=Yk().vOa()(e,null);Xmb([Ax(b.F.X,d),Zn(1E3)]).then(function(){return dBp(b,f,l,k)})},"Insert Formula");this.V.C(36535,WAp())}};function dBp(a,b,c,d){if(d)a.F.C.rP(d.Hn,function(){var f=Bw(a.F.C),h=new Mm(d.C,d.wq);Sw(f,h);eBp(a,b,c,h)});else{var e=new CZj(FLc(a.F.C)+1);$w(e,function(f){f&&eBp(a,b,c,new Mm)});a.O.C(e)}}
function eBp(a,b,c,d){ALc(dx(a.H).C,jv(d)).addCallback(function(){l1j(cx(a.H),b,c)})}u.j6c=function(){this.C&&(this.C.setVisible(!1),this.C.Fb=!0)};u.fNc=function(){var a=fz(this.D);a&&ev(a)&&this.C&&this.C.refresh()};u.Wa=function(){Im.prototype.Wa.call(this);hi(this.C)};
function fBp(){var a='<div class="'+V("waffle-create-datasheet-welcome-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_welcome.png" class="'+V("waffle-create-datasheet-welcome-dialog-image")+'" alt=""><h3 class="'+V("waffle-create-datasheet-welcome-dialog-welcome-message")+'"><span>';a=a+'Connect and analyze big data in Sheets</span></h3><div class="'+(V("waffle-create-datasheet-welcome-dialog-welcome-description")+'">');a=a+"Connect to BigQuery, Google's cloud data warehouse, to analyze and share billions of rows of data with your colleagues - all within Sheets</div><div class=\""+
(V("waffle-create-datasheet-welcome-dialog-button-wrapper")+'"></div></div>');return zq(a)}function gBp(a){bZ.call(this,"waffle-create-datasheet-welcome-dialog",a);this.D=new Oz("Learn the basics",this.Da());this.Pa(this.D);this.C=new Xt("Get connected",this.Da());this.Pa(this.C)}z(gBp,bZ);u=gBp.prototype;
u.Ia=function(){bZ.prototype.Ia.call(this);vq(this.Ec(),fBp);this.D.render(this.Ja("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.D,"action",this.D9b);this.C.render(this.Ja("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.C,"action",this.iub);kKb(this.Ja("waffle-dataconnector-modal-title"));var a=this.Ja("waffle-create-datasheet-welcome-dialog-welcome-message");a.id=oq(this,"waffle-create-datasheet-welcome-dialog-welcome-message");
Tq(a,"heading");Wq(this.Ua(),"labelledby",a.id);a=this.Ja("waffle-create-datasheet-welcome-dialog-welcome-description");a.id=oq(this,"waffle-create-datasheet-welcome-dialog-welcome-description");Wq(this.Ua(),"describedby",a.id)};u.D9b=function(){rq("https://connectedsheets.page.link/support")};u.iub=function(){this.resolve(!0)};u.rcb=function(a){13==a.keyCode&&this.iub()};u.iAa=function(){y7b.Nb();this.reject()};u.uS=function(){y7b.Nb();this.reject()};
function hBp(a){a=a.Lbb;a='<div class="'+V("waffle-create-datasource-sheet-loading-dialog-section")+'"><img class="'+V("waffle-create-datasource-sheet-loading-dialog-image")+'" src="'+V(Oq(a))+'" alt=""><div class="'+V("waffle-create-datasource-sheet-loading-dialog-tip")+'">';return zq(a+"Connecting data\u2026</div></div>")}function iBp(a,b,c){aZ.call(this,"waffle-create-datasource-sheet-loading-dialog",c);this.D=a;this.C=b}z(iBp,aZ);
iBp.prototype.Ia=function(){aZ.prototype.Ia.call(this);vq(this.Ec(),hBp,{Lbb:this.D});kKb(this.Ja("waffle-dataconnector-modal-title"));var a=this.Ja("waffle-create-datasource-sheet-loading-dialog-tip");a.id=oq(this,"waffle-create-datasource-sheet-loading-dialog-tip");Tq(a,"heading");Wq(this.Ua(),"labelledby",a.id)};iBp.prototype.Qa=function(){aZ.prototype.Qa.call(this);this.C.C(36758,jBp())};iBp.prototype.Wa=function(){aZ.prototype.Wa.call(this);this.C.C(36759,jBp())};
function jBp(){var a=Wk(new Vk,!0);return Ep(Cp(new Bp,75),a).va()}
function kBp(){var a='<div class="'+V("waffle-create-datasource-sheet-success-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_success_2.gif" class="'+V("waffle-create-datasource-sheet-success-dialog-image")+'" alt=""><h5 class="'+V("waffle-create-datasource-sheet-success-dialog-success-message")+'">';a=a+'Success! Your data is connected</h5><div class="'+(V("waffle-create-datasource-sheet-success-dialog-metadata-wrapper")+" "+V("waffle-create-datasource-sheet-success-dialog-datasource-info")+
'"></div><div class="'+V("waffle-create-datasource-sheet-success-dialog-success-description")+'">');a=a+'Create connected charts, pivot tables, and functions that work on the entire dataset, or extract a subset of the raw data directly into Sheets.</div><div class="'+(V("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper")+'"></div><div class="'+V("waffle-create-datasource-sheet-success-dialog-watch-tutorial")+" "+V("goog-link-button")+'"><span>');return zq(a+"Watch video tutorial</span></div></div>")}
function lBp(a,b){a=(new ct("{NUM_COLUMNS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_COLUMNS:a});return b?b+" rows \u2022 "+a:a}function mBp(a,b,c){aZ.call(this,"waffle-create-datasource-sheet-success-dialog",c);this.F=a;this.H=b;this.C=new Xt("Get started",this.Da());this.Pa(this.C);this.D=new Zr(void 0,ex.qb(),this.Da());this.Pa(this.D)}z(mBp,aZ);
mBp.prototype.Ia=function(){var a=this;aZ.prototype.Ia.call(this);vq(this.Ec(),kBp);var b=this.Ja("waffle-create-datasource-sheet-success-dialog-metadata-wrapper");this.Da().Jh(b,lBp(this.F,this.H));this.C.render(this.Ja("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper"));this.D.ub(this.Ja("waffle-create-datasource-sheet-success-dialog-watch-tutorial"));kKb(this.Ja("waffle-dataconnector-modal-title"));b=this.Ja("waffle-create-datasource-sheet-success-dialog-success-message");
b.id=oq(this,"waffle-create-datasource-sheet-success-dialog-success-message");Tq(b,"heading");Wq(this.Ua(),"labelledby",b.id);b=this.Ja("waffle-create-datasource-sheet-success-dialog-success-description");b.id=oq(this,"waffle-create-datasource-sheet-success-dialog-success-description");Wq(this.Ua(),"describedby",b.id);this.getHandler().listen(this.C,"action",function(){return a.uS()}).listen(this.D,"action",function(){return L8b.Nb()})};
function nBp(a,b,c,d,e,f,h,k,l,m,p,r,t,v,x){uXk.call(this,new BXk(m.getType(),l,"filter_db_sheet",x),a,b,c,d,e,f,h,k,l,v,x);this.H=fx(m);this.Qf=m;this.ad=p;this.Ie=r;this.Re=t;this.Od=!dj(this.H,2)&&yKk(m)}z(nBp,uXk);u=nBp.prototype;u.Ia=function(){uXk.prototype.Ia.call(this);var a=Rkd(this.C,this.Bm());Xyp(this.F.C,500<a.left?0:3)};
u.DNb=function(){var a=this.mb().Uc(),b=Yk().wOa()(a,this.H.Mb()),c=null,d=null;0<b.length&&(c=aj(Cv,b[0]),d=XWk(a));$Wk(this.F,c,d,this.Ie,this.Re,this.ad,this.H);a=this.Ka;b=this.Va;c=this.mb().Uc();c=Yk().r$a()(c,this.H.Mb());fr(a.Ua(),"waffle-datasourcesheet-sort-selected",0==c);fr(b.Ua(),"waffle-datasourcesheet-sort-selected",1==c);a.Ya(null!=c||!this.Od);b.Ya(null!=c||!this.Od);a=this.D;b=a.Hc().Ua();br(b,"waffle-datasourcesheet-filterbox-container");dBk(a);cq(b,"");a.au()};
u.nLb=function(a){if("filtering_cancelled"==a.type)this.Ta();else if("filtering_open_filter_by_value_sidebar"==a.type){a=this.mb().Uc();a=Yk().wOa()(a,this.H.Mb());var b=null;0<a.length&&(b=aj(Cv,a[0]));a=b?cAc(VYj($zc(),this.H),b).va():null;a=new CXk(this.ad,4,this.H,this.Qf.getType(),a,null,null,null,null);v9b.Nb(a);this.Ga.C(116098,this.qc);this.Ta()}else if(a=this.Bm(),a=this.F.Zx(this.mb().Uc(),a.y,a.x,!1,!1),!pWk(this.F.C)){b=this.mb().Uc();var c=Yk().wOa()(b,this.H.Mb());b=null;0<c.length&&
(b=aj(Cv,c[0]));c=b&&0<ej(b,9);if(null!=a||c){var d=new pXk("filterUpdate");d.C=a;c&&(d.H=b.iI(),d.Va=mj(b,9,Awa).Lc())}else d=new pXk("filterClear");d.V=this.H;this.dispatchEvent(d);this.Ta()}};u.Mcb=function(a){var b=new pXk("filterSort");b.V=this.H;b.Aa=a?1:0;this.dispatchEvent(b)};u.Vdb=q(!1);u.N6a=function(a){var b=this.C,c=xy(b,"r",a.y),d=b.C,e=2*d.C,f=this.mb().xk(a.y,a.x).Gt();c=-c-e;a="rtl"==(f.D||null)||"auto-rtl"==(f.D||null)?e:xy(b,"c",a.x)-16*d.C-e;d=d.C;this.WO(new Mm(a/d,c/d))};
function oBp(a){qj.call(this,a)}z(oBp,qj);oBp.prototype.Cb=function(){return this.message.Cb()};oBp.prototype.D=function(a){return this.message.D(a)};function pBp(a){this.Ib=Zi(a,-1,0)}z(pBp,$i);pBp.prototype.yb=function(){return new oBp(this)};pBp.prototype.Cb=function(){return hj(this,1)};pBp.prototype.D=function(a){return nj(this,3,a,Cv)};
function qBp(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?!1:e;f=void 0===f?!1:f;Zw.call(this,147);this.O=a.Uc();this.J=b;this.D=c||[];this.C=d;this.R=e;this.V=f}z(qBp,Zw);qBp.prototype.Ig=function(){var a=void 0===a?cj(pBp):a;a=new oBp(a);a=tj(a,1,this.O);a=yj(a,7,this.J);this.R?sj(a,5,!0):xj(a,3,this.D);this.V?sj(a,6,!0):null!=this.C&&vj(a,4,this.C);return a.va()};
qBp.prototype.equals=function(a){return this.O==a.O&&this.J.equals(a.J)&&this.R==a.R&&this.V==a.V&&this.C==a.C&&fg(this.D,a.D,function(b,c){return b.equals(c)})};function rBp(a,b,c,d,e,f,h){ji.call(this);this.J=a;this.R=h;this.ma=b;this.D=c;this.X=d;this.V=e;this.O=f;this.F=new Lm(this);this.Ca(this.F);this.C=null;this.H=new ts(this);this.Ca(this.H);this.F.listen(this.D,"filter-triggered",this.kub);this.H.subscribe(w9b,"action",this.kub);this.H.subscribe(u9b,"action",this.G9b)}z(rBp,ji);u=rBp.prototype;
u.kub=function(){var a=fz(this.ma);if(a&&ev(a)){var b=cx(this.D),c=sBp(this),d=Qw(c),e=Ow(sBp(this));d=new Mm(d.x,e.y);e=q0j(c,d.x);this.C&&(this.C.dispose(),this.C=null);this.C=new nBp(c,this.V,b.V,b.C,b.F,new hy(d),!1,!1,this.X,e,a.jg(),this.J.H,this.J.Ra,this.R);this.Ca(this.C);Emd(mGd(b),this.C);this.F.listen(this.C,"filterClear",this.F9b).listen(this.C,"filterSort",this.H9b).listen(this.C,"filterUpdate",this.P5c);this.C.N6a(d);this.C.ue();this.C.D.Qe(!0);b=fx(e);a=Yk().r$a()(a.Cb(),b.Mb());b=
Wm("waffle-autofilter-sort waffle-datasourcesheet-sort-selected");null!=a&&b&&(Zq(b,b.innerText+" selected"),fr(b,"hc-enabled-focus","black"==os()))}};u.F9b=function(a){a=new qBp(sBp(this),a.V,null,null,!0);tBp(this,a)};u.P5c=function(a){var b=Vzc();a.C&&Yzc(b,a.C);a.Va&&0<a.Va.length&&Xzc(xj(b,9,a.Va),a.H);a=new qBp(sBp(this),a.V,[b.va()],null);tBp(this,a)};
u.G9b=function(a){if(4==a.C){var b=Vzc(),c=a.ZIa;xj(b,9,c);Xzc(b,a.iI());c=0<c.length;var d=!1;if(a.d0){var e=a.d0.D();e.jI()&&(d=!0,Yzc(b,e.Zx()))}b=c||d?[b.va()]:null;a=new qBp(sBp(this),a.D,b,null,!b);tBp(this,a)}};u.H9b=function(a){var b=sBp(this).Uc(),c=a.V;b=Yk().r$a()(b,c.Mb());var d=!1;switch(a.Aa){case 1:d=0==b;break;case 0:d=1==b}a=d?new qBp(sBp(this),c,null,null,void 0,!0):new qBp(sBp(this),c,null,1==a.Aa?0:1);tBp(this,a)};function tBp(a,b){a.O.C(b);FGk(mGd(cx(a.D)));hi(a.C);a.C=null}
function sBp(a){return Bw(a.J.C)}function uBp(a,b,c,d,e,f,h){ji.call(this);var k=this;this.O=new Lm(this);this.Ca(this.O);this.J=a.O;this.F=b;this.C=c;this.ma=e;this.R=f;this.X=new ts(this);this.Ca(this.X);this.oa=h;this.H=this.D=null;vBp(this);wBp(this,d);this.V=new Jm;this.Ca(this.V);this.V.Bc(this.J.H,function(l){var m=xBp(k);m&&(l.D||l.C.has(m))&&yBp(k,m)});this.CEa()}z(uBp,ji);function vBp(a){var b=new Gp(["waffle-dbsheet-or-dbobject-pill-active"]);a.R.C(z8b,b)}
function wBp(a,b){var c=Iv(a.F.Ta);a.O.listen(b,"P",a.j8c).listen(c,"gc",a.K9b).listen(c,["Qb","cc"],a.CEa).listen(a.F,"na",a.CEa).listen(a.C,"activeCellChange valueChange blurEmbeddedObject embeddedObjectMouseEnter embeddedObjectMouseLeave focusEmbeddedObject".split(" "),a.CEa).listen(a.C,"inputBoxActivate",a.LRa).listen(a.C,"mouseover",a.J9b).listen(a.C,"refresh-db-object-request",a.VMb).listen(a.F,"oa",a.T8a).listen(a.C,"db-connection-settings",a.uLb);a.X.subscribe(z8b,"action",a.I9b)}u=uBp.prototype;
u.Wa=function(){this.T8a();ji.prototype.Wa.call(this)};u.K9b=function(){var a=cx(this.C);a&&ATc(this.C)&&DFd(a)};u.T8a=function(){ii(zBp(this),ABp(this),this.D);this.H=this.D=null};u.j8c=function(){this.D&&Uyp(this.D)};
u.CEa=function(){var a=cx(this.C),b=fz(this.F);if(a&&b){b=!!a.$a;var c=!!hGd(a);b||!c||a.$a||(a.$a=new Vyp(a.mb(),a.V,a.C,a.F,new hy(cGd(a),new Mm(0,0)),a.Aa,a.ib,a.qc,a.Zb),Oyd(a.X,"dbCellPill",a.$a),a.Ca(a.$a),a.$a.setVisible(!0));b=a.mb();a=hGd(a)||Qw(b);(a=jNc(Ew(b,a),a,b.Uc()))&&(a.C||a.D)?this.LRa():(a=xBp(this),(a!=this.H||BBp(this,a))&&yBp(this,a))}else this.T8a()};
function BBp(a,b){if(!b||2!=Yk().ZX()(b))return!1;var c=cx(a.C);if(!c)return!1;b=NGk(c);c=LGk(c);if(b==c)return!1;a=zBp(a);return b&&null==c&&a&&a.isVisible()&&null!=a.C.Hc()&&a.C.Hc().isVisible()?!1:!0}function yBp(a,b){if(b){a.LRa();var c=CBp(a);if(c){var d=wFk(a.J,b);var e=fz(a.F).Cb();var f=Yk().ZX()(b),h=Yk().Z7()(b),k=null;h&&(k=(h=Yk().xOa()(h))?parseInt(h,10):null);e=new Dzp(b,f,k,e);Tod(c,d,e);4==e.C&&Uyp(c);DBp(a,b,c,d);a.H=b}}else a.LRa()}
u.LRa=function(){var a=zBp(this);a&&a.setVisible(!1);(a=ABp(this))&&a.setVisible(!1);this.H=null};u.I9b=function(){var a=CBp(this);a&&(a.Ua().focus(),this.ma.Mc(2))};u.VMb=function(){var a=xBp(this);if(a)switch(Yk().ZX()(a)){case 1:A7b.Nb(a);break;case 5:C7b.Nb(a);break;case 3:H7b.Nb(a);break;case 2:B7b.Nb(a);break;case 4:D8b.Nb(a)}};u.uLb=function(){var a=xBp(this);if(a){var b=Yk().Z7()(a);b&&(a=Yk().Sda()(b))&&oHd(this.F,a,function(){F8b.Nb(new gVk(b,"show-current-source"))})}};
u.J9b=function(a){var b=fz(this.F),c=cx(this.C);c&&b&&3!=b.mj()&&(a=a.Ro)&&$cd(a)&&(this.CEa(),DFd(c))};
function CBp(a){var b=xBp(a);if(!b)return null;var c=Yk().ZX()(b);if(4==c)if(3!=fz(a.F).mj())a=null;else{if(!a.D){c=cx(a.C);b=c.Ji();a.D=new Ood(a.oa,b,a.R.Rf());a.O.listen(a.D,"refresh-db-object-request",a.VMb).listen(a.D,"db-connection-settings",a.uLb);c=new Sq(c.Ga.J,b?5:1);a.D.render();var d=a.D;d.ma=c;d.X=b}a=a.D}else if(2==c)if(a=cx(a.C))a:if(c=a.J.C,MGk(a)==b)b=GGk(a.J).Jg().getId(),a=vGd(a,b);else{for(d=c.length-1;0<=d;d--){var e=c[d];if(e&&Yk().Dma()(e)==b){a=vGd(a,e);break a}}a=null}else a=
null;else a=ABp(a);return a}function zBp(a){return(a=cx(a.C))?uGd(a):null}function ABp(a){a=cx(a.C);return a?(a=a.$a)?a.F:null:null}function xBp(a){return(a=cx(a.C))?Wyp(a):null}function DBp(a,b,c,d){(lu.isEnabled()||Uod(c))&&EBp(d.getType())&&(c.O$(),BFk(a.J,b,function(e){return c.Dv(e)},function(e){return c.eP(e)}))}function EBp(a){return"no-results"==a||"fetch-successful"==a||"fetch-failed"==a}function FBp(a){qj.call(this,a)}z(FBp,qj);FBp.prototype.jg=function(){return this.message.jg()};
function GBp(a){this.Ib=Zi(a,-1,0)}z(GBp,$i);GBp.prototype.yb=function(){return new FBp(this)};GBp.prototype.jg=function(){return hj(this,1)};function HBp(a,b){Zw.call(this,154);this.C=a;this.D=b}z(HBp,Zw);HBp.prototype.Ig=function(){var a=void 0===a?cj(GBp):a;a=new FBp(a);a=tj(a,1,this.C);return cwa(a,2,this.D).va()};function IBp(a,b){Tz.call(this,"",a,b);this.Wc(!0)}z(IBp,Tz);IBp.prototype.Fl=function(){return JBp(this)};
IBp.prototype.getContent=function(){var a=this.Da().Ia("SPAN",{"class":"waffle-filter-by-value-additional-values-item"});ln(a,JBp(this));return[a]};function JBp(a){return Mod.format(a.mb())+" additional values in the full data set"}function KBp(a,b){this.C=a;this.D=b}KBp.prototype.uh=n("C");KBp.prototype.So=n("D");function LBp(a,b){oKk.call(this,"",a,b);this.dw(!0);this.Wc(!0)}z(LBp,oKk);LBp.prototype.Fl=function(){return MBp(this)};
LBp.prototype.getContent=function(){var a=this.mb(),b=[],c=this.Da().Ia("DIV",{"class":"goog-menuitem-checkbox"});b.push(c);c=this.Da().Ia("SPAN",{"class":"waffle-filter-by-value-item-freq"});if(a=a.So())a=1E3>a?Mod.format(a):Nod.format(a),ln(c,a);b.push(c);c=this.Da().Ia("SPAN",{"class":"waffle-filterable-by-text-contains-menu-item-label"});ln(c,MBp(this));b.push(c);return b};function MBp(a){return Yk().jU()(a.mb().uh().Mb())}
function NBp(a){a=a||{};var b='<div class="'+V("waffle-filter-by-value-sidebar-header-wrapper")+'"><div class="'+V("waffle-filter-by-value-sidebar-column-info")+'" id="'+V("waffle-filter-by-value-sidebar-column-info")+'"></div><div class="'+V("waffle-filter-by-value-search-container")+'">'+Gt("docs-icon-img docs-icon-search-this-document")+sMk(void 0,"waffle-filter-by-value-search-input",void 0,void 0,void 0,void 0,void 0,void 0,void 0,Lq('tabindex="0" role="textbox"'))+'</div><div class="'+V("waffle-filter-by-value-menu-title")+
'"><div class="'+V("waffle-filter-by-value-menu-title-primary")+'" id="'+V("waffle-filter-by-value-menu-title-primary")+'">';b=b+'Most frequent values</div><div class="'+(V("waffle-filter-by-value-menu-title-secondary")+'" id="'+V("waffle-filter-by-value-menu-title-secondary")+'"></div></div><div class="'+V("waffle-filter-by-value-menu-top-buttons")+'"><div class="'+V("waffle-filter-by-value-menu-sort-buttons")+'"><div class="'+V("waffle-filter-by-value-sort-by-frequency-desc-button")+" "+V("goog-inline-block")+
'"></div><div class="'+V("waffle-filter-by-value-sort-by-frequency-asc-button")+" "+V("goog-inline-block")+'"></div><div class="'+V("waffle-filter-by-value-sort-by-value-asc-button")+" "+V("goog-inline-block")+'"></div><div class="'+V("waffle-filter-by-value-sort-by-value-desc-button")+" "+V("goog-inline-block")+'"></div></div><div class="'+V("waffle-filter-by-value-menu-checked-buttons")+'"><div class="'+V("waffle-filter-by-value-select-all-button")+" "+V("goog-inline-block")+'"></div><div class="'+
V("waffle-filter-by-value-clear-button")+" "+V("goog-inline-block")+'"></div></div></div></div>');var c='<div class="'+V("waffle-filter-by-value-sidebar-content-container")+'"><div class="'+V("waffle-filter-by-value-sidebar-content-loading")+'"></div><div class="'+V("waffle-filter-by-value-sidebar-content-unavailable")+'">';var d='<div class="'+V("waffle-filter-by-value-content-unavailable-alert-icon")+'">'+GXk()+'</div><div class="'+V("waffle-filter-by-value-content-unavailable-alert-message")+'">';
d=d+'Values unavailable</div><div class="'+(V("waffle-filter-by-value-content-unavailable-refresh-message")+'">');d=d+'Values could not be retrieved at this time. Try again by refreshing.</div><div class="'+(V("waffle-filter-by-value-content-unavailable-refresh-button-wrapper")+'"></div>');d=zq(d);c=c+d+'</div><div class="'+V("waffle-filter-by-value-sidebar-content-loaded")+'"><div class="'+V("waffle-filter-by-value-menu")+'" aria-labelledby="waffle-filter-by-value-sidebar-column-info waffle-filter-by-value-menu-title-primary waffle-filter-by-value-menu-title-secondary" tabindex="0" role="menu"></div><h2 class="'+
V("waffle-filter-by-value-additional-values-menu-title")+'"><span tabindex="0">';c=c+'Values beyond top 500</span></h2><div class="'+(V("waffle-filter-by-value-additional-values-menu")+'"></div></div></div>');a=""+ZY(Hq({pD:"waffle-filter-by-value-sidebar",title:"Filter by value",cP:Kq(""+Gt("docs-icon-img docs-icon-filter-control")),c3:Kq(b),gA:Kq(c),WX:Kq('<div class="'+V("waffle-filter-by-value-sidebar-footer-wrapper")+'"><div class="'+V("waffle-filter-by-value-empty-values-wrapper")+'"><div class="'+
V("waffle-filter-by-value-empty-values-menu")+'"></div></div><div class="'+V("waffle-filter-by-value-last-updated-time")+'" tabindex="0"></div><div class="'+V("waffle-filter-by-value-sidebar-footer-button-bar")+'"><div class="'+V("waffle-filter-by-value-cancel-button-wrapper")+'"></div><div class="'+V("waffle-filter-by-value-ok-button-wrapper")+'"></div></div></div>')},a));return zq(a)}
function OBp(){return zq('<div class="'+V("waffle-filter-by-value-sidebar-header")+'"><div class="'+V("waffle-filter-by-value-sidebar-header-icon")+'"></div><div class="'+V("waffle-filter-by-value-sidebar-header-column-name")+'"></div></div>')}function PBp(a){mq.call(this,a)}z(PBp,mq);PBp.prototype.Ia=function(){this.Ob(xq(OBp))};function QBp(a,b){Tz.call(this,"",a,b);this.Wc(!0)}z(QBp,Tz);QBp.prototype.Fl=function(){return RBp(this)};
QBp.prototype.getContent=function(){var a=this.Da().Ia("SPAN",{"class":"waffle-filter-by-value-empty-values-item"});ln(a,RBp(this));return[a]};function RBp(a){return Mod.format(a.mb())+" empty values in the full data set"}
function SBp(a,b){TY.call(this,b);this.C=a;this.Ra=new PBp;this.Ca(this.Ra);this.zb=new kt("Search from list of most frequent values");this.sb=null;this.Ca(this.sb);this.Ge=new es;this.Pa(this.Ge);this.D=new es;this.Pa(this.D);this.F=new es;this.Pa(this.F);this.O=new By(xq(Ft,{icon:"docs-icon-img docs-icon-trending-up-18"}),this.Da());this.Pa(this.O);this.R=new By(xq(Ft,{icon:"docs-icon-img docs-icon-trending-down-18"}),this.Da());this.Pa(this.R);this.V=new By(xq(Ft,{icon:"docs-icon-img docs-icon-sort_az"}),
this.Da());this.Pa(this.V);this.X=new By(xq(Ft,{icon:"docs-icon-img docs-icon-sort_za"}),this.Da());this.Pa(this.X);this.Va=new Zr("Select all",ex.qb(),this.Da());this.Pa(this.Va);this.Fa=new Zr("Clear all",ex.qb(),this.Da());this.Pa(this.Fa);this.ma=new Xt("OK",this.Da());this.ma.ld("waffle-filter-by-value-ok-button");this.Pa(this.ma);this.Aa=new Oz("Cancel",this.Da());this.Aa.ld("waffle-filter-by-value-cancel-button");this.Pa(this.Aa);this.Za=this.ib=this.hb=this.Ka=this.Ga=this.J=this.Fb=null;
this.Pb=new rod;this.rb=new EXk;this.Pa(this.rb);this.Jb=!1;this.oa=new Xt("Refresh",this.Da());this.Pa(this.oa)}z(SBp,TY);u=SBp.prototype;u.Ia=function(){this.Ob(xq(NBp,{id:this.getId()}))};
u.Qa=function(){TY.prototype.Qa.call(this);this.Ra.render(Wm("waffle-filter-by-value-sidebar-column-info"));var a=this.Da().Ja("waffle-filter-by-value-search-input");this.zb.ub(a);this.sb=new zt(a);this.Ge.render(this.Bb("waffle-filter-by-value-menu"));br(this.Ge.Ua(),"docs-material");this.D.render(this.Bb("waffle-filter-by-value-additional-values-menu"));br(this.D.Ua(),"docs-material");this.F.render(this.Bb("waffle-filter-by-value-empty-values-menu"));br(this.F.Ua(),"docs-material");this.O.render(this.Bb("waffle-filter-by-value-sort-by-frequency-desc-button"));
this.R.render(this.Bb("waffle-filter-by-value-sort-by-frequency-asc-button"));this.V.render(this.Bb("waffle-filter-by-value-sort-by-value-asc-button"));this.X.render(this.Bb("waffle-filter-by-value-sort-by-value-desc-button"));ms(this.O.Ua(),"Sort by most frequent values",void 0);ms(this.R.Ua(),"Sort by least frequent values",void 0);ms(this.V.Ua(),"Sort by ascending values",void 0);ms(this.X.Ua(),"Sort by descending values",void 0);this.Va.render(this.Bb("waffle-filter-by-value-select-all-button"));
this.Fa.render(this.Bb("waffle-filter-by-value-clear-button"));ms(this.Va.Ua(),"Select all items below",void 0);ms(this.Fa.Ua(),"Unselect all items below",void 0);this.ma.render(this.Ja("waffle-filter-by-value-ok-button-wrapper"));this.Aa.render(this.Ja("waffle-filter-by-value-cancel-button-wrapper"));this.rb.render(this.Ja("waffle-filter-by-value-sidebar-content-loading"));this.oa.render(this.Bb("waffle-filter-by-value-content-unavailable-refresh-button-wrapper"));a=this.Ja("waffle-sidebar-title-close");
ps(a,"waffle-filter-by-value");this.getHandler().listen(this.ma,"action",this.O9b).listen(this.Aa,"action",this.L9b).listen(this.Va,"action",this.Q9b).listen(this.Fa,"action",this.M9b).listen(this.V,"action",this.G7c).listen(this.X,"action",this.H7c).listen(this.O,"action",this.F7c).listen(this.R,"action",this.E7c).listen(this.oa,"action",this.P9b).listen(this.sb,"input",this.N9b)};u.N9b=function(){var a=this.zb.getValue();TBp(this,a);a&&!this.Jb&&(this.C.C(116107),this.Jb=!0)};
function TBp(a,b){a.Ge.Bh(function(c){c.Jwa(b)})}u.refresh=function(a){var b=a.D,c=a.jg(),d=Dw(b,c);this.Fb=c;c=this.Ra;var e=c.Ja("waffle-filter-by-value-sidebar-header-column-name");c.Da().Jh(e,d);Zq(e,d);this.Ga=c=a.ah();d=this.Ra.Ja("waffle-filter-by-value-sidebar-header-icon");$q(d,"waffle-filter-by-value-sidebar-header-icon");(c=wKk(c))&&br(d,c);this.Ka=a.C;this.hb=b;this.J=a.d0;this.ib=a.F;this.Za=a.jub;this.focus()};
function UBp(a,b){VBp(a,"loading");b.addCallback(function(c){if(c){a.Ge.Te(!0);a.D.Te(!0);a.F.Te(!0);var d=mj(c,18,CAk).Lc(),e=kj(c,10),f=a.Ja("waffle-filter-by-value-menu-title-secondary"),h=500<e?"showing up to 500":"showing "+(e+" total");ln(f,"("+h+")");Zq(f,h);c=kj(c,11);e=(f=500<e)?e-500:null;for(h=0;h<d.length;h++){var k=d[h],l=k.uh(),m=l.getValue();0==m.MB()||2==m.MB()&&""==m.getStringValue()||(k=new LBp(new KBp(l,k.Eg()),a.Da()),a.Ge.Pa(k,!0),k.ld("apps-menuitem"),mn(k.getElement(),!0),WBp(a,
k),k=k.Ja("waffle-filter-by-value-item-freq"),ms(k,"Number of instances of this value in the column",void 0))}d=null;a.J&&dj(a.J,2)&&0<ej(a.J.D(),9)&&(d=a.J.D());null!=d?XBp(a,d,f,e,c):YBp(a,f,!0,e,!0,c);ZBp(a,a.Y9a,!0);$Bp(a.O);VBp(a,"loaded");a.focus()}})}
function XBp(a,b,c,d,e){var f=b.iI(),h=mj(b,9,Awa).Lc(),k=[];a.Ge.Bh(function(t){var v=t.mb().uh().getValue();k.push(v);v=aCp(h,v);f&&(v=!v);t.Wc(v)});for(var l=b=!1,m=0;m<h.length;m++){var p=h[m],r=0==p.MB();r&&(b=!0);r||aCp(k,p)||(c=!0,l=Yk().lDc()(a.Ga),l=aj(jYj,l),p=AAk(Mwa().setValue(p),l).va(),p=new LBp(new KBp(p,null),a.Da()),p.Wc(!f),a.D.Pa(p,!0),p.ld("apps-menuitem"),WBp(a,p),mn(p.getElement(),!0),l=!0)}YBp(a,c,f,d,f&&!b||!f&&b,e);l&&a.C.C(116087)}
function aCp(a,b){for(var c=0;c<a.length;c++)if(b.equals(a[c]))return!0;return!1}function YBp(a,b,c,d,e,f){d&&(d=new IBp(d,a.Da()),d.Wc(c),a.D.Pa(d,!0),d.ld("apps-menuitem"),WBp(a,d),mn(d.getElement(),!0));a.D.setVisible(b);b&&a.C.C(116088);(c=a.Bb("waffle-filter-by-value-additional-values-menu-title"))&&gq(c,b);if(b=0<f)f=new QBp(f,a.Da()),f.Wc(e),a.F.Pa(f,!0),f.ld("apps-menuitem"),WBp(a,f),mn(f.getElement(),!0);a=a.Ja("waffle-filter-by-value-empty-values-wrapper");gq(a,b)}
function VBp(a,b){a.zb.reset();var c=a.Ja("waffle-filter-by-value-sidebar-header-wrapper");gq(c,"loaded"==b);c=a.Ja("waffle-filter-by-value-sidebar-content-loaded");gq(c,"loaded"==b);c=a.Ja("waffle-filter-by-value-sidebar-footer-wrapper");gq(c,"loaded"==b);c=a.Ja("waffle-filter-by-value-sidebar-content-unavailable");gq(c,"unavailable"==b);FXk(a.rb,"loading"==b)}function bCp(a){VBp(a,"unavailable");ms(a.oa.Ua(),"Estimating\u2026",void 0)}u.Dv=function(a){a=a?p$j(a):"";ms(this.oa.Ua(),a,void 0)};
u.CZb=function(a){var b=this.Ja("waffle-filter-by-value-last-updated-time");a="Updated: "+this.Pb.format(a);ln(b,a);ms(b,"Last time the values were retrieved",void 0);Zq(b,a+" Last time the values were retrieved");T6j(b,2,2);U6j(b,18)};
u.O9b=function(){var a=cCp(this),b=[];this.Ge.Bh(function(e){a^e.Le()&&b.push(e.mb().uh().getValue())});this.D.Bh(function(e){a^e.Le()&&(e instanceof IBp||b.push(e.mb().uh().getValue()))});if(1==this.F.yd()){var c=this.F.Ld(0),d=Cwa(0).va();a^c.Le()&&(b.push(d),this.C.C(116094))}u9b.Nb(new CXk(null,this.Ka,this.hb,this.Ga,this.J,this.ib,this.Za,a,b));dCp(this)};
function cCp(a){var b=!0,c=!0;if(a.D.isVisible()&&0<a.D.yd()){var d=a.D.Ld(a.D.yd()-1);d instanceof IBp&&(c=!1,b=d.Le(),a.C.C(b?116108:116109))}c&&eCp(a.Ge)<a.Ge.yd()/2&&(b=!1);return b}function WBp(a,b){a.getHandler().listen(b,"action",a.Mkb).listen(b.Ua(),"keydown",function(c){32!=c.keyCode&&13!=c.keyCode||b.Wc(!b.Le())})}u.Mkb=function(){var a=0<eCp(this.Ge)+eCp(this.D)+eCp(this.F);this.ma.Ya(a)};function eCp(a){var b=0;a.Bh(function(c){c.Le()&&b++});return b}
function dCp(a){var b=null;switch(a.Ka){case 2:b=116090;break;case 1:b=116093;break;case 4:b=116091;break;case 5:b=116092}a.C.C(b)}u.L9b=function(){this.C.C(116089);this.dispatchEvent("close-sidebar")};u.Q9b=function(){this.C.C(116102);fCp(this,!0);this.Mkb()};u.M9b=function(){this.C.C(116101);fCp(this,!1);this.Mkb()};u.P9b=function(){v9b.Nb(new CXk(this.Fb,this.Ka,this.hb,this.Ga,this.J,this.ib,this.Za,null,null));this.C.C(116147)};
function fCp(a,b){a.Ge.Bh(function(c){c.isVisible()&&c.Wc(b)});a.D.Bh(function(c){c.isVisible()&&c.Wc(b)});a.F.Bh(function(c){c.isVisible()&&c.Wc(b)})}u.G7c=function(){this.C.C(116105);ZBp(this,this.e2b,!1);$Bp(this.V)};u.H7c=function(){this.C.C(116106);ZBp(this,this.e2b,!0);$Bp(this.X)};u.F7c=function(){this.C.C(116104);ZBp(this,this.Y9a,!0);$Bp(this.O)};u.E7c=function(){this.C.C(116103);ZBp(this,this.Y9a,!1);$Bp(this.R)};
u.e2b=function(a,b){var c=a.mb().uh().getValue(),d=b.mb().uh().getValue();c.MB();d.MB();return 3==c.MB()?c.fE()-d.fE():kg(MBp(a),MBp(b))};u.Y9a=function(a,b){return a.mb().So()-b.mb().So()};
function ZBp(a,b,c){dr(a.O.Ua(),"waffle-filter-by-value-active-sort-button");dr(a.R.Ua(),"waffle-filter-by-value-active-sort-button");dr(a.V.Ua(),"waffle-filter-by-value-active-sort-button");dr(a.X.Ua(),"waffle-filter-by-value-active-sort-button");var d=gCp(a);a.Ge.Te();eg(d,b);if(c)for(b=d.length-1;0<=b;b--)a.Ge.Pa(d[b],!1);else for(b=0;b<d.length;b++)a.Ge.Pa(d[b],!1)}function $Bp(a){br(a.Ua(),"waffle-filter-by-value-active-sort-button")}
function gCp(a){var b=[];a.Ge.Bh(function(c){b.push(c)});return b}function hCp(a,b,c,d){zY.call(this,a,d);var e=this;this.C=b;this.F=c;fp(this.J,v9b,function(f){return iCp(e,f.data)});fp(this.J,u9b,function(){return e.kE()});this.D.listen(this.C.C,"na",this.S9b).listen(this.F,"selectionChange",this.R9b)}z(hCp,zY);u=hCp.prototype;u.Ej=function(){return s9b};u.qv=function(){return t9b};u.S9b=function(){this.kE()};u.R9b=function(){this.kE()};u.kE=function(){this.wd.Ya(!1);zY.prototype.kE.call(this)};
function iCp(a,b){a.wd.refresh(b);a.gz(!0);var c=Cl();UBp(a.wd,c);var d=b.jg(),e=b.D;zFk(a.C.Ra,d,e).then(function(f){c.callback(f.C);a.wd.CZb(f.D)},function(){c.callback(null);a.wd&&(bCp(a.wd),R_j(a.C.Ra,d,e).then(function(f){a.wd&&a.wd.Dv(f)},function(){a.wd&&a.wd.Dv(null)}))})}function jCp(a,b){this.D=a;this.C=b}function kCp(a){this.D=a;this.C={}}
function lCp(a,b){if(b){var c=nf(pf(),"feds")?Yk().s$a()(b):[],d=new Set(c),e=(new Date).getTime();b.forEach(function(f){if(a.C[f]){var h=h3c(f),k=h?h.getState():null;if(h&&k&&(2==k||3==k)){h=e-a.C[f].D;if(k=d.has(f)?Axe[k]:yxe[k]){h=Sk(new Qk,1E3*h);var l=a.C[f].C;var m=new IOa;l=T(m,2,l);if(m=Yk().gDc()(f))T(l,5,m.columns),T(l,4,m.rows);l=Wk(MAk(l),!0);h=Ep(mGb(Cp(new Bp,41),h),l);a.D.C(k,h.va())}delete a.C[f]}}})}}function mCp(a){qj.call(this,a)}z(mCp,qj);mCp.prototype.jg=function(){return this.message.jg()};
function nCp(a){this.Ib=Zi(a,-1,0)}z(nCp,$i);nCp.prototype.yb=function(){return new mCp(this)};nCp.prototype.jg=function(){return hj(this,1)};function oCp(a){qj.call(this,a)}z(oCp,qj);oCp.prototype.jg=function(){return this.message.jg()};function pCp(a){this.Ib=Zi(a,-1,0)}z(pCp,$i);pCp.prototype.yb=function(){return new oCp(this)};pCp.prototype.jg=function(){return hj(this,1)};function qCp(a,b){Zw.call(this,139);this.C=a||"";this.D=b}z(qCp,Zw);
qCp.prototype.Ig=function(){var a=void 0===a?cj(nCp):a;a=new mCp(a);a=tj(a,1,this.C);return yj(a,2,this.D).va()};qCp.prototype.kN=function(){return Zva(cj(pCp))};
function rCp(){var a='<div class="'+V("waffle-targeted-cs-promo-content")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/connectedSheetsPromoOnboardingImage.jpg" class="'+V("waffle-targeted-cs-promo-image")+'"><div class="'+V("waffle-targeted-cs-promo-text")+'"><div class="'+V("waffle-targeted-cs-promo-title")+'" id="'+V("waffle-targeted-cs-promo-title")+'">';a=a+'Analyze billions of rows of BigQuery data in Sheets</div><div class="'+(V("waffle-targeted-cs-promo-body")+'"><span id="'+V("waffle-targeted-cs-promo-body-text")+
'">');a=a+'Create charts, pivot tables and functions over the entire dataset, or extract a subset of the dataset directly into Google Sheets.</span> <span class="'+(V("waffle-targeted-cs-promo-link-button")+" "+V("goog-link-button")+'"><a href="https://cloud.google.com/blog/products/g-suite/connected-sheets-is-generally-available" target="_blank">');return zq(a+"Learn more</a></span></div></div></div>")}
function sCp(){return zq(TWb({gk:"docs-material waffle-targeted-cs-promo-close",hidden:!1,enabled:!0}))}function tCp(a,b){IXk.call(this,a,{N8a:!1,O8a:!1,idb:!1,Dy:!1},b);this.F.setContent("Try it now");this.setPosition(2,1);this.ld("waffle-targeted-cs-promo-base");Xr(this,!1);this.J=new Zr(void 0,Et.qb(),b);this.Pa(this.J)}z(tCp,IXk);u=tCp.prototype;
u.Ia=function(){IXk.prototype.Ia.call(this);var a=this.Ua(),b=xq(sCp),c=Yq(b);ms(b,c,void 0);dn(a,b);this.J.ub(b);b=xq(rCp);this.setContent(b);Tq(a,"alertdialog");Wq(a,"labelledby","waffle-targeted-cs-promo-title");Wq(a,"describedby","waffle-targeted-cs-promo-body-text")};u.Qa=function(){var a=this;IXk.prototype.Qa.call(this);fr(this.Ja("docs-icon-close-white"),"waffle-targeted-cs-promo-hc","white"==os());this.getHandler().listen(this.J,"action",function(){return a.$Ia()})};
u.render=function(){IXk.prototype.render.call(this);var a=this.Ja("jfk-bubble-arrow-id");gq(a,!1)};u.Ybb=function(){this.setVisible(!1);Jgc.Nb();rq("https://docs.google.com/spreadsheets/create?fbpf=true")};u.$Ia=function(){this.setVisible(!1);Kgc.Nb()};
function uCp(a,b,c,d){ji.call(this);var e=this;this.C=a.F;this.H=b;this.O=c;this.Db=d;this.J=!1;this.D=-1;this.F=new Lm(this);this.Ca(this.F);this.F.listen(Vw,"trigger-targeted-bigsheets-promo",function(f){if(vCp(e)&&1==e.D){var h=Typ(e.C);h.setValue(h.getValue()+1);e.J=!0;h=e.Db.getElement("waffle-assistant-entry-button-icon");h=new tCp(h,e.Db);var k=new LYb(h,!0,!0,!0);e.O.Hm(k);h.render();h=new dPa;T(h,4,f.trigger);f=new Vk;vk(f,43,h);e.H.C(116141,Cp(Ep(new Bp,f),19).va())}})}z(uCp,ji);
function wCp(a){(nf(pf(),"fedt")||nf(pf(),"fdsvo"))&&vCp(a)?Yyp().then(function(b){a.D=kj(b,1);if(dj(b,2)){var c=kj(b,2);b=new dPa;T(b,1,c);c=nf(pf(),"docs-idu");T(b,2,c);c=Typ(a.C).getValue();T(b,3,c);c=new Vk;vk(c,43,b);a.H.C(116155,Cp(Ep(new Bp,c),19).va())}}):a.D=0}function vCp(a){var b=a.C.F["ritz-HasCreatedDatasheet"].getValue(),c=Typ(a.C).getValue();return!b&&3>=c&&!a.J}
function xCp(a){ji.call(this);this.C=a.rc(2,EEk);this.F=hj(a,1)||null;this.D=new rUk(500,500,"dbxScheduleOnCompleteAuth");this.Ca(this.D)}z(xCp,ji);function yCp(a,b,c){c=void 0===c?!0:c;fj(a.C,1);var d=gzp(izp(),a.C);b&&tj(d,3,b);Cyp(px.qb(),d.va()).then(function(e){zCp(a,e.getStatus(),hj(e,2),!0,c)},function(){return ACp()})}
function BCp(a,b,c){c=void 0===c?!0:c;var d=wzp(vzp(yzp(),a.F),a.C);b&&tj(d,3,b);Dyp(px.qb(),d.va()).then(function(e){zCp(a,e.getStatus(),hj(e,2),!1,c)},function(){return ACp()})}
function zCp(a,b,c,d,e){switch(b){case 2:if(!e){ACp();break}sUk(a.D,c,function(f){d?yCp(a,f,!1):BCp(a,f,!1)});break;case 3:Js.qb().postMessage(Ls("You do not have permission to delegate access for this BigQuery project. The delegated access settings were not saved. Contact your admin or check BigQuery project settings.","error",!0))}}function ACp(){Js.qb().postMessage(Ls("There was a problem saving the delegated access settings. Please check connection settings.","error",!0))}
function CCp(a){switch(a){case 1:return 3;case 2:return 2;case 3:return 4;case 4:return 1;case 5:return 5;case 6:return 6;case 0:return 0}}var DCp={ok:"OK",cancel:"Learn more"};
function ECp(a,b,c,d,e,f,h,k,l,m,p,r,t){pVk.call(this,a,b,d,f,h,k,l);var v=this;this.Fa=Tm("docs-chrome")?new cBp(b,this.D,l,p,f,c,m,d,t,r,k.Rf()):null;this.Ca(this.Fa);this.ib=f;this.oa=new Lm(this);this.Ca(this.oa);this.zb=new uBp(a,b,c,d,e,k,l);this.Ca(this.zb);this.R=m;this.Aa=a.D.C;this.Za=new kCp(l);this.hb=r;this.$a=c;nf(pf(),"febsfbv")&&(d=new SBp(l),d.render(),d.setVisible(!1),this.Fb=new hCp(d,a,c,e),this.Ca(this.Fb));this.sb=new rBp(a,b,c,l,e,m,t);this.Ca(this.sb);this.V=new Set;this.X=
new Set;if(b=nf(pf(),"fetbp"))this.Ra=new uCp(a,l,this.Ga,Qm()),this.Ca(this.Ra),wCp(this.Ra);this.Va=!1;(l=Vt.qb().C.newDatasourceIdFromOnboarding)?FCp(this,l):eyp()?GCp(this,new nUk(null,aj(oLk,eyp())),!1):Vt.qb().C.showBigSheetsOnboardingDialogOnStart&&A8b.isEnabled()?nf(pf(),"fdcws")?HCp(this):this.M_b():fyp()&&A8b.isEnabled()&&b&&(nf(pf(),"fdcws")?HCp(this):this.YFa());this.oa.listen(this.D,"db-execution-status-updated",this.U9b).listen(this.D,"datasources-changed",this.IQc).listen(this.F,"na",
this.xZc).listen(this.F,"na",this.b1b).listen(this.F,"na",this.tRc);this.Ka=new Jm;this.Ca(this.Ka);this.Ka.Bc(a.O.H,function(x){v.b1b();ICp(v,x)})}z(ECp,pVk);u=ECp.prototype;
u.sCb=function(a){a.C(y8b,Nz).F(y8b,Nz).C(C8b,Nz).C(F8b,Gwe).F(F8b,Gwe).C(x8b,Nz).F(x8b,Nz).C(D8b,Nz).C(V7b,Gwe).C(Qcc,Gwe).C(G8b,Nz).C(H8b,Nz).C(I8b,Nz).C(J8b,Nz).C(lu,Nz).C(E8b,Nz).C(s8b,Nz).C(u8b,Nz).C(t8b,Nz).C(K8b,Nz).C(L8b,Hwe).F(L8b,Hwe).C(v8b,Fwe).C(w8b,Nz).F(w8b,Nz);var b=nf(pf(),"feds");a.C(A7b,b?Iwe:Nz);a.C(C7b,b?Iwe:Nz);a.C(B7b,b?Iwe:Nz);a.C(H7b,Nz);a.C(W7b,b?Iwe:Nz)};
u.D0b=function(){var a=this;this.ma.subscribe(C8b,"action",this.Ta).subscribe(y8b,"action",this.RRc).subscribe(x8b,"action",this.H9c).subscribe(F8b,"action",this.bpd).subscribe(D8b,"action",function(b){return JCp(a,4,b)}).subscribe(B7b,"action",function(b){return KCp(a,b)}).subscribe(C7b,"action",function(b){return JCp(a,5,b)}).subscribe(A7b,"action",function(b){return JCp(a,1,b)}).subscribe(H7b,"action",function(b){return JCp(a,3,b)}).subscribe(V7b,"action",this.U6c).subscribe(G8b,"action",this.YFa).subscribe(H8b,
"action",this.Q6c).subscribe(Qcc,"action",this.c7c).subscribe(I8b,"action",this.N_b).subscribe(J8b,"action",this.Vod).subscribe(W7b,"action",function(b){LCp(a,b.C)}).subscribe(K8b,"action",this.I9c).subscribe(L8b,"action",this.z$c).subscribe(s8b,"action",function(){return MCp(a,null,!0)}).subscribe(u8b,"action",this.sAc).subscribe(t8b,"action",this.czc).subscribe(v8b,"action",this.Xsd).subscribe(w8b,"action",this.URc)};u.U9b=function(a){a=a.D;lCp(this.Za,a);NCp(this,a)};
function NCp(a,b){b&&b.forEach(function(c){var d=h3c(c);2===(d?d.getState():null)&&4===Yk().ZX()(c)&&(c=Yk().Z7()(c))&&(d=a.D.X,d.C.delete(c),Ax(d,c))})}u.H9c=function(a){OCp(this,a.jg(),a.C,a.D)};
u.bpd=function(a){var b=this,c=a.jg(),d=a.C;if("pick-new source"==d||"change-cloud-project"==d)this.YFa(a);else{var e=aj(oLk,Yk().eHb()(c)),f=new KUk(px.qb());this.O.addCallback(function(h){if(nf(pf(),"fdcws")&&dj(e,3)&&dj(LY(e),4)){var k=h.gCc(c,e);b.Ca(k);$Y(b.C,k)}else if(!x8b.isEnabled()&&dj(e,3)&&dj(LY(e),4))k=h.fCc(c,e),b.Ca(k),$Y(b.C,k);else{var l=sVk("Connecting to BigQuery\u2026");k=LUk(f);var m=PCp(c);Jn([k,m]).then(function(p){Ks(Js.qb(),l);p=h.V9a(c,e,p[0],void 0,p[1]||void 0);b.Ca(p);
$Y(b.C,p)},function(){Ks(Js.qb(),l);b.jAa();var p=h.V9a(c,e,[],!0);b.Ca(p);$Y(b.C,p)})}})}};u.N_b=function(a){var b=this;this.O.addCallback(function(c){var d=a.F,e=d?d.C:null,f=d?d.jg():null;d=d?d.D:null;if(f&&e){var h=dj(LY(e),4)?Fzp(e):e;PCp(f,d).then(function(k){k=c.V9a(f,h,a.C,void 0,k||void 0);b.Ca(k);$Y(b.C,k)})}else f?PCp(f,d).then(function(k){k=c.oGb(a,k||void 0);b.Ca(k);$Y(b.C,k)}):(e=c.oGb(a),b.Ca(e),$Y(b.C,e))})};
u.Vod=function(a){var b=this;this.O.addCallback(function(c){var d=sVk("Connecting to BigQuery\u2026");LUk(new KUk(px.qb())).then(function(e){Ks(Js.qb(),d);e=c.pGb(a,e);b.Ca(e);$Y(b.C,e)},function(){Ks(Js.qb(),d);b.jAa();var e=c.pGb(a,[]);b.Ca(e);$Y(b.C,e)})})};function PCp(a,b){b=void 0===b?null:b;if(!nf(pf(),"fedd"))return En(null);if(b)return En(uyp(pzp(),b).va());a=mzp(ozp(),a).va();return Nyp(a).then(aa(),q(null))}u.RRc=function(a){OCp(this,null,a.C,a.D)};
function OCp(a,b,c,d){var e=null==b,f=new qCp(b,c);e&&(a.H.C(dj(c,3)&&dj(LY(c),4)?116023:116024),c=a.D.F.F["ritz-HasCreatedDatasheet"],c.getValue()||c.setValue(!0),fyp()&&a.H.C(116186));$w(f,function(h,k){if(h){h=k.jg();QCp(a,h,d,e);k=Yk().cDc()(h);var l=Yk().XCc()(k,h);RCp(a,l,4,[k]);e?FCp(a,h):Ax(a.D.X,b)}});a.R.C(f);e||RTk(a.C)}u.I9c=function(a){QCp(this,a.jg(),a.D,!1,a.C);RTk(this.C)};
function QCp(a,b,c,d,e){e=void 0===e?null:e;nf(pf(),"fedda")&&d&&(c&&fj(c.rc(2,EEk),1)?a.H.C(116204):a.H.C(116205));nf(pf(),"fedd")&&c&&(a.H.C(116192),hj(c,1)||fj(c.rc(2,EEk),1))&&(d=qLk().$c(b),e?yj(d,2,e):(b=aj(oLk,Yk().eHb()(b)),yj(d,2,b)),b=rLk().Ya(fj(c.rc(2,EEk),1)),d=yj(b,2,d),d=REk(d),hj(c,1)&&(c=hj(c,1),tj(d,1,c)),c=new xCp(d.va()),a.Ca(c),c.F?BCp(c,null):yCp(c,null))}
u.M_b=function(){var a=this,b=this.D.F.D["ritz-DisplayCountBigsheetsWelcomeDialog"],c=b.getValue();if(1<=c)this.YFa();else{b.setValue(Math.min(c+1,2147483647));var d=new gBp;this.Ca(d);$Y(this.C,d);d.Kl().then(function(e){e?a.YFa():hi(d)},function(){hi(d)})}};function FCp(a,b){var c=Vt.qb().C.transientErrorFromOnboarding;c?(SCp(a),Xn(function(){RTk(a.C);V7b.Nb(new x2c("",aj(zj,c)))},3E3)):(a.V.add(b),SCp(a))}
function SCp(a){var b=new iBp("//ssl.gstatic.com/docs/spreadsheets/bigsheets_loading_3.gif",a.H);a.Ca(b);$Y(a.C,b)}function MCp(a,b,c){var d=fz(a.F);if(d&&ev(d)){var e=d.jg();Ax(a.D.X,e).then(function(f){var h=new bVc(f,e),k=Cp(new Bp,103).va();f=new Xzp(e,b,f,h,a.D.Ta,c,a.R,a.hb,a.Aa,a.H,k);a.Ca(f);a.oa.listen(f,"update",a.tPc);$Y(a.C,f)})}}function HCp(a){var b=new Qzp;a.Ca(b);$Y(a.C,b)}u.sAc=function(){var a=fz(this.F);a&&ev(a)&&(a=TCp(a),MCp(this,a[0],!0))};
u.Xsd=function(){var a=fz(this.F);a&&ev(a)&&(a=TCp(a),MCp(this,a[0],!1))};u.czc=function(){var a=this,b=fz(this.F);if(b&&ev(b)){var c=TCp(b),d=c.length;d=(new ct("{NUM_COLUMNS, plural,=1 {Are you sure you want to delete this calculated column?}other {Are you sure you want to delete {NUM_COLUMNS} calculated columns?}}")).format({NUM_COLUMNS:d});JGd(this.ib,d,function(){return UCp(a,b.jg(),c)})}};function UCp(a,b,c){b=new HBp(b,c);$w(b,function(d){a.H.C(d?36648:36649)});a.R.C(b)}
u.tPc=function(a){var b=fz(this.F);b&&ev(b)&&b.jg()==a.Aw&&a.C&&(a=b.Kd(),b=a.yk(),xw(a,oLc(a,EOc(a,b-1,b))))};function TCp(a){a=a.Kd();var b=Nw(a);return god(a,b).map(function(c){return hj(c,2)})}u.IQc=function(){var a=this.D.O;a.R&&(a=a.D,a.D=Date.now(),a.C.clear())};u.xZc=function(){Kyp(this.D.O,fz(this.F))};u.tRc=function(){if(this.Fa&&!QTk(this.C)){var a=this.Fa;a.C&&aBp(a.C)}};
u.b1b=function(){var a=fz(this.F);if(a&&ev(a)){var b=a.jg();if(this.V.has(b)){var c=Yk().fHb()(a.Cb());if(c)if(c=wFk(this.D.O,c),"fetch-successful"==c.getType()){a=a.Kd().yk();var d=Yk().xOa()(b);c=null;null!==d&&(d=parseInt(d,10),0<d&&(c=Mod.format(d)));a=new mBp(a,c);this.Ca(a);$Y(this.C,a,!0);this.V.delete(b)}else"fetch-failed"==c.getType()&&(QTk(this.C)instanceof iBp&&STk(this.C),this.V.delete(b))}}};
u.YFa=function(a){var b=this,c=void 0;a&&(c=new nUk(a.jg(),null));var d=new Izp(new KUk(px.qb()),this.H,c);this.Ca(d);$Y(this.C,d);fyp()&&!this.Va&&(Nzp(d),this.Va=!0,this.H.C(116185));vVk(d.Ua());d.Kl().then(function(e){if(a&&"change-cloud-project"==a.C){var f=a.D;e=new JUk(f.C,f.H,"db-source-table"===e.D?e.J:null,e.D,e.F)}b.N_b(e)},function(e){e&&b.jAa();hi(d)})};u.Q6c=function(a){GCp(this,a,!0)};function GCp(a,b,c){a.O.addCallback(function(d){d=d.eCc(b,c);a.Ca(d);$Y(a.C,d)})}
u.jAa=function(){this.H.C(36685);uVk("Could not connect to BigQuery")};function JCp(a,b,c){var d=a.D.O,e=wFk(d,c).C;a.H.C(36985);null!=e&&dj(e,2)&&37==e.ai()?Myp(d,c,function(){VCp(a,b,[c])},function(f){f=f.C;null!=f&&dj(f,2)&&37==f.ai()?(a.H.C(36986),f=Czp(b,f),WCp(a,f.body,f.title)):VCp(a,b,[c])}):VCp(a,b,[c])}
function LCp(a,b){if(0!==b.length){a.H.C(36985);var c=XCp(a,b);0<c.length?Lyp(a.D.O,c,function(){VCp(a,null,b)},function(d){d=YCp(a,d);0<d.length?(a.H.C(36986),d="You do not have access to the following BigQuery connection(s): \n\n"+(d.join(", ")+" \n\n Contact the owner(s) of the BigQuery connections(s) or your admin to request access. \n\n"),d=lh(d),WCp(a,d,"Refresh failed")):VCp(a,null,b)}):VCp(a,null,b)}}
function XCp(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=wFk(a.D.O,e).C;null!=f&&dj(f,2)&&37==f.ai()&&c.push(e)}return c}function YCp(a,b){var c=[];b.forEach(function(d){var e=d.gj();dj(d,1)&&dj(e,2)&&37==e.ai()&&(d=Yk().Z7()(d.Fu()),d=Yk().Sda()(d),d=vw(a.D.C,d).Pg(),c.push(d))});$f(c);return c}
function VCp(a,b,c){nf(pf(),"fedd")&&Hyp(a.D.O,c);var d=nf(pf(),"feds")?Yk().s$a()(c):[],e=yf(c,function(f){return!Hf(d,f)});Kf(d)||ZCp(a,Yk().YCc()(d),b,d);Kf(e)||RCp(a,Yk().WCc()(e),b,c);$Cp(a,c)}
function ZCp(a,b,c,d){a.H.C(116188);b=aj(tzp,b);var e=(new Date).getTime();Gyp(a.D.O,d);Qyp(px.qb(),b,a.Aa).then(function(f){var h=mj(f,1,oyp);aDp(a,h.Lc(),d,e,c);for(var k={},l=ea(h),m=l.next();!m.done;m=l.next())m=m.value,dj(m.gj(),2)||(k[m.Fu()]=m.Uj());Pg(k)||(k=Yk().$Cc()(k),k=aj(ASd,k),a.R.C(new CSd(k)));bDp(a,h.Lc());return f},function(f){f=f.oea(0).gj();z3c(a.D.O,new Set(d),f)})}
function RCp(a,b,c,d){b=aj(rzp,b);var e=(new Date).getTime();Gyp(a.D.O,d);Ryp(px.qb(),b,a.Aa).then(function(f){var h=mj(f,2,oyp).Lc();aDp(a,h,d,e,c);bDp(a,h);return f},function(f){f=f.oea(0).gj();z3c(a.D.O,new Set(d),f)})}function aDp(a,b,c,d,e){c=1==c.length?c[0]:null;!dj(b[0].gj(),2)&&c&&e&&(a.Za.C[c]=new jCp(d,CCp(e)))}function bDp(a,b){b=ea(b);for(var c=b.next();!c.done;c=b.next()){var d=c.value;c=d.gj();3===c.getState()&&(d=d.Fu(),z3c(a.D.O,new Set([d]),c))}}
function $Cp(a,b){if(0!=b.length){var c=new ct("{numObjects, plural, =1 {Refreshing object} other {Refreshing # objects}}");Xw(c.format({numObjects:b.length}));b.forEach(function(d){return a.X.add(d)})}}function ICp(a,b){0!=a.X.size&&(b.C.forEach(function(c){var d=wFk(a.D.O,c);"loading"!=d.getType()&&"fetching-results"!=d.getType()&&a.X.delete(c)}),0==a.X.size&&"dbobjectmodel-event-update"==b.getType()&&Xw("Refresh complete"))}
u.U6c=function(a){if(a){var b=Yk().zOa()(a.Fu())?Yk().ZX()(a.Fu()):0;a=Czp(b,a.C);WCp(this,a.body,a.title)}};u.c7c=function(){Ucc.setVisible(!0)};function WCp(a,b,c){aQc(b,g(),c,DCp,a.V9b,void 0,void 0,!1,"big-sheets-feedback")}u.z$c=function(){rq("https://connectedsheets.page.link/tutorial",{target:"_blank"})};u.V9b=function(){rq("https://connectedsheets.page.link/support")};u.URc=function(){var a=fz(this.F);a&&ev(a)&&(c3c(this.D.X),pQc(a.jg()))};
function KCp(a,b){var c=cx(a.$a),d=a.D.C.C,e=Yk().Z7()(b),f=null;c?f=LGk(c)||NGk(c):d&&1==d.mj()&&(f=d.F);nf(pf(),"fedcsdl")&&f&&"no-results"==wFk(a.D.O,b).getType()&&(c=czp(bzp(ezp(),f),e).va(),Oyp(c).then(function(h){var k=a.H,l=k.C,m=f;var p=new Gza;var r=kj(h,1);p=T(p,1,r);r=kj(h,2);p=T(p,2,r);r=kj(h,3);p=T(p,3,r);r=kj(h,4);p=T(p,4,r);r=kj(h,5);p=T(p,5,r);r=h.getStatus();p=T(p,6,r);r=cDp(h.Mh());p=T(p,7,r);r=h.Kg();p=T(p,8,r);r=h.Nh();p=T(p,9,r);m=T(p,10,parseInt(m,10));p=lj(h,10,0);m=T(m,11,
p);p=kj(h,11);m=T(m,12,p);nf(pf(),"fesfcsdl")?(p=kj(h,12),m=T(m,13,p),p=kj(h,13),m=T(m,14,p),p=kj(h,14),m=T(m,15,p),p=kj(h,15),m=T(m,16,p),p=kj(h,16),m=T(m,17,p),p=lj(h,17,0),m=T(m,18,p),p=lj(h,18,0),m=T(m,19,p),h=kj(h,19),h=T(m,20,h)):h=m;m=new Mk;h=vk(m,132,h);h=Dp(Cp(new Bp,75),h).va();l.call(k,116028,h)},g()));JCp(a,2,b)}
function cDp(a){switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 7;case 7:return 8;case 8:return 9;case 9:return 10;case 10:return 14;case 11:return 6;case 12:return 17;case 13:return 15;case 14:return 11;case 15:return 18;case 16:return 12;case 17:return 20;case 18:return 21;case 19:return 22;case 20:return 23;case 21:return 25;case 22:return 26;default:return 0}}function dDp(){ji.call(this)}z(dDp,ko);dDp.prototype.C=function(){return ECp};wo("dbsource",dDp);
