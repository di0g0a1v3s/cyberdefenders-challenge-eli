G7j.prototype.ica=y(4190,function(a){this.C.C.y$(a)});O7j.prototype.ica=y(4189,function(a){this.D.ica(a)});i1a.prototype.vya=y(265,function(){return nk(this,3)});i6a.prototype.vya=y(264,function(){return nk(this,3)});aRa.prototype.IB=y(258,function(){return nk(this,2)});MUa.prototype.IB=y(257,function(){return nk(this,1)});owa.prototype.xB=y(218,function(){return hj(this,12)});qwa.prototype.xB=y(217,function(){return this.message.xB()});C4j.prototype.xB=y(216,function(){return R(this,2)});
I4j.prototype.xB=y(215,function(){return R(this,2)});function zBs(a){ez(a,function(b){b=new (b.H())(a.H,a.Db);dz(a,b);b.setVisible(!0)},"ritzmaestro")}function ABs(a,b){ez(a,function(c){c=c.C(b,this.H,this.sb,this.Ga);dz(this,c);c.setVisible(!0)},"ritzmaestro")}function BBs(a,b){ez(a,function(c){c=c.D(b,this.H,this.sb);dz(this,c);c.setVisible(!0)},"ritzmaestro")}function CBs(a,b){a.D=b}function DBs(a,b){var c=cg;eg(a,function(d,e){return c(b(d),b(e))})}function EBs(a){qj.call(this,a)}z(EBs,qj);
EBs.prototype.jg=function(){return this.message.jg()};function FBs(a){var b=GBs();HBs(b);return tj(b,3,a)}function HBs(a){a.Zo(1,2,3,4,5,6)}function IBs(a){this.Ib=Zi(a,-1,0)}z(IBs,$i);IBs.prototype.yb=function(){return new EBs(this)};IBs.prototype.jg=function(){return hj(this,1)};function GBs(){var a=void 0===a?cj(IBs):a;return new EBs(a)}function JBs(a){qj.call(this,a)}z(JBs,qj);JBs.prototype.getFunctionName=function(){return this.message.getFunctionName()};function KBs(a){this.Ib=Zi(a,-1,0)}
z(KBs,$i);KBs.prototype.yb=function(){return new JBs(this)};KBs.prototype.getFunctionName=function(){return hj(this,2)};function LBs(){var a=void 0===a?cj(KBs):a;return new JBs(a)}function MBs(a){qj.call(this,a)}z(MBs,qj);function NBs(a,b){return xj(a,1,b)}function OBs(a){this.Ib=Zi(a,-1,0)}z(OBs,$i);OBs.prototype.yb=function(){return new MBs(this)};function PBs(){var a=void 0===a?cj(OBs):a;return new MBs(a)}
function QBs(a,b){var c=this;this.J=a;this.F=new fi;this.C=new Map;this.D=new Map;this.H=new Lm(this);this.H.listen(b,"external_data_change",function(){RBs(c);c.F.dispatchEvent(null)});RBs(this)}
function SBs(a,b,c){for(var d=ea(mj(b,1,KBs).Lc()),e=d.next();!e.done;e=d.next()){var f=e.value;dj(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(fj(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.yb();dj(f,3);var k=hj(f,3);tj(h,8,k);dj(f,4)?(f=hj(f,4),tj(h,9,f)):rj(h,9);a.C.set(e,h.va())}else h=a.D.get(e).yb(),dj(f,3),f=hj(f,3),tj(h,8,f),a.C.set(e,h.va()),a.D.delete(e)}a.F.dispatchEvent(null);Xl(Ko(Co(a.J.ji("/editactions"),{data:JSON.parse(b.Mb())}),"POST"),c).Di()}
function RBs(a){var b=Yk().qea()().map(pwa),c=new Map,d=new Map;b=ea(b);for(var e=b.next();!e.done;e=b.next())e=e.value,dj(e,8)?c.set(e.getFunctionName(),e):fj(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function TBs(){return zq('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function UBs(a){return zq('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+yq(a.Sob)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function VBs(a,b,c,d,e){xt.call(this,void 0,!1,e);var f=this;this.V=a;this.R=Array.from(this.V.C.values());DBs(this.R,function(h){return h.getFunctionName()});this.F=b;this.X=c;this.C=new Map;this.O=null;this.ma=d;this.H=new Bcd("Macro removed","UNDO",function(){return WBs(f)},void 0,this.Da(),"off");this.Ca(this.H);jYb(this.X,this.H);wr(this,(new ur).jj(yr,!1,!0).set("save","Update",!0))}z(VBs,xt);
VBs.prototype.Ia=function(){xt.prototype.Ia.call(this);this.lA=!1;vr(this,!1);XBs(this,!1);br(sr(this),"waffle-edit-actions-dialog-gm");Br(this,"save");this.setTitle("Manage macros");this.Ec().appendChild(xq(TBs));for(var a=this.Ja("waffle-edit-actions-dialog-actions-row-container"),b=ea(this.R),c=b.next();!c.done;c=b.next()){c=c.value;var d=new YBs(c,this.F,this.ma);this.Pa(d);this.C.set(c.getFunctionName(),d);d.render(a)}gq(this.Ja("waffle-edit-actions-empty"),!1);this.H.render();br(this.H.Ua(),
"waffle-edit-actions-undo-remove-toast")};function XBs(a,b){xr(a.D,"save").disabled=!b}VBs.prototype.Qa=function(){var a=this;xt.prototype.Qa.call(this);ZBs(this);this.getHandler().listen(this,"dialogselect",this.oa).listen(this.Ua(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&WBs(a)});$Bs(this)};
function ZBs(a){for(var b={},c=ea(a.C.values()),d=c.next();!d.done;b={Eaa:b.Eaa},d=c.next())b.Eaa=d.value,a.getHandler().listen(b.Eaa.X,"action",function(e){return function(){return aCs(a,e.Eaa)}}(b)).listen(bCs(b.Eaa),"input",function(e){return function(){var f=e.Eaa;cCs(f)?fZ(f.R6):eZ(f.R6,"Must be a number from 0 to 9 or blank.",!0);f=!$Bs(a)&&cCs(f);XBs(a,f)}}(b)).listen(dCs(b.Eaa),"input",function(){a.F.C(29573);XBs(a,!0)})}
function $Bs(a){var b=new Map;a=ea(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(eCs(c))?b.get(eCs(c)).push(c):b.set(eCs(c),[c]);a=!1;c=null;b=ea(b);for(var d=b.next();!d.done;d=b.next()){var e=ea(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Ja("waffle-edit-actions-shortcut-conflict-message");ln(h,"Conflicts with another shortcut");gq(h,!0)})):e.forEach(function(h){h=h.Ja("waffle-edit-actions-shortcut-conflict-message");gq(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return Xw(f)})}return a}function aCs(a,b){XBs(a,!0);a.O=b;a.C.delete(b.Aa);gq(b.Ua(),!1);$Bs(a);a.H.setVisible(!0);0==a.C.size&&gq(a.Ja("waffle-edit-actions-empty"),!0);a.Ua().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return Xw(c)});a.F.C(29572)}
function WBs(a){if(null!=a.O){var b=a.O;a.C.set(b.Aa,b);gq(b.Ua(),!0);gq(a.Ja("waffle-edit-actions-empty"),!1);$Bs(a);a.O=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return Xw(c)});a.F.C(29577)}}
VBs.prototype.oa=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ea(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!cCs(d)||""!=fCs(d)){a.preventDefault();return}$Bs(this)?a.preventDefault():(a=gCs(this),SBs(this.V,a,function(){var e=Ot(b.X,"Failed to update macros.",Qm(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);Nt(e);e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return Xw("Macros updated")}))}};
function gCs(a){for(var b=PBs(),c=ea(a.R),d=c.next();!d.done;d=c.next()){var e=d.value;d=LBs();var f=!1,h=a.C.get(e.getFunctionName()),k=hj(e,9),l=hj(e,8);h?(k!=eCs(h)&&(k=eCs(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(sj(d,5,!0),f=!0);f&&(f=hj(e,1),tj(d,1,f),e=e.getFunctionName(),tj(d,2,e),tj(d,3,l),k&&tj(d,4,k),d=d.va(),wj(b,1,d))}return b.va()}
function YBs(a,b,c,d){mq.call(this,d);this.oa=a;this.Ka=hj(a,8);this.Aa=a.getFunctionName();this.J=(a=hj(a,9))?a.split("+"):[];this.D=new kt;this.Pa(this.D);this.O=this.R=null;this.C=new kt;this.Pa(this.C);this.ma=new At;this.Ca(this.ma);this.Fa=b;this.Ga=c;b=Mr(Yr,"waffle-overflow-menu-material");this.H=new ls(void 0,void 0,b,this.Da());this.Ca(this.H);this.V=new as("Edit script");this.Ca(this.V);this.X=new as("Remove");this.Ca(this.X);this.R6=new dZ(this.Da());this.Ca(this.R6);this.F=new dZ(this.Da());
this.Ca(this.F)}z(YBs,mq);YBs.prototype.Ia=function(){var a=(Kf(this.J)?hCs:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=xq(UBs,{Sob:gp?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.Ob(a)};
YBs.prototype.Qa=function(){var a=this;this.D.ub(this.Ja("waffle-edit-actions-row-shortcut-input"));this.D.setValue(sf(this.J)||"");var b=this.Ja("waffle-edit-actions-name-input");this.C.ub(b);this.C.setValue(this.Ka);this.ma.ub(b);this.R6.setPosition(3,2);this.R6.render();b=this.D.Ua();this.R6.xo(b);gZ(this.R6,b);fZ(this.R6);this.F.setPosition(0,2);this.F.render();b=this.C.Ua();this.F.xo(b);gZ(this.F,b);fZ(this.F);b=new Sq(this.H.Ec(),13);zNb(this.H,b);this.H.QO=!0;this.H.Me(this.V);this.H.Me(this.X);
b=this.Ja("waffle-edit-actions-row-menu");this.H.ub(b);"black"==os()&&br(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.V,"action",function(){a.Ga.Oa("macros-editor").Nb({scriptId:hj(a.oa,1),filename:hj(a.oa,10)});a.Fa.C(29570)}).listen(this.C.Ua(),"blur",function(){""==fCs(a)?fZ(a.F):eZ(a.F,fCs(a),!0)}).listen(this.D.Ua(),"click",function(){return a.D.Ua().select()}).listen(bCs(this),"input",function(){return a.Fa.C(29571)});Zq(this.Ja("waffle-edit-actions-name-input"),"Macro name");
Zq(this.D.Ua(),"Numeric shortcut key");Zq(b,"More options button")};function eCs(a){var b=a.D.getValue();return""==b?"":(Kf(a.J)?hCs:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function bCs(a){null==a.R&&(a.R=new zt(a.D.Ua()),a.Ca(a.R));return a.R}function dCs(a){null==a.O&&(a.O=new zt(a.C.Ua()),a.Ca(a.O));return a.O}function cCs(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function fCs(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var hCs=["Ctrl","Alt","Shift"];function iCs(){return zq('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function jCs(a){var b=a.Ekd,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+yq(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(yq(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(yq(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return zq(a)};function kCs(a,b,c,d){xt.call(this,void 0,!1,d);this.R=a;this.X=Array.from(this.R.D.values());DBs(this.X,function(e){return e.getFunctionName()});this.O=b;this.V=c;this.H=[];this.F=[];this.C=Ot(this.V,"Function added.",Qm(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.Ca(this.C);this.Ga=new Ct(this.Da());this.Ca(this.Ga);this.ma=new io(this.oa,3E3,this);this.Ca(this.ma)}z(kCs,xt);
kCs.prototype.Ia=function(){xt.prototype.Ia.call(this);br(sr(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.Da().Ia("DIV","waffle-import-custom-function-title-description",hu()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");hLb(this).appendChild(a);this.Ec().appendChild(xq(iCs));a=this.Ja("waffle-import-custom-functions-row-container");for(var b=ea(this.X),c=b.next();!c.done;c=
b.next())c=new lCs(c.value,this.O),this.Pa(c),c.render(a),this.H.push(c);this.C.render();this.C.setVisible(!1);wr(this,null)};kCs.prototype.Qa=function(){var a=this;xt.prototype.Qa.call(this);for(var b={},c=ea(this.H),d=c.next();!d.done;b={DHa:b.DHa},d=c.next())b.DHa=d.value,this.getHandler().listen(b.DHa.D,"action",function(e){return function(){return mCs(a,e.DHa)}}(b));this.getHandler().listen(this,"hide",function(){return a.oa()})};
function mCs(a,b){nCs(b);var c=oCs(b.C);pCs(a,c);b=b.Ja("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");Zq(b,"This function has been added.");b.focus();a.O.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function oCs(a){var b=LBs();var c=hj(a,1);b=tj(b,1,c);c=a.getFunctionName();b=tj(b,2,c);a=a.getFunctionName();return tj(b,3,a).va()}function pCs(a,b){a.F.push(b);a.ma.start()}
kCs.prototype.oa=function(){var a=this;if(0<this.F.length){var b=NBs(PBs(),this.F).va();SBs(this.R,b,function(){var c=Ot(a.V,"Failed to add function.",Qm(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);Nt(c);c.render();c.setVisible(!0)});this.F=[]}};function lCs(a,b,c){mq.call(this,c);this.C=a;this.H=b;a=Et.qb();this.D=new Zr("Add Function",a,c);this.Pa(this.D);this.F=new Zr("Edit Script",a,c);this.Pa(this.F)}z(lCs,mq);
lCs.prototype.Ia=function(){mq.prototype.Ia.call(this);var a=xq(jCs,{functionName:this.C.getFunctionName(),Ekd:hj(this.C,2),fileName:hj(this.C,10)});this.Ob(a);this.D.render(this.Ja("waffle-import-custom-function-add-function"));this.F.render(this.Ja("waffle-import-custom-function-view-script"))};
lCs.prototype.Qa=function(){var a=this;mq.prototype.Qa.call(this);this.getHandler().listen(this.F,"action",function(){wp("macros-editor").Nb({scriptId:hj(a.C,1),filename:hj(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(hj(this.C,2)+(", defined in file: "+hj(this.C,10)))));Zq(this.Ua(),b)};function nCs(a){gq(a.D.Ua(),!1);br(a.Ja("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function qCs(a,b,c,d,e,f){ji.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}z(qCs,ji);function rCs(a){Q(this,a,0,-1,sCs,null)}A(rCs,O);var sCs=[6];u=rCs.prototype;u.Ba=function(){var a=new K;tCs(this,a);return L(a)};function tCs(a,b){var c=R(a,1);null!=c&&b.Ha(1,c);c=R(a,2);null!=c&&b.Ha(2,c);c=R(a,3);null!=c&&b.Ha(3,c);c=R(a,4);null!=c&&b.Ha(4,c);c=R(a,5);null!=c&&b.Ha(5,c);c=a.Em();0<c.length&&fk(b,6,c,tCs);c=R(a,7);null!=c&&M(b,7,c);c=R(a,9);null!=c&&b.Ha(9,c);c=R(a,10);null!=c&&b.Ha(10,c);c=R(a,11);null!=c&&N(b,11,c);c=R(a,12);null!=c&&N(b,12,c);c=R(a,13);null!=c&&b.Ha(13,c)}
u.Qh=function(){return R(this,1)};u.Fl=function(){return R(this,2)};u.Kr=function(a){T(this,2,a)};u.getKey=function(){return R(this,5)};u.Em=function(){return Ek(this,rCs,6)};u.Me=function(a,b){return Hk(this,6,a,rCs,b)};u.Ya=function(a){return T(this,7,a)};u.xB=function(){return R(this,13)};function uCs(a){Q(this,a,"amep",-1,null,null)}A(uCs,O);uCs.prototype.Ba=function(){var a=new K;var b=this.Hc();null!=b&&a.xa(1,b,tCs);return L(a)};uCs.messageId="amep";uCs.prototype.Hc=function(){return U(this,rCs,1,1)};uCs.prototype.Ah=function(a){return vk(this,1,a)};uCs.prototype.axa=function(){uk(this,1)};uCs.prototype.PQ=function(){return lk(this,1)};function vCs(a){zm.call(this,a)}z(vCs,zm);function wCs(a){zm.call(this,"amep");this.D=new uCs(a)}z(wCs,vCs);wCs.prototype.C=n("D");function xCs(a){Q(this,a,0,-1,null,null)}A(xCs,O);xCs.prototype.Ba=function(){var a=new K;yCs(this,a);return L(a)};
function yCs(a,b){var c=R(a,1);null!=c&&b.Ha(1,c);c=R(a,2);null!=c&&b.Ha(2,c);c=R(a,3);null!=c&&b.Ha(3,c);c=R(a,4);null!=c&&M(b,4,c);c=R(a,5);null!=c&&b.Ha(5,c);c=R(a,6);null!=c&&b.Ha(6,c);c=R(a,7);null!=c&&b.Ha(7,c);c=R(a,8);null!=c&&M(b,8,c);c=R(a,9);null!=c&&M(b,9,c);c=R(a,10);null!=c&&M(b,10,c);c=R(a,11);null!=c&&b.Ha(11,c);c=R(a,12);null!=c&&M(b,12,c);c=R(a,13);null!=c&&b.Ha(13,c);c=R(a,14);null!=c&&b.Ha(14,c);c=R(a,15);null!=c&&b.Ha(15,c);c=R(a,16);null!=c&&b.Ha(16,c);c=R(a,17);null!=c&&b.Ha(17,
c);c=R(a,18);null!=c&&Vj(b,18,c);c=R(a,19);null!=c&&M(b,19,c)}function T9(a){return R(a,2)}xCs.prototype.getName=function(){return R(this,3)};xCs.prototype.Gq=function(){return R(this,13)};function zCs(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}zCs.prototype.F=n("C");function ACs(a,b){return nf(pf(),"docs-emgsmw")?null==a.F||null==R(b,18)?!1:a.C===R(b,18):a.D===R(b,1)}function BCs(a){return new zCs(R(a,1),R(a,18))};function CCs(a){Q(this,a,"der",-1,null,null)}A(CCs,O);CCs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);return L(a)};CCs.messageId="der";CCs.prototype.IB=function(){return nk(this,1)};function DCs(a){Q(this,a,"eer",-1,null,null)}A(DCs,O);DCs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);return L(a)};DCs.messageId="eer";DCs.prototype.IB=function(){return nk(this,1)};function ECs(a,b,c){this.C=a;this.F=b;this.D=c}ECs.prototype.getVersionInfo=n("D");function FCs(a,b){this.C=a;this.D=b}FCs.prototype.getVersionInfo=n("D");function GCs(a,b){this.C=a;this.Mg=b}GCs.prototype.getExtension=n("C");GCs.prototype.isEnabled=n("Mg");function HCs(a){xt.call(this);this.C=a;tr(this,!0);this.nJ(!1);wr(this,null);vr(this,!1)}z(HCs,xt);HCs.prototype.Ia=function(){xt.prototype.Ia.call(this);this.C.render(this.Ec())};HCs.prototype.Qa=function(){xt.prototype.Qa.call(this);var a=this.Ua();Xq(a,"labelledby");Zq(a,"Add-ons");br(sr(this),"gsm-widget")};function ICs(a,b){var c=new Mk,d=new QDa;if(b){if(R(b,1)){var e=R(b,1);T(d,1,e)}e=nk(b,12);T(d,2,e);lk(b,18)&&(e=R(b,18),T(d,5,e));b=nk(b,19);T(d,6,b)}b=qf(pf(),"docs-tcmt");e=!!b;T(d,3,e);e&&T(d,4,b);vk(c,73,d);return Cp(Dp(new Bp,c),a).va()}function JCs(a){var b=new Mk,c=new QDa;null!=a.D&&T(c,1,a.D);null!=a.C&&T(c,5,a.C);vk(b,73,c);return Cp(Dp(new Bp,b),90).va()};function KCs(a,b,c){XZk.call(this,a);this.D=b;this.F=c;this.D.Vo=!0}z(KCs,XZk);u=KCs.prototype;u.q3a=function(){wp("macros-extension-store-render").Nb()};u.UJa=function(a,b,c){a=new zCs(null,a);wp("macros-extension-store-install").Nb(new ECs(a,String(b),c),JCs(a))};u.p3a=function(a,b){a=new zCs(null,a);wp("macros-extension-store-uninstall-item").Nb(new FCs(a,b),JCs(a))};
u.uwb=function(a){var b=new TZk,c=this.F(new zCs(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new VZk;d.Kr("Use in this document");T(d,3,"useInDoc");d.Wc(!!nk(a,4)||!!nk(a,12));d.Ya(c);var e=new VZk;e.Kr("Help");T(e,3,"help");d=[d,e];nk(a,9)&&(e=new VZk,T(e,1,!0),d.push(e),nk(a,8)&&(a=new VZk,a.Ya(c),a.Kr("Settings"),T(a,3,"settings"),d.push(a)),a=new VZk,a.Kr("Report an issue"),T(a,3,"reportIssue"),d.push(a));Gk(b,1,d);return b};
u.twb=function(a,b){var c=new zCs(null,a);a=JCs(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();wp("macros-extension-help").Nb(T9(b),a);break;case "reportIssue":wp("macros-extension-store-report").Nb(c,a);break;case "settings":wp("macros-extension-store-settings").Nb(c,a);hi(this.D);break;case "useInDoc":wp("macros-extension-store-use-in-doc").Nb(c,a)}};u.eXa=function(){this.D.setVisible(!1)};function LCs(a,b,c){ji.call(this);this.D=MCs(a);this.F=b;this.C=c}z(LCs,ji);function NCs(a,b,c,d,e){b=new V6k(b,null,e);W6k(b,rf(pf(),"docs-gsmd"));a.C&&Z6k(b,a.C);CBs(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=rf(pf(),"gaia_session_id");a=sg(a)?NaN:Number(a);isNaN(a)||X6k(b,a);return b.va()}function OCs(a,b){var c=new HCs(b);a=new KCs(b,c,a.F);c.Ca(a);return c}
function MCs(a){if(a==(Is(),hRb))return"docs_addon";if(a==(Is(),iRb))return"sheets_addon";if(a==(Is(),jRb))return"slides_addon";if(a==(Is(),lRb))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function PCs(a,b,c,d,e,f){ji.call(this);this.D=b;this.F=new LCs(a,d,f);this.C=null}z(PCs,ji);function QCs(a){Q(this,a,"iar",-1,null,null)}A(QCs,O);QCs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,3);null!=b&&M(a,3,b);return L(a)};QCs.messageId="iar";QCs.prototype.IB=function(){return nk(this,1)};function RCs(a,b,c,d){var e=R(a,4)+"-polymorphic-"+(a.Qh()||"");JFb.call(this,e);this.J=a;this.R=zf(b,function(f){return new RCs(f,[],!1)},this);this.Ya(this.isEnabled());this.Aa=c;this.oa="boolean"===typeof d?d:!0}z(RCs,JFb);u=RCs.prototype;u.Ab=n("J");u.isInstalled=n("oa");u.Nb=function(){wp("macros-polymorphic-item").Nb(this)};u.isEnabled=function(){return this.R&&(0<this.R.length?!0:!!nk(this.J,7))};u.getLabel=function(){return this.J.Fl()||R(this.J,10)||""};function SCs(){zm.call(this,"bm")}z(SCs,zm);function TCs(){Im.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new ts(this);this.Ca(this.D);this.D.subscribe(wp("macros-polymorphic-item"),"action",this.F)}z(TCs,Im);TCs.prototype.F=function(a){a.Aa||0<a.R.length?this.dispatchEvent(new SCs(a)):(a=new qCs(R(a.Ab(),4),R(a.Ab(),3),void 0,R(a.Ab(),9)||void 0,void 0,a.Ab().xB()||void 0),wp("macros-exec").Nb(a))};function UCs(a){Q(this,a,"ger",-1,VCs,null)}A(UCs,O);var VCs=[1];UCs.prototype.Ba=function(){var a=new K;var b=this.aPa();0<b.length&&fk(a,1,b,yCs);return L(a)};UCs.messageId="ger";UCs.prototype.aPa=function(){return Ek(this,xCs,1)};function WCs(a){Q(this,a,0,-1,null,null)}A(WCs,O);WCs.prototype.Ba=function(){var a=new K;XCs(this,a);return L(a)};function XCs(a,b){var c=R(a,1);null!=c&&b.Ha(1,c);c=R(a,2);null!=c&&b.Ha(2,c)}WCs.prototype.getName=function(){return R(this,1)};function YCs(a){Q(this,a,0,-1,ZCs,null)}A(YCs,O);var ZCs=[4];u=YCs.prototype;u.Ba=function(){var a=new K;$Cs(this,a);return L(a)};function $Cs(a,b){var c=R(a,1);null!=c&&b.Ha(1,c);c=R(a,2);null!=c&&b.Ha(2,c);c=R(a,3);null!=c&&b.Ha(3,c);c=Ek(a,WCs,4);0<c.length&&fk(b,4,c,XCs)}u.getId=function(){return R(this,1)};u.$c=function(a){return T(this,1,a)};u.getName=function(){return R(this,2)};u.Hg=function(){return R(this,3)};u.xn=function(a){return T(this,3,a)};function aDs(a){Q(this,a,"llr",-1,bDs,null)}A(aDs,O);var bDs=[2];aDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);b=Ek(this,YCs,2);0<b.length&&fk(a,2,b,$Cs);return L(a)};aDs.messageId="llr";aDs.prototype.IB=function(){return nk(this,1)};function cDs(a){Q(this,a,"rar",-1,null,null)}A(cDs,O);cDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);b=R(this,2);null!=b&&a.Ha(2,b);return L(a)};cDs.messageId="rar";cDs.prototype.IB=function(){return nk(this,1)};function dDs(a){Q(this,a,"uer",-1,null,null)}A(dDs,O);dDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);return L(a)};dDs.messageId="uer";dDs.prototype.IB=function(){return nk(this,1)};function eDs(a,b,c,d){ji.call(this);this.D=a;this.F=c;this.C=d||new fDs}z(eDs,ji);u=eDs.prototype;u.$Ob=function(a,b,c,d,e,f,h){a=["ruid",ta({}),this.C.C,this.D,this.C.F,a,this.C.ma,b,this.C.D,c,this.C.O,e,this.C.R,f,this.C.J,h];a=Go(Wl(Ko(gDs(this,this.C.oa),"POST"),2),a).bC();d&&(Yl(a,ua(this.$lc,this,d)),Xl(a,ua(this.vYc,this,d)));a.Di()};u.cancel=function(a){a=["ruid",ta({}),this.C.C,this.D,this.C.H,a];Go(Wl(Ko(gDs(this,this.C.V),"POST"),2),a).bC().Di()};
function hDs(a,b){var c=["ruid",ta({}),a.C.C,a.D];c=Go(Wl(gDs(a,a.C.Aa),2),c);b&&(Yl(c,ua(a.eZc,a,b)),Xl(c,ua(a.dZc,a,b)));c.Di()}u.$lc=function(a,b){b=b.gh();b=new QCs(b[0]);a(b)};u.vYc=function(a){var b=new QCs;T(b,1,!1);a(b)};u.eZc=function(a,b){b=b.gh();b=new aDs(b[0]);a(b)};u.dZc=function(a){var b=new aDs;T(b,1,!1);a(b)};u.amc=function(a,b){b=b.gh();b=new cDs(b[0]);a(b)};u.L4c=function(a){var b=new cDs;T(b,1,!1);a(b)};
function iDs(a,b){var c=["ruid",ta({}),a.C.C,a.D];Xl(Yl(Go(Wl(gDs(a,"/scripts/getitems"),1),c),ua(a.CWc,a,b)),pa).Di()}u.CWc=function(a,b){b=b.gh();b=new UCs(b[0]);a(b)};function jDs(a,b,c,d){function e(h,k){k=k.gh();k=new dDs(k[0]);h(k)}var f=["ruid",ta({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=Go(Ko(gDs(a,"/scripts/uninstallitem"),"POST"),f).bC();c&&(Yl(b,ua(e,a,c)),a=new dDs,T(a,1,!1),Xl(b,xa(c,a)));b.Di()}
u.lFb=function(a,b,c,d,e,f){a=["ruid",ta({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=Go(Wl(Ko(gDs(this,"/scripts/enableitem"),"POST"),1),a).bC();c&&(Yl(b,ua(this.KUc,this,c)),Xl(b,ua(this.JUc,this,c)));b.Di()};u.KUc=function(a,b){b=b.gh();b=new DCs(b[0]);a(b)};u.JUc=function(a){var b=new DCs;T(b,1,!1);a(b)};
u.Czc=function(a,b,c,d){a=["ruid",ta({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=Go(Wl(Ko(gDs(this,"/scripts/disableitem"),"POST"),1),a).bC();c&&(Yl(b,ua(this.kTc,this,c)),Xl(b,ua(this.jTc,this,c)));b.Di()};u.kTc=function(a,b){b=b.gh();b=new CCs(b[0]);a(b)};u.jTc=function(a){var b=new CCs;T(b,1,!1);a(b)};function gDs(a,b){return Ho(a.F.ji(b)).setTimeout(4E4)}
function fDs(a,b,c,d,e,f,h,k,l,m,p,r,t,v,x,G,P,S){ji.call(this);this.C=a||"id";this.F=c||"lib";this.ma=d||"func";this.D=e||"ctx";this.H=f||"pid";this.O=G||"eei";this.R=P||"usit";this.J=void 0!==S?S:"did";this.X=h||"ca";this.oa=k||"/scripts/invoke";this.V=l||"/scripts/cancel";this.Aa=m||"/scripts/libraries";this.Fa=p||"/scripts/resume";this.Ga=t||"/scripts/uiready"}z(fDs,ji);function kDs(a,b,c,d,e,f,h,k,l,m,p,r){ji.call(this);var t=this;this.Ga=m?rbd(m):void 0;this.Fa=m?sbd(m):void 0;this.ma=a;this.C=d;this.Ka=e;this.X=b;this.O=f;this.F=h;this.J=k;this.D=[];this.H=l;this.R=new $Lb("mae-show_addons_menu_promo");Ir(c,this.R,"mae-show_addons_menu_promo");this.Aa=p||null;this.oa=r||null;this.V=new PCs(this.ma,this.X,this,function(v){if(v=t.getExtension(v)){var x=2==t.H?!1:1==t.H?!(!nk(v,10)||!nk(v,9)):!0;v=new GCs(v,x)}else v=void 0;return v},this.Fa,this.Ga);this.Ca(this.V);
wp("macros-extension-store-install").Fc(Yo,this.dVc,this);wp("macros-extension-store-install").Ya(!0);wp("macros-extension-store-render").Fc(Yo,this.eVc,this);wp("macros-extension-store-render").Ya(!0);wp("macros-extension-store-report").Fc(Yo,this.fVc,this);wp("macros-extension-store-report").Ya(!0);wp("macros-extension-store-settings").Fc(Yo,this.gVc,this);wp("macros-extension-store-settings").Ya(!0);wp("macros-extension-store-uninstall-item").Fc(Yo,this.hVc,this);wp("macros-extension-store-uninstall-item").Ya(!0);
wp("macros-extension-store-use-in-doc").Fc(Yo,this.iVc,this);wp("macros-extension-store-use-in-doc").Ya(!0)}z(kDs,ji);u=kDs.prototype;u.eVc=function(){lDs(this)};u.dVc=function(a){a=a.data;mDs(this,a.F,a.C,a.getVersionInfo())};u.fVc=function(a){a=this.getExtension(a.data);var b=BCs(a);this.RXb(b,T9(a),a.getName(),R(a,6)||void 0,R(a,11)||void 0)};u.gVc=function(a){a=this.getExtension(a.data);nDs(this,T9(a))};
u.hVc=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&T9(b);b=BCs(b);oDs(this,c,b,pa,a.getVersionInfo())};u.iVc=function(a){var b=this.getExtension(a.data);a=BCs(b);nk(b,4)||nk(b,12)?pDs(this,T9(b),a,function(c){c&&(T(b,4,!1),T(b,12,!1))}):qDs(this,T9(b),a,function(c){c&&T(b,4,!0)})};u.Cha=function(a){var b=rDs(this,!1),c=this.V;var d=c.F;a=NCs(d,d.D,b,a,!1);d=OCs(d,a);c.C=d;d=c.C;c.D.Hm(d);d.setVisible(!0);sDs(this)};
function rDs(a,b){return(void 0===b?0:b)?a.D.map(function(c){return BCs(c)}):a.D.filter(function(c){return nk(c,10)&&nk(c,9)}).map(function(c){return BCs(c)})}function nDs(a,b){tDs(a.C);var c=ua(function(d,e){this.C.Y8();d&&d(e)},a,void 0);V_j(a.O.C,ua(a.F.$Ob,a.F,b,"doSettings",a.J().getState()||void 0,c))}
function qDs(a,b,c,d){tDs(a.C);V_j(a.O.C,ua(a.F.lFb,a.F,b,c,ua(function(e,f){if(f.IB()){var h=a.getExtension(c);h&&T(h,4,!0);lDs(a)}a.C.Y8();e&&e(f.IB())},a,d),void 0,a.J().getState()||void 0))}function pDs(a,b,c,d){tDs(a.C);V_j(a.O.C,ua(a.F.Czc,a.F,b,c,ua(function(e,f){if(f.IB()){wp("macros-extension-disabled").Nb(b);var h=a.getExtension(c);h&&(T(h,4,!1),T(h,12,!1));lDs(a)}a.C.Y8();e&&e(f.IB())},a,d),a.J().getState()||void 0))}
function oDs(a,b,c,d,e){jDs(a.F,c,ua(function(f,h){if(h.IB()&&b){wp("macros-extension-disabled").Nb(b);var k=a.D.findIndex(function(l){return ACs(c,l)});-1!=k&&Uf(a.D,k);(k=uDs(a.C))&&Qg(k.J,b)}lDs(a,function(){return f(h.IB())})},a,d),e)}
u.RXb=function(a,b,c,d,e){e?rq(e):(vDs(this.C,ua(function(f,h){var k=this.F,l=ua(this.C.Epd,this.C,c,h,d),m=ua(this.C.Dpd,this.C);f=["ruid",ta({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);Go(Xl(Yl(Wl(Ko(gDs(k,"/scripts/sendissuereport"),"POST"),1),Yg(l)),Yg(m)),f).bC().Di()},this),c),sDs(this))};
function mDs(a,b,c,d){tDs(a.C);V_j(a.O.C,ua(a.F.lFb,a.F,b,c,function(e){a.C.Y8();e.IB()?lDs(a):(e=Ls("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),wDs(a))},!0,a.J().getState()||void 0,d))}function lDs(a,b){b=void 0===b?pa:b;iDs(a.F,ua(function(c,d){d=d.aPa();Pf(this.D);d=ea(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);xDs(this);wDs(this);c()},a,b))}
function xDs(a){var b=a.Ka,c=Xf(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=T9(e),h=new rCs,k=String(ta(h));T(h,1,k);h.Kr(e.getName());k=T9(e);T(h,4,k);h.Ya(!0);k=e.getName();T(h,10,k);T(h,11,1);k=!(!nk(e,10)&&!nk(e,9));e=new RCs(h,[],!0,k,nk(e,19)||!1);e.setVisible(!0);b.C[ok(e.Ab(),11,0)][f]=e}b.dispatchEvent("$l");if(b=a.C.R)if(Kf(a.D))!a.R.getValue()&&wp("macros-extension-menu-promo").isEnabled()&&(a=a.ma,hjb(b.J.F,"mae-promo-id")||(a=new yDs(a),a.render(),c=new as(""),c.$c("mae-promo-id"),
c.ld("script-promo-menu-item"),c.setContent(a.getElement()),vs(b.R,c,wp("macros-extension-menu-promo"),void 0,void 0,ICs(3)),b.C.Fd(),b.J.Fd(),zDs(b.J,c)),ADs(b));else{c=Xf(a.D);if(b.F){eg(c,b.Ka);f=new im;fjb(f,b.C.F);b.J.Fd();b.C.Fd();d=[];for(e=0;e<c.length;++e){k=c[e];var l=T9(k),m=!(!nk(k,10)&&!nk(k,9));d.push(l);h=f.get(l);var p=nk(k,19);if(h)l=h.Hc(),m&&!p&&(m=l.Ld(0),p="addon-menu-install-"+T9(k),m&&m.getId()==p&&(l.Xw(0).dispose(),2==l.yd()&&(l.Ld(0),l.Xw(0).dispose())));else{h=new hs("");
h.$c(l);h.Ya(2==b.V?!1:1==b.V?!!(k&&nk(k,10)&&nk(k,9)):!0);var r=new es;m||p||BDs(b,r,k);CDs(b,r,l,[],k);h.Ah(r)}k=k.getName();m=an("span");m.appendChild(bn(k));h.setContent(m);DDs(h.Hc().Ua(),!0);zDs(b.C,h)}for(e=0;e<b.X.length;++e)zDs(b.C,f.get(b.X[e]));if(b.O)for(f=f.gi(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.X.indexOf(f[e])&&(h=b.oa[f[e]])){for(k=0;k<h.length;++k)b.O.ica(h[k]);delete b.oa[f[e]]}wp("macros-manage-extensions").Ya(!!c.length);ADs(b)}a.oa&&a.oa.C(!!a.D.length)}}
function wDs(a){var b=uDs(a.C);if(b){var c=Xf(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(nk(f,12)||nk(f,4))Mia(b.C,f,b.jBc),b.H&&!nk(f,12)&&(b.H=!1)}wp("macros-addon-sidebar-focus").Ya(0<b.C.length);b.V=0==d;b.X=!0;b.O=1==b.C.length&&null!=EDs(b);b.Dc()&&FDs(b);a.Aa&&a.Aa.C(0<b.C.length)}}u.getExtension=function(a){return this.D.find(function(b){return ACs(a,b)})};function GDs(a,b){return a.D.find(function(c){return T9(c)===b})}
function sDs(a){if(!a.R.getValue()&&(a.R.setValue(!0),Kf(a.D))){var b=a.C.R;if(b){var c=Wm("docs-menu-superscript",b.D.getElement());c&&oIb(c,0);b.J.Fd();ADs(b);xDs(a)}}};function HDs(a,b,c,d,e,f,h,k,l,m,p,r,t){this.O=a;this.F=b;this.V=c;this.X=d;this.H=e;this.Aa=h;this.D=k;this.C=l;this.R=m;this.ma=p;this.oa=r;this.J=t}function IDs(a,b){a=a.V;if(b){a=new sm(a);var c=a.F;c+=jg(c,"/")?"":"/";jg(c,"/start/")&&(c=c.replace("start/",""));c+=qla("d/%s/edit",b);vm(a,c);a=a.toString()}return a};function JDs(a){Q(this,a,0,-1,null,null)}A(JDs,O);JDs.prototype.Ba=function(){var a=new K;KDs(this,a);return L(a)};function KDs(a,b){var c=R(a,1);null!=c&&b.Ha(1,c);c=R(a,2);null!=c&&b.Ha(2,c);c=R(a,3);null!=c&&Tj(b,3,c);c=R(a,4);null!=c&&b.Ha(4,c)};function LDs(a){Q(this,a,0,-1,null,null)}A(LDs,O);LDs.prototype.Ba=function(){var a=new K;MDs(this,a);return L(a)};function MDs(a,b){var c=R(a,1);null!=c&&b.Ha(1,c);c=R(a,2);null!=c&&b.Ha(2,c);c=R(a,3);null!=c&&b.Ha(3,c);c=R(a,5);null!=c&&Vj(b,5,c);c=R(a,6);null!=c&&N(b,6,c);c=U(a,JDs,7);null!=c&&b.xa(7,c,KDs);c=R(a,8);null!=c&&N(b,8,c);c=R(a,9);null!=c&&Vj(b,9,c);c=R(a,10);null!=c&&Vj(b,10,c);c=R(a,11);null!=c&&Vj(b,11,c)}LDs.prototype.Uj=function(){return R(this,3)};function NDs(a){Q(this,a,"paep",-1,null,null)}A(NDs,O);NDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=U(this,LDs,3);null!=b&&a.xa(3,b,MDs);b=R(this,4);null!=b&&M(a,4,b);return L(a)};NDs.messageId="paep";NDs.prototype.getUrl=function(){return R(this,1)};NDs.prototype.Tj=function(){return R(this,2)};function ODs(a){zm.call(this,"paep");this.D=new NDs(a)}z(ODs,vCs);ODs.prototype.C=n("D");function PDs(a){Q(this,a,0,-1,null,null)}A(PDs,O);PDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&N(a,1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,3);null!=b&&M(a,3,b);b=R(this,4);null!=b&&a.Ha(4,b);return L(a)};PDs.prototype.aq=function(){return R(this,2)};function QDs(a){Q(this,a,"rfep",-1,null,null)}A(QDs,O);QDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,4);null!=b&&a.Ha(4,b);b=R(this,5);null!=b&&a.Ha(5,b);return L(a)};QDs.messageId="rfep";QDs.prototype.getFunctionName=function(){return R(this,2)};QDs.prototype.xB=function(){return R(this,5)};function RDs(a){zm.call(this,"rfep");this.D=new QDs(a)}z(RDs,vCs);RDs.prototype.C=n("D");function SDs(a){Q(this,a,"sfep",-1,null,null)}A(SDs,O);SDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&N(a,2,b);b=R(this,3);null!=b&&a.Ha(3,b);return L(a)};SDs.messageId="sfep";SDs.prototype.aY=function(){return R(this,2)};SDs.prototype.Tj=function(){return R(this,3)};function TDs(a){zm.call(this,"sfep");this.D=new SDs(a)}z(TDs,vCs);TDs.prototype.C=n("D");function UDs(a){Q(this,a,"step",-1,null,null)}A(UDs,O);UDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&M(a,2,b);return L(a)};UDs.messageId="step";UDs.prototype.vya=function(){return nk(this,2)};function VDs(a){zm.call(this,"step");this.D=new UDs(a)}z(VDs,vCs);VDs.prototype.C=n("D");function WDs(a){Q(this,a,"scpep",-1,null,null)}A(WDs,O);WDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&M(a,1,b);return L(a)};WDs.messageId="scpep";function XDs(a){zm.call(this,"scpep");this.D=new WDs(a)}z(XDs,vCs);XDs.prototype.C=n("D");function YDs(a){Q(this,a,"saep",-1,null,null)}A(YDs,O);YDs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,3);null!=b&&a.Ha(3,b);b=R(this,4);null!=b&&a.Na(4,b);b=R(this,5);null!=b&&a.Na(5,b);b=R(this,6);null!=b&&N(a,6,b);b=R(this,7);null!=b&&a.Ha(7,b);b=R(this,8);null!=b&&M(a,8,b);b=U(this,FX,9);null!=b&&a.xa(9,b,h8j);return L(a)};YDs.messageId="saep";u=YDs.prototype;u.getTitle=function(){return R(this,2)};
u.setTitle=function(a){return T(this,2,a)};u.kc=function(){return R(this,4)};u.setWidth=function(a){return T(this,4,a)};u.zc=function(){return R(this,5)};u.setHeight=function(a){return T(this,5,a)};u.ir=function(){return ok(this,6,0)};u.Uu=function(a){return T(this,6,a)};u.oE=function(){return lk(this,6)};function ZDs(a){zm.call(this,"saep");this.D=new YDs(a)}z(ZDs,vCs);ZDs.prototype.C=n("D");function $Ds(a){Q(this,a,"snep",-1,null,null)}A($Ds,O);$Ds.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&N(a,1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,3);null!=b&&a.Ha(3,b);b=R(this,4);null!=b&&a.pb(4,b);return L(a)};$Ds.messageId="snep";u=$Ds.prototype;u.getType=function(){return ok(this,1,0)};u.Kb=function(a){return T(this,1,a)};u.Cd=function(){tk(this,1)};u.vd=function(){return lk(this,1)};u.Sc=function(){return R(this,2)};u.Gk=function(){return lk(this,2)};
u.getTitle=function(){return R(this,3)};u.setTitle=function(a){return T(this,3,a)};function aEs(a){zm.call(this,"snep");this.D=new $Ds(a)}z(aEs,vCs);aEs.prototype.C=n("D");function bEs(a){Q(this,a,"spep",-1,cEs,null)}A(bEs,O);var cEs=[4];bEs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,3);null!=b&&a.Ha(3,b);b=R(this,4);0<b.length&&dk(a,4,b);b=R(this,5);null!=b&&M(a,5,b);b=R(this,6);null!=b&&M(a,6,b);b=R(this,7);null!=b&&a.Ha(7,b);return L(a)};bEs.messageId="spep";bEs.prototype.getTitle=function(){return R(this,2)};bEs.prototype.setTitle=function(a){return T(this,2,a)};
bEs.prototype.jj=function(a,b){return Bk(this,4,a,b)};function dEs(a){zm.call(this,"spep");this.D=new bEs(a)}z(dEs,vCs);dEs.prototype.C=n("D");function eEs(a){Q(this,a,"stbep",-1,null,null)}A(eEs,O);eEs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&a.Ha(2,b);b=R(this,3);null!=b&&a.Ha(3,b);b=R(this,4);null!=b&&a.Ha(4,b);b=R(this,5);null!=b&&a.Ha(5,b);b=R(this,6);null!=b&&a.Ha(6,b);return L(a)};eEs.messageId="stbep";u=eEs.prototype;u.getFunctionName=function(){return R(this,2)};u.Fl=function(){return R(this,3)};u.Kr=function(a){T(this,3,a)};u.getUrl=function(){return R(this,5)};
u.xB=function(){return R(this,6)};function fEs(a){zm.call(this,"stbep");this.D=new eEs(a)}z(fEs,vCs);fEs.prototype.C=n("D");function gEs(a){Q(this,a,"sttep",-1,null,null)}A(gEs,O);gEs.prototype.Ba=function(){var a=new K;var b=R(this,1);null!=b&&a.Ha(1,b);b=R(this,2);null!=b&&a.Ha(2,b);return L(a)};gEs.messageId="sttep";gEs.prototype.Sc=function(){return R(this,1)};gEs.prototype.Gk=function(){return lk(this,1)};gEs.prototype.Fr=function(){return R(this,2)};gEs.prototype.eh=function(a){T(this,2,a)};function hEs(a){zm.call(this,"sttep");this.D=new gEs(a)}z(hEs,vCs);hEs.prototype.C=n("D");function iEs(){Im.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new wCs(b);a.dispatchEvent(b);break;case "paep":b=new ODs(b);a.dispatchEvent(b);break;case "rfep":b=new RDs(b);a.dispatchEvent(b);break;case "sfep":b=new TDs(b);a.dispatchEvent(b);break;case "step":b=new VDs(b);a.dispatchEvent(b);break;case "saep":b=new ZDs(b);a.dispatchEvent(b);break;case "snep":b=new aEs(b);a.dispatchEvent(b);break;case "spep":b=new dEs(b);a.dispatchEvent(b);break;case "stbep":b=new fEs(b);
a.dispatchEvent(b);break;case "sttep":b=new hEs(b);a.dispatchEvent(b);break;case "scpep":b=new XDs(b),a.dispatchEvent(b)}}}z(iEs,Im);iEs.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};iEs.prototype.Wa=function(){this.C&&this.C.unsubscribe("13",this.D);Im.prototype.Wa.call(this)};function jEs(a,b){Im.call(this);this.D=new Lm(this);this.Ca(this.D);this.C={};this.F=a;this.H=b}z(jEs,Im);u=jEs.prototype;u.start=function(){this.D.listen(this.H,"sfep",ua(this.kyb,this));this.D.listen(this.H,"step",ua(this.dmc,this))};function kEs(a,b,c,d){var e=void 0;e=void 0===e?pa:e;d=void 0===d?pa:d;d=ua(a.cmc,a,b,e,d);a=a.F;b=["ruid",ta({}),a.C.C,a.D,a.C.H,b,a.C.X,c];b=Go(Wl(Ko(gDs(a,a.C.Fa),"POST"),2),b).bC();d&&(Yl(b,ua(a.amc,a,d)),Xl(b,ua(a.L4c,a,d)));b.Di()}
u.bmc=function(a,b,c,d,e,f){f.IB()?(a=R(f,2),this.C[a]=new lEs(a,b,d,e),c(a,rk(f,3,!1))):(b=new SDs,T(b,2,6),e(b))};u.cmc=function(a,b,c,d){d.IB()?b():(c(),b=new SDs,T(b,1,a),T(b,2,6),this.kyb(new TDs(b.Lc())))};u.dmc=function(a){a=a.C();var b=R(a,1);if(Ng(this.C,b)){var c=lja(this.C,b);(0,c.emc)(a);c.dispose();Qg(this.C,b)}};u.kyb=function(a){a=a.C();var b=R(a,1);if(Ng(this.C,b)){var c=lja(this.C,b);(0,c.xBc)(a);c.dispose();Qg(this.C,b)}a="Google Apps Script: "+a.Tj();window.console.log(a)};
u.Wa=function(){ii(this.C);Im.prototype.Wa.call(this)};function lEs(a,b,c,d){ji.call(this);this.C=b;this.emc=c;this.xBc=d}z(lEs,ji);lEs.prototype.getFunctionName=n("C");function mEs(a){var b=a.g5,c=a.id,d=a.nad,e=a.qGa,f=a.Fxc,h=a.Cla,k=a.D7a;return zq('<div class="'+V(a.pD)+'" aria-labelledby="title'+V(c)+'" tabindex="0"'+(b?' role="complementary"':' role="region"')+'><div class="'+V(d)+'"><div class="'+V(e)+'" id="title'+V(c)+'"></div><div class="'+V(f)+'" tabindex="0" title="'+V("Close sidebar")+'" aria-label="'+V("Close sidebar")+'" role="button">'+Gt(k)+'</div></div><div class="'+V(h)+'"></div></div>')}
function nEs(a){a=a.caption;return zq('<div class="'+V("docs-script-button-bar-text")+" "+V("docs-titlebar-button")+" "+V("goog-inline-block")+'" tabindex="0">'+yq(a)+"</div>")}function oEs(a){a=a.text;return zq('<div class="'+V("docs-script-button-bar-bubble-content")+'">'+yq(a)+"</div>")}
function pEs(a){var b=a.iconName,c=a.title;a=a.description;return zq('<div class="'+V("script-promo-menu-item-content")+'"><div class="'+V("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+V(b)+'.svg"/></div><div class="'+V("script-promo-menu-item-text")+'"><div class="'+V("script-promo-menu-item-title")+'">'+yq(c)+'</div><div class="'+V("script-promo-menu-item-description")+'">'+yq(a)+"</div></div></div>")}
function qEs(a){var b=a.functionName;a=a.rnb;return zq('<div class="'+V("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+V("goog-inline-block")+" "+V("func-entry-rb")+'">&nbsp;</div><div class="'+V("goog-inline-block")+" "+V("func-entry-func")+'">'+yq(b)+'</div><div class="'+V("goog-inline-block")+" "+V("func-entry-lib")+'">'+yq(a)+"</div></div>")}
function rEs(a){var b=a.ids,c=a.description;a=a.Vbd;var d='<div class="'+V("script-help-dialog-content")+'"><div class="'+V("script-help-dialog-content-left")+" "+V("goog-inline-block")+(a?" "+V("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(d+='<div class="'+V("script-help-dialog-content-section")+" "+V("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+V("script-help-dialog-content-title")+'">'+zq('<div class="'+(V("script-help-dialog-content-title-caution-icon")+
'"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'))+
"<span>",d+="Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>"):(d+='<div class="'+V("script-help-dialog-content-section")+'" tabindex="0"><div class="'+V("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(yq(c)+"</div></div>"));d+='</div><div id="'+V(b.RHa)+'" class="'+V("script-help-dialog-buttons")+" "+V("goog-inline-block")+'"></div></div>';return zq(d)}
function sEs(a){var b=a.iBc;a='<p class="'+V("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(yq(b)+"</strong>:");a=a+c+('</p><textarea class="'+V("jfk-textinput")+" "+V("script-reportissue-dialog-description")+'"></textarea><p class="'+V("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(V("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+V("script-reportissue-dialog-nonanonymous-control")+" "+V("goog-inline-block")+'"><div class="'+V("script-reportissue-dialog-nonanonymous-checkbox")+" "+V("jfk-checkbox")+'"></div></div><div class="'+V("script-reportissue-dialog-nonanonymous-label")+" "+V("goog-inline-block")+'"><div class="'+V("script-reportissue-dialog-nonanonymous-optional-text")+" "+V("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(yq(b)+" </strong>can follow up.");a=a+b+"</div></div>";return zq(a)}
function tEs(a,b){a=a||{};a=a.Bd;var c='<div class="'+V("func-actions")+'">';c+=Gs({id:"func-action-new",content:Kq("New"),style:0},b);c+=Gs({id:"func-action-run",content:Kq("Run"),style:0,Cg:"jfk-button-collapse-right"},b);c+=Gs({id:"func-action-edit",content:Kq("Edit"),style:0,Cg:"jfk-button-collapse-left"},b);c+=Gs({id:"func-action-reload",content:Kq(""+Gt(a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload")),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+V("func-header")+
'"><div class="'+V("func-header-rb")+" "+V("goog-inline-block")+'"></div><div class="'+V("func-header-func")+" "+V("goog-inline-block")+'">';c=c+'Function</div><div class="'+(V("func-header-lib")+" "+V("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(V("func-entries")+'" role="radiogroup" tabindex="0"></div>');return zq(c)}function uEs(){var a='<div class="'+V("func-loading")+'">';return zq(a+"Fetching scripts\u2026</div>")}
function vEs(){var a='<div class="'+V("func-none")+'">';return zq(a+"No scripts found</div>")};function wEs(){}z(wEs,Lr);wEs.prototype.zd=q("func-entry");wEs.prototype.Rl=q(!1);wEs.prototype.Ia=function(a){return xq(qEs,{functionName:a.getFunctionName(),rnb:a.bdd},void 0,a.Da())};qa(wEs);function xEs(a,b,c,d,e,f){Or.call(this,null,d||wEs.qb(),e);this.PPb=a;this.D=void 0!==f?f:null;this.bdd=b;this.C=c;this.Wj(16,!0);this.Wj(32,!0);Qr(this,16,!0);Pr(this,16,!1)}z(xEs,Or);xEs.prototype.Oz=function(a){Or.prototype.Oz.call(this,a);a&&this.getElement()&&this.getElement().focus()};xEs.prototype.xB=n("D");xEs.prototype.getFunctionName=n("C");xEs.prototype.Ed=function(a){Or.prototype.Ed.call(this,a);this.Wc(a);this.getElement()&&mn(this.getElement(),a)};function yEs(a,b){xt.call(this,void 0,void 0,a);this.R=b||!1;this.OD=new gOb;this.Ca(this.OD);this.Hh=new Jr;this.Ca(this.Hh);this.H=new Hs("");this.Ca(this.H);this.C=new Hs("");this.Ca(this.C);this.F=new Hs("");this.Ca(this.F);this.O=new Hs("");this.Ca(this.O);a=new ur(a);a.set("close","Close",!1,!0);tr(this,!1);wr(this,a);this.setTitle("Script manager")}z(yEs,xt);u=yEs.prototype;
u.reset=function(a){this.OD.clear();this.Te(!0);0===a?(a=xq(uEs,{},void 0,this.Da()),a=new Or(a),a.Wj(32,!1),this.Pa(a,!0)):1===a&&(a=xq(vEs,{},void 0,this.Da()),a=new Or(a),a.Wj(32,!1),this.Pa(a,!0))};u.focus=function(){if(this.Dc()&&0<this.OD.Dm()){var a=this.OD.bj();a&&a.Oz(!0)}else xt.prototype.focus.call(this)};u.Te=function(a){a=xt.prototype.Te.call(this,a);this.OD.clear();zEs(this);return a};
u.Dj=function(a,b,c){xt.prototype.Dj.call(this,a,b,c);a instanceof xEs&&(b=a.Le(),this.OD.Me(a),1==this.OD.Dm()||b)&&(jOb(this.OD,a),a.Oz(!0));zEs(this)};u.Ia=function(){xt.prototype.Ia.call(this);var a=this.Ec();br(a,"script-explorer-contents");vq(a,tEs,{Bd:this.R});a=gn(lmb(a));this.H.ub(a[0]);this.F.ub(a[1]);this.C.ub(a[2]);this.O.ub(a[3]);Br(this,"run")};
u.Qa=function(){xt.prototype.Qa.call(this);this.Hh.Zj(this.Ec());zEs(this);this.addEventListener("dialogselect",Wg(!0));Bm(this,"action",this.KLb,void 0,this);Bm(this.Hh,"key",this.mMb,void 0,this);var a=new pLb("new",this.H.getContent());Bm(this.H,"action",ua(this.dispatchEvent,this,a));a=new pLb("run",this.F.getContent());Bm(this.F,"action",ua(this.dispatchEvent,this,a));a=new pLb("edit",this.C.getContent());Bm(this.C,"action",ua(this.dispatchEvent,this,a));a=new pLb("reload",this.O.getContent());
Bm(this.O,"action",ua(this.dispatchEvent,this,a))};u.Yf=function(){xt.prototype.Yf.call(this);this.Hh.detach();Em(this,"action",this.KLb,void 0,this);Em(this.Hh,"key",this.mMb,void 0,this);Hm(this.H);Hm(this.F);Hm(this.C);Hm(this.O)};u.Ec=function(){var a=xt.prototype.Ec.call(this),b=gn(a);return 0<b.length?b[2]:a};u.KLb=function(a){zEs(this);a.target instanceof xEs&&(jOb(this.OD,a.target),a.target.Oz(!0))};
u.mMb=function(a){var b=this.OD.Dm();if(0<b)switch(a.keyCode){case 38:this.OD.Wi(Vib(this.OD.ao()-1,b));a.preventDefault();this.focus();break;case 40:this.OD.Wi(Vib(this.OD.ao()+1,b)),a.preventDefault(),this.focus()}};function zEs(a){var b=!!a.OD.bj();a.F.setVisible(b);a.C.setVisible(b)};function AEs(a,b){this.D=a;this.C=b}function BEs(a){a.D.H&&lDs(a.C,function(){if(wp("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.Cha();var b=a.D.ma;if(b&&(b=a.C.getExtension(new zCs(b))||GDs(a.C,b))){var c=a.C,d=c.C.R;d&&(tDs(c.C),c=ua(c.C.Y8,c.C),CEs(d,T9(b),c))}}})};function DEs(){ji.call(this);this.F=new im}z(DEs,Ys);DEs.prototype.C=function(){return this.F.Ag()};function zDs(a,b){a.F.set(b.getId(),b)}DEs.prototype.Fd=function(){this.F.clear()};function yDs(a,b){mq.call(this,b);this.C=a}z(yDs,mq);
yDs.prototype.Ia=function(){mq.prototype.Ia.call(this);var a=this.C==(Is(),hRb)?"Do more with Docs":this.C==(Is(),lRb)?"Do more with Forms":this.C==(Is(),iRb)?"Do more with Sheets":this.C==(Is(),jRb)?"Do more with Slides":"Do more with Docs",b=this.C==(Is(),hRb)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Is(),lRb)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Is(),iRb)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Is(),jRb)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Is(),hRb)?"addon_docs_promo":this.C==(Is(),lRb)?"addon_forms_promo":this.C==(Is(),iRb)?"addon_sheets_promo":this.C==(Is(),jRb)?"addon_slides_promo":"addon_docs_promo",d=this.Da();this.Sd(xq(pEs,{title:a,description:b,iconName:c},void 0,d))};function EEs(){}z(EEs,Yr);EEs.prototype.Ia=function(a){a=Yr.prototype.Ia.call(this,a);Tq(a,"menuitem");return a};EEs.prototype.zd=q("goog-control");EEs.prototype.Lx=function(a){a=Yr.prototype.Lx.call(this,a);a.push("menu-button","goog-inline-block");return a};qa(EEs);function FEs(a,b,c,d,e){ji.call(this);this.R=b;this.V=c;this.D=a;this.H={};this.Aa={};this.oa={};this.ma=[];this.X=[];this.F=d||null;this.O=e||null;this.C=new DEs;this.J=new DEs;this.Fa=new Lm;this.Ca(this.Fa);this.Ga=[]}z(FEs,ji);FEs.prototype.Wa=function(){ii(this.H);ji.prototype.Wa.call(this)};FEs.prototype.PQ=function(a){return Ng(this.H,a)};
function GEs(a,b,c){c=c?[c]:Ig(a.H);for(var d=0;d<c.length;d++)for(var e=c[d].Hc(),f=0;f<e.yd();f++){var h=e.Ld(f);if(h instanceof as&&h.getId()==b||h instanceof hs&&(h=GEs(a,b,h)))return h}return null}
function HEs(a,b,c,d,e){if(R(b,3)){var f=nk(b,7)||!1,h=b.Fl(),k=R(b,10),l=new as("");l.$c(b.Qh()||String(ta(l)));var m=[bn(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=ePb(l,wp("macros-exec"),[d]),a.ma.push(d),m.push(d));l.setContent(m);b=new qCs(R(b,4),R(b,3),void 0,R(b,9)||void 0,void 0,b.xB()||void 0);vs(a.R,l,wp("macros-exec"),null,Wg(b),ICs(3,e));l.Ya(f);a.O&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.O.wC(wp("macros-exec"),[b],Wg(e),Wg(e))[0]));return l}if(!b.Fl())return new ds;if(0<b.Em().length){l=
new es;f=b.Em();for(h=0;h<f.length;h++)l.Pa(HEs(a,f[h],c,d,e),!0);a=new hs(b.Fl());a.$c(b.Qh()||String(ta(a)));a.Ah(l);DDs(l.Ua(),!0);return a}throw Error("Unsupported menu item type.");}FEs.prototype.Ka=function(a,b){return kg(a.getName(),b.getName())};function CDs(a,b,c,d,e){if(b.ARa()){var f=new rCs,h=String(ta(f));T(f,1,h);b.Pa(HEs(a,f,d),!0)}d=new as("Help");d.$c(String(ta(d)));vs(a.R,d,wp("macros-extension-help"),null,Wg(c),ICs(3,e));d.Ya(!0);b.Pa(d,!0)}
function BDs(a,b,c){var d=new as("");d.$c("addon-menu-install-"+T9(c));vs(a.R,d,wp("macros-extension-install-start"),kPb,Wg(T9(c)),ICs(3,c));d.Ya(!0);b.Pa(d,!0)}function ADs(a){PTb(a.F,"docs-macros-extension-promo")||$s(a.F,"docs-macros-extension-promo",[a.J,null]);PTb(a.F,"docs-macros-extensions")||$s(a.F,"docs-macros-extensions",[a.C]);a.F.Hc("docs-extensions-menu",!0);hu()&&a.F.Hc("macros-extension-add-ons-menu",!0)}
function CEs(a,b,c){var d=c||pa;(c=a.C.F.get(b))?-1===a.Ga.indexOf(b)?(b=Xn(ua(function(e){e.dispatchEvent("load")},a,c),1E4),b=ua(function(e,f,h){this.D.bIa("docs-extensions-menu");e.Sk(!0);e.g_();Yn(h);f()},a,c,d,b),a.Fa.$d(c,"load",b)):(a.D.bIa("docs-extensions-menu"),c.C1(),c.Sk(!0),c.g_(),d()):d()}function DDs(a,b){hu()&&(br(a,"ia-menu"),b||br(a,"ia-primary-menu"))};function IEs(a,b){var c=a.D7a,d=a.g5;a='<div class="'+V(a.pD)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+V("addon-sidebar-header")+'"><div class="'+V("addon-sidebar-title")+'" id="addon-sidebar-title">';a=a+"Document add-ons</div>"+(Gs({Cg:"addon-sidebar-close docs-material",content:Kq(""+Gt(c)),style:4,title:"Close sidebar"},b)+'</div><div class="'+V("addon-sidebar-content")+'"><div class="'+V("addon-sidebar-banner")+'"></div><div class="'+
V("addon-sidebar-introduction")+'"></div></div><div class="'+V("addon-sidebar-empty-caption")+'"><div class="'+V("addon-sidebar-empty-title")+'">');a=a+'No document add-ons</div><div class="'+(V("addon-sidebar-empty-description")+'">');return zq(a+"This document doesn't include any add-ons</div></div></div>")}
function JEs(a){var b=a.Lvc;a=a.Ivc;return zq('<img class="'+V("addon-sidebar-banner-image")+'" src='+HJb(Oq(b))+" alt="+HJb(a)+' /><div class="'+V("addon-sidebar-banner-image-overlay")+'"></div>')};function KEs(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled;a=a.Jsd;return zq('<div class="'+V("addon-sidebar-card")+'" aria-label="'+V(c)+'" tabindex="0" role="region"><div class="'+V("addon-sidebar-card-header")+'"><div class="'+V("addon-sidebar-card-icon")+'">'+(b?'<img class="'+V("addon-sidebar-card-icon-image")+'" src='+HJb(Oq(b))+" alt="+HJb(c)+" />":"")+'</div><div class="'+V("addon-sidebar-card-header-content")+'"><div class="'+V("addon-sidebar-card-title")+'"><div class="'+
V("addon-sidebar-card-title-caption")+(a?" "+V("addon-sidebar-card-two-line-title-caption"):"")+'">'+yq(c)+"</div>"+(f?zq('<div class="'+(V("addon-sidebar-card-check")+'"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="')+V("#455A64")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>'):"")+'</div><div class="'+
V("addon-sidebar-card-category")+'">'+yq(d)+"</div></div></div>"+(e?'<div class="'+V("addon-sidebar-card-summary")+'">'+yq(e)+"</div>":"")+"</div>")};function LEs(){}z(LEs,Av);LEs.prototype.zd=q("docs-material-menu-button-flat-primary");LEs.prototype.tx=function(){return xq(vod,{className:"docs-material-menu-button-flat-primary-dropdown"})};qa(LEs);function MEs(a,b,c,d,e){c=void 0===c?LEs.qb():c;ls.call(this,a,b,c,d,e)}z(MEs,ls);function NEs(){}z(NEs,Av);NEs.prototype.zd=q("docs-material-menu-button-raised-primary");NEs.prototype.tx=function(){return xq(vod,{className:"docs-material-menu-button-raised-primary-dropdown"})};qa(NEs);function OEs(a,b,c,d,e){c=void 0===c?NEs.qb():c;ls.call(this,a,b,c,d,e)}z(OEs,ls);function PEs(a,b,c,d,e){ji.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.Db=e||Qm()}z(PEs,ji);
function QEs(a,b){if(!b)return REs(a);b=b.Em();if(1==b.length&&R(b[0],3)){var c=REs(a);b=b[0];c.Ya(!!nk(b,7));b=new qCs(R(b,4),R(b,3),void 0,R(b,9)||void 0);vs(a.D,c,wp("macros-exec"),{enabled:!0},Wg(b),a.F);return c}c=new es(a.Db);for(var d=0;d<b.length;d++)c.Pa(SEs(a,b[d]),!0);b=[bn("Use")];a=a.C?new OEs(b,c,void 0,a.Db):new MEs(b,c,void 0,a.Db);a.dh("Use");a.ld("addon-sidebar-card-menu-button");a.Ya(!0);return a}
function SEs(a,b){if(R(b,3)){var c=b.Fl(),d=new as("");d.ld(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([bn(c)]);c=new qCs(R(b,4),R(b,3),void 0,R(b,9)||void 0);vs(a.D,d,wp("macros-exec"),{enabled:!0},Wg(c),a.F);d.Ya(!!nk(b,7));return d}if(!b.Fl())return new ds;if(0<b.Em().length){d=new es(a.Db);c=b.Em();for(var e=0;e<c.length;e++)d.Pa(SEs(a,c[e]),!0);b=new hs(b.Fl());b.ld(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.Ah(d);return b}throw Error("Unsupported menu item type.");}function REs(a){var b=[bn("Use")];a=a.C?new s9k(b,a.Db):new Xz(b,a.Db);a.dh("Use");a.ld("addon-sidebar-card-button");a.Ya(!1);return a};function TEs(a,b,c,d,e){mq.call(this,e);this.C=a;this.ma=b;this.V=nk(this.C,19)||!1;this.H=!(!nk(this.C,10)&&!nk(this.C,9));this.O=new us(void 0,void 0,!0,St.qb());this.Ca(this.O);this.X=ICs(10,this.C);this.J=new Or(void 0,void 0,e);this.Ca(this.J);this.F=new PEs(this.O,c,this.X,d,e);this.Ca(this.F);if(this.H)a=QEs(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Is(),hRb:c="Add to Docs";break a;case Is(),jRb:c="Add to Slides";break a;case Is(),iRb:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[bn(c)];d=a.C?new s9k(d,a.Db):new Xz(d,a.Db);d.dh(c);d.ld("addon-sidebar-card-button");d.Ya(!1);vs(a.D,d,wp("macros-extension-install-start"),{enabled:!0},Wg(T9(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new Xz([bn("Help")],a.Db);c.dh("Help");c.ld("addon-sidebar-card-button");c.Ya(!1);c.eh("Help");vs(a.D,c,wp("macros-extension-help"),{enabled:!0},Wg(T9(b)),a.F);this.R=c}z(TEs,mq);
TEs.prototype.Ia=function(){mq.prototype.Ia.call(this);var a=R(this.C,15)||"";a&&(a=tm(new sm(a),"https").toString());var b=this.Da();a={icon:a,title:this.C.getName(),category:this.C.Gq(),isInstalled:this.H,summary:R(this.C,14),Jsd:Rh};b=xq(KEs,a,void 0,b);this.Ob(b);this.Sd(b)};TEs.prototype.Sd=function(a){mq.prototype.Sd.call(this,a);a=this.Ja("addon-sidebar-card-title-caption");Tq(a,"button");this.Pa(this.J);this.J.ub(a)};
TEs.prototype.Qa=function(){mq.prototype.Qa.call(this);vs(this.O,this.J,wp("macros-manage-extensions"),{},Wg(BCs(this.C)),this.X);UEs(this);!this.H&&this.V&&(this.Pa(this.R,!0),this.R.Ya(!0))};TEs.prototype.Wa=function(){hi(this.D);hi(this.R);mq.prototype.Wa.call(this)};function VEs(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),hi(a.D),a.D=QEs(a.F,b),a.Dc()&&UEs(a))}
function UEs(a){a.Pa(a.D,!0);a.H||(a.D.Ya(a.ma&&!a.V),a.ma?a.V&&a.D.eh("Add-on not available in G Suite Marketplace"):a.D.eh("Disabled for your organization"))};function WEs(a,b,c){BX.call(this,c);this.D={};this.C=[];this.V=!1;this.H=a;this.ma=b;this.J={};this.F=new kjd(this.Da(),"addon-sidebar-spinner");this.Pa(this.F);this.R=new Hs(void 0,this.Da());this.O=this.X=!1}z(WEs,BX);u=WEs.prototype;u.Ia=function(){BX.prototype.Ia.call(this);var a={pD:"addon-sidebar",D7a:ip("close-white"),g5:nf(pf(),"docs-eal")};a=xq(IEs,a,void 0,this.Da());this.Ob(a);this.Sd(a)};
u.Sd=function(a){BX.prototype.Sd.call(this,a);this.F.render(this.Ec());a=this.F.Ua();Zq(a,"Loading");Tq(a,"status");Wq(a,"live","polite")};u.Qa=function(){BX.prototype.Qa.call(this);XEs(this,!1);YEs(this,!1);this.R.ub(this.Ja("addon-sidebar-close"));this.getHandler().Ki(this.R.Ua(),Dm,ua(this.lyb,this)).listen(this.getElement(),"keyup",this.u7c);this.X&&FDs(this)};u.Ec=function(){return this.Bb("addon-sidebar-content")};
function FDs(a){a.F.setVisible(!1);YEs(a,a.H);XEs(a,0==a.C.length);ZEs(a,a.O);$Es(a);wf(a.C,function(b){var c=T9(b);b=new TEs(b,this.V,this.O,this.ma,this.Da());VEs(b,this.J[c]);this.Pa(b,!0);this.D[c]=b},a)}function $Es(a){zg(a.D,function(b){this.removeChild(b,!0);hi(b)},a);kja(a.D)}function XEs(a,b){if(a.Dc()){var c=a.Ja("addon-sidebar-empty-caption");gq(c,b)}b&&YEs(a,!1)}
function YEs(a,b){if(a.Dc()){var c=a.Ja("addon-sidebar-introduction");b&&!pn(c)&&ln(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");gq(c,b)}}function EDs(a){return 0==a.C.length?null:(a=R(a.C[0],16)||R(a.C[0],17))?tm(new sm(a),"https").toString():null}
function ZEs(a,b){if(a.Dc()){fr(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Ja("addon-sidebar-banner");b?(b=EDs(a))&&vq(c,JEs,{Lvc:b,Ivc:a.C[0].getName()}):en(c)}}u.jBc=function(a,b){return kg(a.getName(),b.getName())};u.u7c=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.lyb(),a.stopPropagation())};u.lyb=function(){this.setVisible(!1);YEs(this,!1);this.H=!1;wp("docs-focus-editor").Nb()};u.Rl=q(!1);function aFs(a,b){EX.call(this,a,b)}z(aFs,EX);aFs.prototype.qv=function(){return wp("macros-addon-sidebar-focus")};aFs.prototype.Ej=function(){return wp("macros-addon-sidebar")};aFs.prototype.gz=function(a){var b=this.wd;b.Dc()||b.render();EX.prototype.gz.call(this,a)};aFs.prototype.a_b=function(a){a&&this.Ej().isVisible()&&this.gz(!0)};function bFs(a,b,c){this.C=a;this.F=b;this.D=c;Object.defineProperties(this,{path:{get:ua(this.fmc,this),set:ua(this.cod,this)},invoke:{get:ua(this.LHc,this),set:ua(this.Vnd,this)},arity:{get:ua(this.DCc,this),set:ua(this.And,this)}})}u=bFs.prototype;u.fmc=n("C");u.cod=ba("C");u.LHc=n("F");u.Vnd=ba("F");u.DCc=n("D");u.And=ba("D");function cFs(a,b,c,d,e){mq.call(this,e);this.O=a;this.D=b;this.J=c;this.C=d}z(cFs,mq);
cFs.prototype.Ia=function(){var a=rf(pf(),"docs-tfh"),b=this.O;a&&(b=gka(b,{allow_parent:a}));a=PKb(this.Da());rh(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.Ob(a);na("payload",this.D,a);na("adapter.hostFunctions",this.J,
a);Qaa("adapter.getSessionId",ua(this.H,this),a);Qaa("adapter.getState",ua(this.F,this),a)};cFs.prototype.Rl=q(!1);cFs.prototype.H=function(){var a=this.C().C;return null!==a?String(a):null};cFs.prototype.F=function(){return this.C().getState()};function dFs(a,b,c,d,e,f,h,k,l){xt.call(this,void 0,void 0,l);var m=ua(this.setVisible,this,!1),p=ua(this.H,this),r=ua(this.F,this);e&&this.setTitle(e);this.Al=f||500;this.Ii=h||300;this.C=new cFs(a,b,[new bFs("google.script.host.close",m,0),new bFs("google.script.host.closeDialog",m,0),new bFs("google.script.host.editor.focus",ua(d.Mc,d,3),0),new bFs("google.script.host.setWidth",p,1),new bFs("google.script.host.setHeight",r,1)],c,l);this.Pa(this.C);tr(this,!!k);wr(this,null)}z(dFs,xt);
dFs.prototype.H=function(a){!isFinite(a)||0>a||bq(this.Ec(),Math.min(a,Math.floor(.8*Xm().width)))};dFs.prototype.F=function(a){!isFinite(a)||0>a||cq(this.Ec(),Math.min(a,Math.floor(.8*Xm().height)))};dFs.prototype.Ia=function(){xt.prototype.Ia.call(this);br(this.getElement(),"script-app-dialog");var a=this.Ec();br(a,"script-app-contents");bq(a,Math.min(this.Al,Math.floor(.8*Xm().width)));cq(a,Math.min(this.Ii,Math.floor(.8*Xm().height)));this.C.render(a)};dFs.prototype.Rl=q(!1);function eFs(a){BX.call(this,a);this.C=this.D=this.F=this.H=null}z(eFs,BX);u=eFs.prototype;u.NKa=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};u.focus=function(){this.C.getElement().focus()};u.Ec=n("D");
u.Ia=function(){var a=this.Da(),b={id:this.getId(),pD:"script-application-sidebar",nad:"script-application-sidebar-header",qGa:"script-application-sidebar-title",Fxc:"script-application-sidebar-close",Cla:"script-application-sidebar-content",D7a:ip("close-white"),g5:nf(pf(),"docs-eal")};b=xq(mEs,b,void 0,a);this.Ob(b);this.H=a.Bb("script-application-sidebar-title",b);this.F=a.Bb("script-application-sidebar-close",b);this.D=a.Bb("script-application-sidebar-content",b)};
u.Qa=function(){BX.prototype.Qa.call(this);this.getHandler().Ki(this.F,Dm,ua(this.NKa,this))};u.Rl=q(!1);u.Wa=function(){delete this.H;delete this.F;delete this.D;delete this.C;BX.prototype.Wa.call(this)};function fFs(a,b){EX.call(this,a,b)}z(fFs,EX);fFs.prototype.qv=function(){return wp("macros-application-focus")};fFs.prototype.Ej=function(){return wp("macros-application-sidebar")};function gFs(a,b){var c=null;c=c||rq("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});sh(c.location,a);b!=pa&&(a=new Rgd(function(){return c?c.closed:!0}),a.eL=b,a.start(100,-1))};function hFs(a,b,c,d,e){xt.call(this,void 0,!0,c);this.H=a;this.F=d||pa;rr(this,b);this.setVisible(!0);this.Vo=!0;vr(this,!1);wr(this,(new ur).jj(wLb,!0).jj(yr,!1,!0));this.setTitle(e||"Authorization Required");Br(this,wLb.key)}z(hFs,xt);hFs.prototype.Qa=function(){xt.prototype.Qa.call(this);this.addEventListener("dialogselect",this.C)};hFs.prototype.Yf=function(){xt.prototype.Yf.call(this);this.removeEventListener("dialogselect",this.C)};
hFs.prototype.C=function(a){"cancel"!=a.key?gFs(this.H,this.F):this.F();this.setVisible(!1)};function iFs(a){xt.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Vo=!0;this.setTitle("Message details");wr(this,xLb())}z(iFs,xt);iFs.prototype.Ia=function(){xt.prototype.Ia.call(this);var a=this.Ec();br(a,"script-error-dialog-content");this.C=bn(this.F);a.appendChild(this.C)};iFs.prototype.Wa=function(){xt.prototype.Wa.call(this);this.C&&fn(this.C)};function jFs(a){ji.call(this);this.C=a}z(jFs,ji);function kFs(a,b){var c=vg("Running script ");c=$m("SPAN",null,c);b=b?Ms(c,"Cancel",b,"info",!0):Ls(c,"info",!0);a.C.postMessage(b);return b.getId()}function lFs(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(xh(b)+" experienced an error");b=$m("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Ms([b],"Details",function(){(new iFs(d)).setVisible(!0)},"warning",!0))}jFs.prototype.Wa=function(){delete this.C};function mFs(){ji.call(this);this.C=null;this.D=new Lm;this.Ca(this.D)}z(mFs,ji);mFs.prototype.Wa=function(){nFs();oFs(this);ji.prototype.Wa.call(this)};function oFs(a){a.D.Fd();a.C&&(a.C.dispose(),a.C=null);nFs()}function nFs(){var a=Tm("docs-script-button-bar");a&&en(a)};var pFs=new eMc(["http","https"]);function qFs(a){a=Eh(a);if(sg(a)||wg(a,'"'))return null;var b=qjb(1,a);return b?pFs.contains(b.toLowerCase())?a:null:null};function rFs(a,b,c,d,e,f,h){h=void 0===h?!1:h;xt.call(this);this.qp=sg(Eh(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.oa=d;this.H=qFs(e);this.X=qFs(f);this.O=h;this.V=KIb(this,sFs);this.C=X6j("Learn more");this.Pa(this.C);this.F=new Hs("Report an issue");this.Pa(this.F);this.R=new Hs("View in store");this.Pa(this.R);this.setTitle(vg("Help for "+a));a=new ur;a.jj({key:yr.key,caption:"Close"},!1,!0);wr(this,a);Br(this,"ok")}z(rFs,xt);u=rFs.prototype;
u.Ia=function(){xt.prototype.Ia.call(this);var a=this.Ec();vq(a,rEs,{description:this.qp,ids:this.V,Vbd:this.O});br(a,"script-help-dialog")};
u.Qa=function(){xt.prototype.Qa.call(this);var a=this.Da().getElement(this.V.RHa);this.O?(this.F.render(a),this.getHandler().listen(this.F,"action",this.cNb),this.C.render(a),this.getHandler().listen(this.C,"action",this.myb)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.myb)),this.F.render(a),this.getHandler().listen(this.F,"action",this.cNb),this.R.render(a),this.getHandler().listen(this.R,"action",this.a$c))};
u.myb=function(){this.O?rq("https://support.google.com/docs?p=GSM_migration"):this.H&&rq(this.H)};u.cNb=function(){this.X?rq(this.X):(this.ma(),this.dispose())};u.a$c=function(){this.oa();this.dispose()};var sFs={RHa:"script-help-dialog-buttonbar"};function tFs(a,b,c,d){zm.call(this,"Yl");this.title=d}z(tFs,zm);function uFs(a,b,c,d,e,f){xt.call(this,void 0,void 0,f);this.H=b;this.F=d;this.O=e;this.C=null;this.setTitle(a);tr(this,!0);a=new ur(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,vFs[d]);a.D="0";wr(this,a)}z(uFs,xt);u=uFs.prototype;u.Ia=function(){xt.prototype.Ia.call(this);var a=this.Da(),b=this.Ec();br(b,"script-prompt-contents");for(var c=a.Ia("DIV"),d=this.H.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ia("BR")),c.appendChild(wn(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ia("INPUT"),b.appendChild(this.C))};
u.Rl=q(!1);u.Qa=function(){xt.prototype.Qa.call(this);this.getHandler().listen(this,"dialogselect",ua(this.gmc,this))};u.focus=function(){xt.prototype.focus.call(this);this.C&&this.C.focus()};u.gmc=function(a){this.O(Number(a.key),this.F?this.C.value:null)};var vFs={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function wFs(a,b){xt.call(this);this.H=a;this.F=b;wr(this,(new ur).jj({key:"send",caption:"Send"},!0).jj({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new zs;this.Pa(this.C)}z(wFs,xt);u=wFs.prototype;u.Ia=function(){xt.prototype.Ia.call(this);Br(this,"send");var a=this.Ec();br(a,"script-reportissue-dialog-content");vq(a,sEs,{iBc:this.F})};
u.Qa=function(){xt.prototype.Qa.call(this);this.C.ub(this.Ja("script-reportissue-dialog-nonanonymous-checkbox"));this.V1b();var a=this.getHandler();a.listen(this.Ja("script-reportissue-dialog-description"),"input",this.V1b);a.listen(this,"dialogselect",this.hmc)};u.Hg=function(){return this.Ja("script-reportissue-dialog-description").value};u.V1b=function(){var a=!sg(this.Hg());rLb(this.D,"send",a)};u.hmc=function(a){if("send"!=a.key)return!0;this.H(this.Hg(),this.C.Le());return!0};function xFs(a,b){ji.call(this);this.D={};this.F={};this.O=0;this.J=b;this.C=a;this.C.z4(ua(this.imc,this))}z(xFs,ji);u=xFs.prototype;u.connect=function(a){this.C.isConnected();this.C.connect(a)};u.isConnected=function(){return this.C.isConnected()};u.g_c=function(a,b){var c=yFs(this,b[0]),d=yFs(this,b[1]);b=Zf(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
u.imc=function(a,b){if(gg(a,"callback.")&&Ng(this.D,a)){var c=lja(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(Qg(this.D,d),Qg(this.F,a),Qg(this.F,d));Qg(this.D,a);c.call(this,b)}};function yFs(a,b){return ua(function(c){c=null!=c?Vn(c):null;this.C.send(b,c)},a)}u.Wa=function(){ji.prototype.Wa.call(this);delete this.J;delete this.D;delete this.F;delete this.O;delete this.C};function zFs(a,b,c,d){c=new nsc({role:0,ph:c,cn:"ide.api.ch",tp:1});c.GO=b;xFs.call(this,c,d||5E3);this.H=a;a=ua(this.R,this);this.C.yj("method.getContainerInfo",ua(this.g_c,this,a),!0)}z(zFs,xFs);zFs.prototype.R=function(){return rAk(this.H.call())};zFs.prototype.Wa=function(){var a=this.C;xFs.prototype.Wa.call(this);a.dispose();delete this.H};function AFs(a,b,c,d,e){ji.call(this);this.H=a;this.O=b;this.V=c;this.F=d||null;this.J=e||null;this.C=this.D=null}z(AFs,ji);AFs.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;sh(this.D.location,this.H)}else this.D=rq(this.H,{target:this.O});if(this.J)try{this.C=new zFs(this.J,this.D,this.V),this.C.connect(),Xn(ua(this.R,this,!0),1E5)}catch(a){this.C=null}};
AFs.prototype.R=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};AFs.prototype.close=function(){this.R();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};AFs.prototype.Wa=function(){ji.prototype.Wa.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.O};function BFs(a,b,c,d,e,f,h,k,l){Im.call(this);this.V=[];this.Ga=!!k;this.F=a;this.R=b;this.Ca(this.R);this.Fa=new mFs;this.Ca(this.Fa);this.C=new jFs(Js.qb());this.Ca(this.C);this.D=null;this.oa=new fFs(new eFs,l);this.X=null;e&&(this.X=new aFs(new WEs(f,h),l));this.H=new yEs(void 0,k);this.H.Tg(this);this.Ca(this.H);this.F.Hm(this.H);this.ma=c;this.Aa=d;this.O=this.J=null}z(BFs,Im);function uDs(a){return a.X?a.X.wd:null}u=BFs.prototype;u.Bd=n("Ga");
function CFs(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Ek(e,WCs,4),h=0;h<f.length;h++){var k=f[h];k=new xEs(e.getId(),e.getName(),k.getName());c.Pa(k,!0)}0===c.yd()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function DFs(a,b){var c=Tm("docs-script-button-bar");c&&(en(c),sg(Eh(a))||(a=new Hs(a),a.ld("docs-titlebar-button"),a.render(c),Bm(a,"action",b)))}
function vDs(a,b,c){a.O&&!a.O.isDisposed()&&(sWb(a.F,a.O),a.O.dispose());a.O=new wFs(b,c);a.O.Vo=!0;a.F.Hm(a.O);a.O.setVisible(!0)}
u.Epd=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(yq(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(V(Nq(e))+'" target="_blank">'+(yq(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(V(Nq(e))+'" target="_blank">'+(yq(a)+" help</a>.")),c+=a),c+="</p>");c=zq(c);
Tzk(d,"Report an issue",uq(c),void 0,void 0,"Close")};u.Dpd=function(){Tzk(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function tDs(a){a.dispatchEvent("am")&&(a=a.Aa,a.C.isVisible()&&a.C.hide(),a.D.Dc()||a.D.render(a.F||void 0),a.D.show())}u.Y8=function(){this.dispatchEvent("Xl")&&this.Aa.D.hide()};u.Pjd=function(a,b,c,d,e){a=new AFs(a,"MacroService"+gma(c),b,e,d);this.V.push(a);a.open()};u.cra=function(a){rq(a)};
u.Wa=function(){Im.prototype.Wa.call(this);ii(this.V)};function EFs(a,b,c,d,e,f,h,k,l,m,p,r,t,v,x,G,P,S,X){t=void 0===t?!1:t;v=void 0===v?null:v;P=void 0===P?!1:P;ji.call(this);this.O=a;this.V=l;this.Za=k;this.Aa=m;this.R=b;this.oa=c;this.J=d;this.D=G;this.H=new Lm(this);this.Ca(this.H);this.Ta=p;this.Va=v;this.ma=new jEs(this.oa,this.J);this.Ca(this.ma);this.Ra=P;a=this.Aa;c=this.Ra;t=void 0===t?!1:t;this.C=new BFs(e,h,p,r,FFs(a),c,a,t,x);this.Ca(this.C);this.Ga=new TCs;h=0;b.D?b.C&&(h=2):h=1;this.F=new kDs(this.Aa,e,f,this.C,this.Ga,this.O,this.oa,
this.V,h,this.D,S,X);this.Ca(this.F);this.Fa={};this.X=this.Ka=null}z(EFs,ji);u=EFs.prototype;
u.start=function(){if(po(this.O.H,1,1)){this.H.listen(this.J,"amep",ua(this.kmc,this));this.H.listen(this.J,"stbep",ua(this.rmc,this));this.H.listen(this.J,"sttep",ua(this.tmc,this));this.H.listen(this.J,"spep",ua(this.qmc,this));this.H.listen(this.J,"saep",ua(this.omc,this));this.H.listen(this.J,"snep",ua(this.pmc,this));this.H.listen(this.J,"paep",ua(this.mmc,this));this.H.listen(this.J,"rfep",ua(this.nmc,this));this.H.listen(this.C,"dialogselect",ua(this.bVc,this));this.H.listen(sx.qb(),"Vc",ua(this.lmc,
this));this.Za(ua(this.YUc,this));var a=this.O.C;wp("macros-exec").Fc(Yo,this.TUc,this);wp("macros-resume").Fc(Yo,this.K4c,this);wp("macros-manage").Fc(Yo,ua(a.bE,a,ua(this.HZc,this)));wp("macros-editor").Fc(Yo,this.dcb,this);wp("macros-extensions").Fc(Yo,ua(this.PLb,this));wp("macros-manage-extensions").Fc(Yo,ua(this.GZc,this));wp("macros-extension-menu-promo").Fc(Yo,ua(this.PLb,this));wp("macros-extension-disabled").Fc(Yo,this.hTc,this);wp("macros-extension-help").Fc(Yo,this.jVc,this);wp("macros-extension-install-start").Fc(Yo,
this.qYc,this);wp("macros-trigger-0").Fc(Yo,ua(this.qX,this,"0"));wp("macros-trigger-1").Fc(Yo,ua(this.qX,this,"1"));wp("macros-trigger-2").Fc(Yo,ua(this.qX,this,"2"));wp("macros-trigger-3").Fc(Yo,ua(this.qX,this,"3"));wp("macros-trigger-4").Fc(Yo,ua(this.qX,this,"4"));wp("macros-trigger-5").Fc(Yo,ua(this.qX,this,"5"));wp("macros-trigger-6").Fc(Yo,ua(this.qX,this,"6"));wp("macros-trigger-7").Fc(Yo,ua(this.qX,this,"7"));wp("macros-trigger-8").Fc(Yo,ua(this.qX,this,"8"));wp("macros-trigger-9").Fc(Yo,
ua(this.qX,this,"9"));this.ma.start();GFs(this.Aa,this.Ra)&&(wp("macros-addon-sidebar-focus").Ya(!0),wp("macros-addon-sidebar-focus").Nb(void 0,ICs(19)));BEs(new AEs(this.R,this.F));a=this.R.R;var b=!this.R.C,c=this.oa,d=this.V().getState()||void 0;d=["ruid",ta({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);Go(Ko(gDs(c,c.C.Ga),"POST").setContent(""),d).bC().Di()}};
function HFs(a){CFs(a.C,null);var b=ua(function(c){c.IB()?CFs(this.C,Ek(c,YCs,2)):(this.C.C.C.postMessage(Ls("Could not load scripts.","warning",!0)),CFs(this.C,[]))},a);hDs(a.oa,b)}
function IFs(a,b,c,d,e,f){if(d){tDs(a.C);var h=ua(function(){var r=GDs(this.F,b);r&&!nk(r,4)&&(T(r,4,!0),wDs(this.F))},a);var k=ua(function(){this.C.Y8();this.O.Kx.dispatchEvent(new bo(!0))},a);var l=ua(function(r){this.C.Y8();8!=r.aY()&&lFs(this.C.C,c,r.Tj())},a);sDs(a.F)}else{var m=kFs(a.C.C),p=ua(function(r){this.ma.F.cancel(r);Ks(this.C.C.C,m)},a);h=ua(function(r){Ks(this.C.C.C,m);m=kFs(this.C.C,xa(p,r))},a);k=ua(function(r){Ks(this.C.C.C,m);if(r.vya()){r=this.C.C;var t=vg("Canceled script ");
r.C.postMessage(Ls(t,"info",!1,2500))}else r=this.C.C,t=vg("Finished script "),r.C.postMessage(Ls(t,"info",!1,2500));this.O.Kx.dispatchEvent(new bo(!0))},a);l=ua(function(r){Ks(this.C.C.C,m);8!=r.aY()&&lFs(this.C.C,c,r.Tj())},a)}a.Ta.Mc(3);V_j(a.O.C,ua(a.Amd,a,b,c,h,k,l,d,e,f))}u.Amd=function(a,b,c,d,e,f,h,k){var l=this.V().getState()||void 0,m=this.ma;c=void 0===c?pa:c;d=void 0===d?pa:d;e=void 0===e?pa:e;e=ua(m.bmc,m,a,b,c,d,e);m.F.$Ob(a,b,l,e,f,h,k)};
u.lmc=function(a){var b=Xf(this.F.D),c={};b=ea(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+T9(d)]={name:d.getName(),"cws-id":R(d,1),"gsm-application-id":R(d,18),"app-key":T9(d)};Ug(a.LZ,c)};u.hTc=function(a){a.data==this.Ka&&(a=this.C,a.dispatchEvent("Wl")&&a.oa.wd.NKa())};
u.kmc=function(a){a=a.C().Hc();var b={},c=JFs(this,a);if(1==ok(a,11,0)){var d=R(a,4);d=GDs(this.F,d)}else d=void 0;var e=d,f=e&&(nk(e,10)||nk(e,9))||!1,h=e&&nk(e,19)||!1;d=this.Ga;var k=c,l=R(a,4),m=1==ok(a,11,0);f=new RCs(a,k,m,f,h);f.setVisible(!0);0==ok(a,11,0)&&(l=f.getLabel());d.C[ok(a,11,0)][l]=f;d.dispatchEvent("$l");(d=uDs(this.C))&&R(a,9)&&(1==R(a,12)||5==R(a,12))&&(l=R(a,4),d.J[l]=a,l&&l in d.D&&VEs(d.D[l],a));c=c.reverse();if(d=this.C.R){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])tk(f,
5);else{if(this.Fa[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=WOb(wp("macros-exec"),[k]),m=0;m<d.ma.length;m++){var p=d.ma[m];pn(p)==k&&ln(p,"")}this.Fa[h]=f.Qh();b[h]=!0}if(1==ok(a,11,0)){b=null!=e?e:null;c=[];e=R(a,4);f=!!R(a,9)&&3!=R(a,12);l=d.C.F.get(e);l||(l=new hs(""),l.$c(e),h=R(a,10),l.setContent(bn(h)),l.Ya(2==d.V?!1:f&&1==d.V?!1:!0),d.J.Fd(),zDs(d.C,l),ADs(d));f||d.X.push(e);f=new es;!b||nk(b,10)||nk(b,9)||nk(b,19)||(BDs(d,f,b),h=new rCs,k=String(ta(h)),T(h,1,k),f.Pa(HEs(d,h,c),!0));h=
b&&(nk(b,10)||nk(b,9))||!1;if(!b||h||!nk(b,19))for(a=a.Em(),h=0;h<a.length;++h)f.Pa(HEs(d,a[h],c,void 0,b?b:void 0),!0);b&&CDs(d,f,e,c,b);d.oa[e]=c;l.Ah(f);DDs(f.Ua(),!0);l.dispatchEvent("load");d.Ga.push(e)}else{b=a.Fl();if(d.PQ(b)){d.PQ(b);c=d.H[b];delete d.H[b];d.D.removeChild(c,!0);if(d.O)for(e=d.Aa[b],l=0;l<e.length;++l)d.O.ica(e[l]);delete d.Aa[b];c.dispose()}10<=Hg(d.H)||(b=[],a.Em(),c=a.Fl(),a=HEs(d,a,b,"Ctrl+Alt+Shift+").Hc(),DDs(a.Ua(),!1),a=new Qs(c,a,EEs.qb(),void 0,!0),e=d.D.yd()?d.D.yd()-
1:0,d.D.Dj(a,e,!0),d.H[c]=a,d.Aa[c]=b)}}};u.rmc=function(a){a=a.C();var b=a.Fl();b?DFs(b,ua(function(c){var d=Eh(c.getUrl());sg(d)||this.C.cra(d);d=Eh(c.getFunctionName());sg(d)||IFs(this,R(c,1),d,R(c,4)||void 0,void 0,c.xB()||void 0)},this,a)):nFs()};
u.tmc=function(a){var b=a.C();a=b.Sc();b=b.Fr();var c=this.C.Fa,d=Tm("docs-script-button-bar");d&&(oFs(c),sg(Eh(a))||(a=xq(nEs,{caption:a}),dn(d,a),sg(Eh(b))||(c.C=new Ur,c.C.ld("docs-script-button-bar-bubble"),c.C.setContent(xq(oEs,{text:b})),c.C.xo(a),Xr(c.C,!0),c.C.gS=!1,c.C.setPosition(1,1),c.C.Dy(!1),c.C.render(d),c.D.listen(a,"mouseover",ua(c.C.setVisible,c.C,!0)).listen(a,"mouseout",ua(c.C.setVisible,c.C,!1)))))};
u.qmc=function(a){this.C.Y8();var b=a.C(),c=rk(b,6,!1);a=c?R(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):R(b,3);var d=R(b,7),e=this.C,f=b.getTitle(),h=R(b,4),k=rk(b,5,!1);b=ua(this.j3c,this,R(b,1),c,d);e.D&&(e.D.setVisible(!1),sWb(e.F,e.D));e.D=new uFs(f,a,h,k,b);e.D.Vo=!0;e.F.Hm(e.D);e.D.setVisible(!0)};u.j3c=function(a,b,c,d,e){var f=new PDs;T(f,1,d);T(f,3,b);T(f,4,c);null!==e&&T(f,2,e);wp("macros-resume").Nb([a,Vn(f.Lc())])};
u.omc=function(a){a=a.C();var b=hak(U(a,FX,9));var c={};c.mid=this.R.O;b=gka(b,c);switch(a.ir()){case 1:var d=this.C;c=R(a,3);var e=this.V,f=a.getTitle()||void 0;if(d.dispatchEvent(new tFs(b,c,e,f))){var h=d.ma;d=d.oa.wd;d.Dc()||(d.render(),d.resize());d.NKa();var k=d.Da();k.Jh(d.H,f||"Apps Script application");f=ua(h.Mc,h,3);d.C=new cFs(b,c,[new bFs("google.script.host.close",ua(d.NKa,d),0),new bFs("google.script.host.editor.focus",f,0)],e,k);ki(d.C,f);d.Pa(d.C,!0);wp("macros-application-focus").Nb()}this.Ka=
R(a,7)||null;break;default:c=this.C,e=R(a,3),f=this.V,h=a.getTitle()||void 0,d=a.kc()||void 0,k=a.zc()||void 0,a=rk(a,8,!1),c.D&&(c.D.setVisible(!1),sWb(c.F,c.D)),c.D=new dFs(b,e,f,c.ma,h,d,k,a),c.D.Vo=!0,c.F.Hm(c.D),c.D.setVisible(!0)}};u.pmc=function(a){a=a.C();var b=a.getType();this.Va(b,a.Sc(),a.getTitle()||void 0,R(a,4)||void 0)};
u.mmc=function(a){if(Cr().C){if(!this.X||this.X.isDisposed()){a=Qm();var b=tn(a,"docs-hub-open-external-appbarbutton");this.X=new tBe(b,a,"A script attached to this file needs your permission to run. To give permission, open in a new tab and rerun the script.","Authorization required");this.Ca(this.X);nq(this.X,b)}}else a=a.C(),(b=U(a,LDs,3))&&(lk(b,2)||lk(b,11))?(b=new zCs(R(b,2),R(b,11)),nk(a,4)?(b=this.F.getExtension(b),null!=b&&nk(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),
a=a.getUrl(),new hFs(a,(new gu).format(""),void 0,void 0,b)):(a=a.getUrl(),new hFs(a,(new gu).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.F.Cha(b)):(a=a.getUrl(),new hFs(a,(new gu).format("A script attached to this document needs your permission to run."),void 0,void 0,void 0))};u.nmc=function(a){a=a.C();IFs(this,R(a,1),a.getFunctionName(),R(a,4)||void 0,void 0,a.xB()||void 0)};
u.TUc=function(a){a=a.data;var b=GDs(this.F,a.C);!b||nk(b,9)?IFs(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.F.Cha(BCs(b))};u.K4c=function(a){tDs(this.C);var b=a.data;a=b[0];b=b[1];var c=ua(function(){this.C.C.C.postMessage(Ls("Error resuming script execution","warning",!0))},this);kEs(this.ma,a,b,c)};u.HZc=function(){this.C.H.setVisible(!0);HFs(this)};
u.dcb=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new sm(IDs(this.R,a?a:void 0));b&&(a=b.editorUri?new sm(b.editorUri):a,b.filename&&a.Gd("f",b.filename),b.lineNumber&&(a.Gd("l",b.lineNumber),a.Gd("s",b.lineNumber)));b=this.O.F;var c=null;zo(this.O.C)||(c=IXj("Loading\u2026",{target:"MacroService"+gma(b)}));this.O.C.bE(ua(this.C.Pjd,this.C,a.toString(),this.R.F,b,this.V,c))};u.PLb=function(){this.F.Cha()};
u.GZc=function(a){if(a.data)this.F.Cha(a.data);else{a=this.F;var b=rDs(a,!0),c=a.V;var d=c.F;b=NCs(d,d.D,b,void 0,!0);d=OCs(d,b);c.C=d;d=c.C;c.D.Hm(d);d.setVisible(!0);sDs(a)}};
u.jVc=function(a){var b=this.F,c=GDs(b,a.data);if(c){var d=BCs(c);a=ua(b.RXb,b,d,T9(c),c.getName(),R(c,6)||void 0,R(c,11)||void 0);d=ua(b.Cha,b,d);var e=nk(c,19)||void 0,f=b.C,h=c.getName(),k=Eh(R(c,7)),l=R(c,6)||void 0;c=R(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(sWb(f.F,f.J),f.J.dispose());f.J=new rFs(h,k,a,d,l,c,e);f.J.Vo=!0;f.F.Hm(f.J);f.J.setVisible(!0);sDs(b)}};
u.qYc=function(a){if(a.data){var b=GDs(this.F,a.data);if(null!=b)if(a=this.F,b=BCs(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;Tzk(a.X,"Oops",b,void 0,void 0,"Close")}wDs(a)}else{var c=a.getExtension(b);c&&nk(c,9)?(b=a.getExtension(b).getName(),b=vg(b+" is already installed"),a.C.C.C.postMessage(Ls(b,"info",!1,2500)),wDs(a)):a.Cha(b)}}};
u.bVc=function(a){"edit"==a.key?(a=a.target.OD.bj(),a=IDs(this.R,a?a.PPb:void 0),this.dcb(new VCb({editorUri:a}))):"new"==a.key?this.dcb(new VCb({editorUri:this.R.X})):"reload"==a.key?HFs(this):"run"==a.key&&(a=a.target.OD.bj(),IFs(this,a.PPb,a.getFunctionName(),void 0,void 0,a.xB()))};u.qX=function(a){(a=this.Fa[a])&&(a=GEs(this.C.R,a))&&a.isEnabled()&&a.dispatchEvent("action")};u.YUc=function(){for(var a=this.C,b=0;b<a.V.length;b++){var c=a.V[b];c.close();c.dispose()}a.V=[]};
function JFs(a,b){var c=[];R(b,3)&&c.push(b);b=b.Em();for(var d=0;d<b.length;d++)c=c.concat(JFs(a,b[d]));return c}u.getView=n("C");function FFs(a){return a==(Is(),hRb)||a==(Is(),jRb)||a==(Is(),iRb)}function GFs(a,b){return b&&(a==(Is(),hRb)||a==(Is(),iRb))};function KFs(a,b,c,d,e,f,h){ji.call(this);var k=this;this.C=a;this.O=b;this.Db=e;this.F=d;this.ma=new Jm;this.D=f;this.oa=h;this.V=new ts(this);this.Ca(this.V);this.V.Fc(Ndc,Ro,this.J);this.X=new Lm(this);this.Ca(this.X);this.ma.Bc(this.F.F,function(){return k.J()});this.H=new gTb(this.Db.Zc(),!0);this.Ca(this.H);this.R={};this.J()}z(KFs,ji);KFs.prototype.J=function(){var a=LFs(this),b=this.O.Hc(Qdc.getId(),!0);b.Te(!0);QTb(this.O,b,[new wrk(a,this.C)]);br(b.getElement(),"waffle-action-menu")};
function LFs(a){var b=Array.from(a.F.C.values());DBs(b,function(r){return hj(r,8)});var c=Array.from(a.F.D.values());ht(a.oa,Wle(0<b.length,0<c.length));Pdc.setProperty("visible",!0);Odc.setProperty("visible",!0);var d={};c={};b=ea(b);for(var e=b.next();!e.done;c={i0a:c.i0a},e=b.next()){e=e.value;var f=hj(e,1),h=e.getFunctionName(),k=hj(e,8),l=dj(e,9)?hj(e,9):null,m="recorded-action-"+f+":"+h,p=a.C.Zh(m);p||(p=(new QFb(m)).enabled(!0),p.Ma(29583),p=p.va(),c.i0a=new qCs(f,h,void 0,void 0,void 0,dj(e,
12)?e.xB():void 0),p.Fc(Yo,function(r){return function(){a.C.Oa("macros-exec").Nb(r.i0a)}}(c)),ISb(a.H,[p]),a.C.Ww(p),a.D&&a.D.Nn(p));p.setProperty("label",k);MFs(a,l)&&p.setProperty("keys",[l]);null==l&&null!=p.getProperty("keys")&&p.setProperty("keys",null);d[m]=p}zg(a.R,function(r,t){d[t]||(r.setProperty("keys",null),a.C.y$(t),a.D&&a.D.ica(t),hi(r))});a.R=d;return Ig(d)}function MFs(a,b){return!Ndc.Vf()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(Yha(a.H.C,sd(b))||[]).length};function NFs(a,b){this.rnb=a;this.gZa=b};function OFs(){var a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
Gz(void 0,void 0,void 0,void 0,void 0,Kq('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>'));a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+Gz(void 0,void 0,void 0,void 0,void 0,Kq('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>'));return zq(a+"</div></div></div></div>")}
;function PFs(a,b){mq.call(this,b);this.V=a;this.J=new Zr("",new Et,this.Da());this.Pa(this.J);this.F=new Zr("",new Et,this.Da());this.Pa(this.F);this.D=new us;this.Ca(this.D);this.H=null;this.C=0}z(PFs,mq);u=PFs.prototype;u.Ia=function(){this.Ob(xq(OFs))};
u.Qa=function(){mq.prototype.Qa.call(this);this.R=new vQk(this.Da(),void 0,"relative");this.O=new vQk(this.Da(),void 0,"absolute");this.R.ub(this.Ja("waffle-recording-toast-relative"));this.O.ub(this.Ja("waffle-recording-toast-absolute"));var a=Sg(ws);Rg(a,"selected",!0);var b=Cp(new Bp,6).va();vs(this.D,this.R,Tdc,a,void 0,b);vs(this.D,this.O,Udc,a,void 0,b);vs(this.D,this.J,this.V.Oa("recorded-action-stop"),void 0,void 0,b);vs(this.D,this.F,Mdc,void 0,void 0,b);this.H=new eed(this.Ja("waffle-recording-toast-expand"),
this.Ja("waffle-recording-toast-bottom"),Vdc.isVisible(),void 0,this.Da());this.Ca(this.H);this.getHandler().listen(this.H,"toggle",this.Y3c);this.J.ub(this.Ja("waffle-recording-toast-stop"));this.F.ub(this.Ja("waffle-recording-toast-cancel"))};u.setVisible=function(a){var b=this.Ua();gq(b,a);Wq(b,"hidden",!a);a&&(a=this.Da().Zc(),a=Zm(a)||window,b=dq(this.Ua()),this.Ua().style.left=Math.max(Math.floor(Xm(a).width/2-b.width/2),0)+"px")};
function QFs(a,b){a.Ja("waffle-recording-toast-default-content").style.opacity=0;var c=a.Ja("waffle-recording-toast-new-content");a.Da().Jh(c,b);0!=a.C?RFs(a):(Yn(a.C),a.C=Xn(function(){return RFs(a)},400))}function RFs(a){var b=a.Ja("waffle-recording-toast-new-content");dr(b,"waffle-recording-toast-slide-in");Yn(a.C);a.C=Xn(function(){br(b,"waffle-recording-toast-slide-in");Yn(a.C);a.C=Xn(function(){return SFs(a)},2200)})}
function SFs(a){var b=a.Ja("waffle-recording-toast-default-content"),c=a.Ja("waffle-recording-toast-new-content");dr(c,"waffle-recording-toast-slide-in");b.style.opacity=1;Yn(a.C);a.C=Xn(function(){a.C=0},400)}u.Y3c=function(a){Vdc.setVisible(a.R1)};u.Wa=function(){Yn(this.C);mq.prototype.Wa.call(this)};function TFs(a,b,c,d,e){ji.call(this);var f=this;this.O=a;this.J=c;this.D=d;this.C=Yk().ZLc()(Yk().fG()(),Yk().xKc()(),U9(this),Tdc.Vf(),function(h){h="Action "+(Yk().YLc()(f.C)+(": "+h));UFs(f,h)},Yk().HJb()());Yk().YJb()(this.C);this.H=new PFs(e);this.Ca(this.H);this.Fa=new ts(this);this.Ca(this.Fa);this.Fa.Fc(Tdc,Yo,this.W9c,this).Fc(Udc,Yo,this.V9c,this).Fc(wp("docs-doc-copy-made"),Yo,this.yTc,this).Fc(wp("macros-exec"),Yo,this.h5c,this).Fc(B7b,Yo,function(h){return VFs(f,h.data,2)},this).Fc(H7b,
Yo,function(h){return VFs(f,h.data,3)},this).Fc(A7b,Yo,function(h){return VFs(f,h.data,1)},this).Fc(C7b,Yo,function(h){return VFs(f,h.data,5)},this).Fc(D8b,Yo,function(h){return VFs(f,h.data,4)},this).Fc(W7b,Yo,function(h){h=h.data;switch(h.F){case "all-objects-for-all-datasources":Yk().OLc()(f.C,U9(f));break;case "all-objects-for-single-datasource":Yk().PLc()(f.C,U9(f),h.D);break;case "specific-ids":var k=h.C;if(!(0<(nf(pf(),"feds")?Yk().s$a()(k):[]).length)){var l=h.C[0];h=Yk().ZX()(l);k=null;switch(h){case 4:k=
WFs(f,l,!1);break;case 1:case 3:case 5:(l=Yk().jHb()(l,vY(f.J)))&&0<l.length&&(k=ro(l[0]),k=atb($sb(Zsb(Xsb(),k.Cb()),k.od()),k.bd()).va(),l=GBs(),3==h?(HBs(l),yj(l,6,k)):1==h?(HBs(l),yj(l,5,k)):5==h&&(HBs(l),yj(l,4,k)),k=l.va().Mb());break;case 2:(l=Yk().iHb()(l))&&0<l.length&&(k=FBs(l[0]).va().Mb())}k&&Yk().bKb()(f.C,U9(f),h,k)}}}).Fc(N7b,Yo,function(){return Yk().QLc()(f.C,U9(f),!1)},this).Fc(z7b,Yo,this.TRc,this).Fc(D7b,Yo,function(h){return Yk().KLc()(f.C,U9(f),h.data.Mb())},this);this.F=new Jm;
this.Ca(this.F);this.F.Bc(a.rb,function(){Yk().dMc()(f.C,!0,U9(f))});this.F.Bc(a.Ta,function(h){if(h.D){var k=h.C.D();"docs-edit"==k?"ritz-waffle"==h.C.C&&Yk().aMc()(f.C,U9(f)):"docs-undo"==k?(UFs(f,"Undo previous action"),Yk().eMc()(f.C)):"docs-redo"==k&&(UFs(f,"Redo previous action"),Yk().bMc()(f.C))}});this.F.Bc(b.Aa,function(h){h.C||Yk().VLc()(f.C,U9(f),h.D)});this.F.Bc(this.D.Jb,function(h){return XFs(f,h)});this.F.Bc(this.D.Qc,function(){f.ma=U9(f)});this.F.Bc(this.D.Oc,function(h){switch(h.D){case "find-next-occurrence":Yk().LLc()(f.C,
f.ma,U9(f),h.C.Mb());break;case "replace-current-occurrence":Yk().RLc()(f.C,U9(f),h.C.Mb())}f.ma=null});this.F.Bc(this.D.ib.D,function(h){Yk().ULc()(f.C,U9(f),h.F,h.H,h.J,h.O,h.id,h.C,h.D)});this.F.Bc(b.Kx,function(){Yk().ILc()(f.C,f.Aa,U9(f),f.oa);f.Aa=null;f.oa=null});this.F.Bc(this.D.ad,function(h){Yk().JLc()(f.C,f.R.D.C.Mb(),h.getSelection().C.Mb(),f.R.C.Mb());f.R=null});this.X=new Lm(this);this.Ca(this.X);this.R=this.ma=this.oa=this.Aa=this.V=null;this.X.listen(this.D.C,"na",this.vmc).listen(this.D.C,
"ta",this.umc);this.H.render();this.H.setVisible(!0);YFs(this);setTimeout(function(){return Xw("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}z(TFs,ji);u=TFs.prototype;u.umc=function(){this.V=U9(this)};u.vmc=function(a){!a.JZ&&fcd(this.D)&&(void 0!==a.fla?(a=a.fla,Yk().WLc()(this.C,this.V,U9(this),a)):(a=this.D.C.C.Pg(),QFs(this.H,"Activating sheet "+a),Yk().XLc()(this.C,this.V,U9(this),a)),this.V=null)};
function UFs(a,b){QFs(a.H,b);Xw("Macro recorder "+b)}function ZFs(a){return Yk().$Lc()(a.C,U9(a))}u.h5c=function(a){this.oa=a.data.functionName;this.Aa=U9(this)};function XFs(a,b){var c=U9(a);a.X.$d(a.D,"dc",function(){var d=U9(a);switch(b.H){case "adjust-next-data-region-edge":Yk().HLc()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":Yk().NLc()(a.C,c,d,b.D,b.C);break;case "select-all":Yk().SLc()(a.C,c,d);break;case "select-rows-columns":Yk().TLc()(a.C,c,d,"c"==b.F)}})}
u.yTc=function(a){a=a.data;Yk().MLc()(this.C,U9(this),a.C)};u.TRc=function(a){a=a.data;var b=this.O.C.getSelection();this.R=new $Fs(a,b)};
function VFs(a,b,c){var d=Yk().bKb(),e=a.C,f=U9(a);a:switch(c){case 4:b=WFs(a,b,!0);break a;case 3:case 1:case 5:var h=cx(a.J);h?(a=itb(a.O.C.getSelection()),aGs(b,a,h)?b=null:(a=hGd(h),aGs(b,a,h)?(b=bNc(h.mb().xk(a.y,a.x)),b=null!=b?b:atb($sb(Zsb(Xsb(),h.R.C.C.Cb()),a.y),a.x).va(),h=GBs(),3==c?(HBs(h),yj(h,6,b)):1==c?(HBs(h),yj(h,5,b)):5==c&&(HBs(h),yj(h,4,b)),b=h.va().Mb()):b=null)):b=null;break a;case 2:if(h=cx(a.J)){a=a.O.C.getSelection();var k=NGk(h);b=k&&ij(a.C,6).Lc().includes(k)?null:(a=LGk(h))&&
b==MGk(h)?FBs(a).va().Mb():null}else b=null;break a;default:b=null}d(e,f,c,b)}function aGs(a,b,c){if(!b)return!1;b=c.mb().xk(b.y,b.x);c=gGd(c,b);return a==c}function WFs(a,b,c){if(c&&(a=a.D.C.C)&&ev(a))return null;b=Yk().Z7()(b);if(!b)return null;(b=Yk().Sda()(b))?(a=GBs(),HBs(a),b=tj(a,2,b).va().Mb()):b=null;return b}u.W9c=function(){var a=!Yk().cKb()(this.C);bGs(this,!0);a&&(QFs(this.H,"Using relative references"),Xw("Recording with relative references"))};
u.V9c=function(){var a=Yk().cKb()(this.C);bGs(this,!1);a&&(QFs(this.H,"Using absolute references"),Xw("Recording with absolute references"))};function bGs(a,b){Yk().cMc()(a.C,b);Tdc.Ed(b);Udc.Ed(!b)}function YFs(a){(a=cx(a.J))&&nyd(a)}function U9(a){return a.O.C.getSelection().C.Mb()}u.Wa=function(){Yk().mJb()();ji.prototype.Wa.call(this)};function $Fs(a,b){this.C=a;this.D=b};function cGs(a,b,c,d,e){Mt.call(this,"Macro saved",Qm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Za=a;this.O=b;this.Va=c;this.Ga=d;this.J=e}z(cGs,Mt);cGs.prototype.Ia=function(){Mt.prototype.Ia.call(this);var a=oq(this,"script-recorder-edit-link-id");this.YD("EDIT SCRIPT",a)};cGs.prototype.Qa=function(){Mt.prototype.Qa.call(this);this.getHandler().Ki(pq(this,"script-recorder-edit-link-id"),Dm,ua(this.Ta,this,this.Za,this.O,this.Va))};
cGs.prototype.Ta=function(a,b,c){this.Ga.C(29645);this.J.Oa("macros-editor").Nb(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function dGs(a,b,c,d,e,f,h,k,l,m){et.call(this);var p=this;this.Fa=a;this.oa=b;this.Va=c;this.Ra=d;this.ma=e;this.J=f;this.Ka=h;this.Aa=k;this.R=m;this.O=this.J.Rf();this.Ga=new ts(this);this.Ca(this.Ga);this.H=null;this.X=!1;this.C=null;this.Ta=l;this.Ga.subscribe(Rdc,"action",this.Dod).subscribe(this.O.Oa("recorded-action-stop"),"action",this.vqd).subscribe(Wdc,"action",this.Dmd).subscribe(Mdc,"action",this.Twc).subscribe(Odc,"action",this.fpd).subscribe(Pdc,"action",this.lpd);gt(this,eGs(this));
Hp(this.J,this);a=["not-revisions","sheet-access-edit",jt()];var r=new Gp(a.concat(["docs-script-recording"]));wf([Mdc,this.O.Oa("recorded-action-stop"),Wdc,Sdc,Udc,Tdc],function(t){p.J.C(t,r);p.J.F(t,r)});a=new Gp(a.concat(["not-docs-script-recording"]));this.J.C(Rdc,a);hu()||this.J.F(Rdc,a)}z(dGs,et);u=dGs.prototype;u.Dod=function(){var a=this;this.H=new TFs(this.Va,this.Ra,this.ma,this.Ka,this.O);ht(this,eGs(this));this.Ka.D.C.bE(function(){Ho(Wl(Ko(a.Fa.ji("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Di()})};
u.vqd=function(){ATc(this.ma)&&aod(cx(this.ma),!0);this.H.H.setVisible(!1);Yk().mJb()();zBs(this.oa)};
u.Dmd=function(a){var b=this,c=a.rnb;a=a.gZa;var d=ZFs(this.H).C;fGs(this,Ot(this.R,"Saving new macro",Qm(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.X=!0;ht(this,eGs(this));Ho(Xl(Yl(Wl(Ko(Vl(Vl(ryb(this.Fa.ji("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.vea("scriptId"),h=e.vea("filename");e=Number(bx(e,"lineNumber"));f=new cGs(f,h,e,b.Ta,b.O);jYb(b.R,f);fGs(b,f);b.X=!1;gGs(b)}),function(){fGs(b,Ot(b.R,"Failed to save macro",
Qm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.X=!1;if(b.H){var e=b.H;Yk().YJb()(e.C);e.H.setVisible(!0)}ht(b,eGs(b))}).setTimeout(18E4)).Di()};function gGs(a){hi(a.H);a.H=null;ht(a,eGs(a))}u.Twc=function(){gGs(this);setTimeout(function(){return Xw("Script recording canceled")})};function eGs(a){var b={},c=!!a.H;a=a.X;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}u.fpd=function(){ABs(this.oa,this.Aa)};u.lpd=function(){BBs(this.oa,this.Aa)};
function fGs(a,b,c){a.C&&(kYb(a.R,a.C),a.C.setVisible(!1),hi(a.C));a.C=b;a.C.render();c&&(new Fel(!0,Qm())).render(Wm("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}u.Wa=function(){hi(this.H);this.H=null;this.C&&(hi(this.C),this.C=null);et.prototype.Wa.call(this)};function hGs(a,b,c,d){1==a&&bQc(xh(c||""),xh(b),void 0!==d?d:-1,!0)};function iGs(a,b,c,d,e,f,h,k,l,m,p,r,t,v,x,G,P,S,X){ji.call(this);this.V=a;this.ma=b;this.Aa=c;this.Fa=d;this.R=e;this.Ta=f;this.Ra=h;this.C=k;this.F=l;this.Ka=m;this.Ga=p;this.X=r;this.Va=t;this.O=new Lm(this);this.Ca(this.O);this.oa=new QBs(this.Aa,this.F);this.ib=new dGs(this.Aa,this.R,this.ma,this.V,this.C.D,x,this.F,this.oa,G,P);this.Ca(this.ib);this.J=x.Rf();this.hb=new KFs(this.J,this.C.Aa.C,l,this.oa,v,this.C.Aa.Ga,S);this.Ca(this.hb);this.D=null;this.H=X}z(iGs,ji);
iGs.prototype.init=function(){var a=this.C.Aa.Ga;a.Nn(Rdc);a.Nn(Mdc);a.Nn(this.J.Oa("recorded-action-stop"));a.Nn(Tdc);a.Nn(Udc);a.Nn(Odc);a.Nn(Pdc);a=this.F.Fb.D;var b=this.F.Fb.C;b&&(b+=a?"_"+a:"");a=pf();var c=nf(a,"docs-tintd")&&nf(a,"docs-thtea");this.D=new Ihk(this.Fa,this.ma.C,this.C.D);this.Ca(this.D);var d=this.V,e=Uyb(this.Ga),f=Vyb(this.Ga),h=this.R,k=this.Ta,l=this.Ra,m=ua(this.X.V,this.X),p=ua(this.D.C,this.D),r=(Is(),iRb),t=this.Ka,v=this.Va,x=this.Fa,G=iu(Vt.qb()),P=this.C.Aa.C;G=void 0===
G?!1:G;c=void 0===c?!1:c;var S=pf();S=new HDs(rf(S,"maestro_container_token"),rf(S,"maestro_domain"),rf(S,"maestro_script_editor_uri"),rf(S,"maestro_new_project_uri"),nf(S,"docs-emae"),rf(S,"mae-pai"),nf(S,"mae-cwssw"),nf(S,"mae-aoeba"),nf(S,"mae-esme"),rf(S,"mae-dret"),rf(S,"mae-ses"),nf(S,"docs-tdd"),nf(S,"mae-seitd"));e=new eDs(d.F,String(x),e,void 0);x=new iEs;x.bind(f);f=S.C?2:S.D?0:1;var X=new us(void 0,void 0,!0,St.qb());l=l?new FEs(l,X,f,P,void 0):null;d=new EFs(d,S,e,x,h,k,l,m,p,r,t,v,G,
hGs,oWd,b,c);d.Ca(e);d.Ca(x);d.start();wp("macros-addon-sidebar").Ya(FFs(r));wp("macros-addon-sidebar-focus").Ya(GFs(r,c||!1));wp("macros-application-focus").Ya(!0);wp("macros-application-sidebar").Ya(!0);wp("macros-editor").Ya(!S.oa||S.J);wp("macros-exec").Ya(!0);wp("macros-extension-disabled").Ya(!0);wp("macros-extension-help").Ya(!0);wp("macros-extension-install-start").Ya(!0);wp("macros-extension-menu-promo").Ya(!0);wp("macros-manage").Ya(!0);wp("macros-resume").Ya(!0);wp("macros-trigger-0").Ya(!0);
wp("macros-trigger-1").Ya(!0);wp("macros-trigger-2").Ya(!0);wp("macros-trigger-3").Ya(!0);wp("macros-trigger-4").Ya(!0);wp("macros-trigger-5").Ya(!0);wp("macros-trigger-6").Ya(!0);wp("macros-trigger-7").Ya(!0);wp("macros-trigger-8").Ya(!0);wp("macros-trigger-9").Ya(!0);null!=this.H&&(a=nf(a,"docs-isctp"),this.H.ma=a,this.O.listen(d.J,"scpep",ua(this.$a,this)));this.O.listen(Vw,"runMacro",ua(this.Za,this))};iGs.prototype.$a=function(a){null!=this.H&&(a=nk(a.C(),1),this.H.ma=a)};
iGs.prototype.Za=function(a){var b=a.payload;a=zf(Yk().qea()(),pwa);a=Ff(a,function(c){return c.getFunctionName()==b});null!=a&&dj(a,1)?this.J.Oa("macros-exec").Nb(new qCs(hj(a,1),b,void 0,void 0,void 0,dj(a,12)?a.xB():void 0)):Ww("Script function "+(b+" could not be found"))};function jGs(a){var b=a.Sob;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(yq(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(yq(b)+" to run macro.");return zq(a+b+"</div></div>")};function kGs(a,b){xt.call(this,void 0,void 0,b);this.lA=!1;vr(this,!1);this.F=new kt;this.Pa(this.F);this.H=new dZ(this.Da());this.Pa(this.H);this.O=new kt("Number");this.Pa(this.O);this.C=new dZ(this.Da());this.Pa(this.C);wr(this,(new ur).jj({key:"discard",caption:"Discard"},!1).jj(vLb,!0))}z(kGs,xt);u=kGs.prototype;
u.Ia=function(){xt.prototype.Ia.call(this);nf(pf(),"docs-egmd")?(br(sr(this),"waffle-record-script-dialog-gm"),Br(this,"save")):br(sr(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.Ec().appendChild(xq(jGs,{Sob:gp?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
u.Qa=function(){xt.prototype.Qa.call(this);this.F.ub(this.Ja("waffle-record-script-name-input"));nf(pf(),"docs-egmd")||br(this.Ja("waffle-record-script-name"),i$k.qb().zd());this.F.setValue("Untitled Macro");var a=this.F.Ua();this.H.setPosition(3,2);this.H.render();this.H.xo(a);gZ(this.H,a);fZ(this.H);this.O.ub(this.Ja("waffle-record-script-shortcut-input"));nf(pf(),"docs-egmd")||br(this.Ja("waffle-record-script-shortcut"),i$k.qb().zd());var b=this.O.Ua();this.C.setPosition(3,2);this.C.render();this.C.xo(b);
gZ(this.C,b);fZ(this.C);this.getHandler().listen(this,"dialogselect",this.wmc).listen(a,["focus","blur","change"],this.r0c).listen(b,["focus","blur","change"],this.J6c)};u.focus=function(){xt.prototype.focus.call(this);lt(this.F)};u.r0c=function(){""!=this.F.getValue()&&fZ(this.H)};u.J6c=function(){lGs(this)&&fZ(this.C)};
u.wmc=function(a){var b=this,c=Cp(new Bp,12).va();if("discard"==a.key)Mdc.Nb(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||eZ(this.H,"Must not be empty.",!0),lGs(this)||setTimeout(function(){eZ(b.C,"Must be a number from 0 to 9 or blank.",!0)}),mGs(this)&&setTimeout(function(){eZ(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&lGs(this)&&!mGs(this)){a=this.F.getValue();var d=this.O.getValue();Wdc.Nb(new NFs(a,d),c)}else a.preventDefault()};
function lGs(a){a=a.O.getValue();return""==a||/^\d$/.test(a)}function mGs(a){var b="Ctrl+Alt+Shift+"+a.O.getValue();return Yk().qea()().map(pwa).some(function(c){return dj(c,9)&&hj(c,9)==b})};function nGs(){ko.apply(this,arguments)}z(nGs,ko);nGs.prototype.F=function(){return iGs};nGs.prototype.H=function(){return kGs};nGs.prototype.C=function(a,b,c,d){return new VBs(a,b,c,d,void 0)};nGs.prototype.D=function(a,b,c){return new kCs(a,b,c,void 0)};wo("ritzmaestro",nGs);
