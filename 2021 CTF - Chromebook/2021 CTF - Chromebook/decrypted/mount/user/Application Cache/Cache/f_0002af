function Jvp(a){qj.call(this,a)}z(Jvp,qj);Jvp.prototype.getStatus=function(){return this.message.getStatus()};function Kvp(a){this.Ib=Zi(a,-1,0)}z(Kvp,$i);Kvp.prototype.yb=function(){return new Jvp(this)};Kvp.prototype.getStatus=function(){return lj(this,1,0)};function Lvp(a){qj.call(this,a)}z(Lvp,qj);Lvp.prototype.getStatus=function(){return this.message.getStatus()};function Mvp(a){this.Ib=Zi(a,-1,0)}z(Mvp,$i);Mvp.prototype.yb=function(){return new Lvp(this)};
Mvp.prototype.getStatus=function(){return lj(this,1,0)};function Nvp(a,b){return new Dn(function(c,d){qx(a,"/dbx/createSchedule",[],b.Mb(),function(e){c(aj(Kvp,JSON.stringify(e.gh())))},d)})}function Ovp(a,b){return new Dn(function(c,d){qx(a,"/dbx/updateSchedule",[],b.Mb(),function(e){c(aj(Mvp,JSON.stringify(e.gh())))},d)})}function Pvp(a){if(!Yk().zOa()(a)||Yk().rDc()(a))return!1;a=Yk().ZX()(a);return E3c.has(a)}
function Qvp(a){var b=[];a=ea(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,Pvp(c)&&b.push(c);return b}function Rvp(a){if(a.O.hj())return[];var b=[];a.C.forEach(function(c,d){r3c.has(c.D)&&Pvp(d)&&b.push(d)});return b}function Svp(a){a.Dc()&&CWk(a.F)}function Tvp(){var a=void 0===a?cj(GEk):a;return new FEk(a)}function Uvp(){var a=void 0===a?cj(IEk):a;return new HEk(a)}function Vvp(a){qj.call(this,a)}z(Vvp,qj);function Wvp(a,b){return yj(a,1,b)}function Xvp(a){this.Ib=Zi(a,-1,0)}
z(Xvp,$i);Xvp.prototype.yb=function(){return new Vvp(this)};function Yvp(){var a=void 0===a?cj(Xvp):a;return new Vvp(a)}function Zvp(a){qj.call(this,a)}z(Zvp,qj);function $vp(a,b){return tj(a,1,b)}function awp(a,b){return yj(a,2,b)}function bwp(a){this.Ib=Zi(a,-1,0)}z(bwp,$i);bwp.prototype.yb=function(){return new Zvp(this)};function cwp(){var a=void 0===a?cj(bwp):a;return new Zvp(a)}
function dwp(a,b,c,d){mq.call(this,d);this.hb=c;this.$a=a;this.state=3;this.C=null;this.Va=this.ma=!1;this.ib=new ts(this);this.Ca(this.ib);this.Za=new rUk(500,500,"dbxScheduleOnCompleteAuth");this.Ca(this.Za);ewp(this)}z(dwp,mq);function ewp(a){a.ib.Fc(n8b,Yo,function(b){b=b.data;fwp(a,36713,b);gwp(a,b,null)}).Fc(o8b,Yo,function(b){b=b.data;fwp(a,36714,b);hwp(a,b,null)}).Fc(p8b,Yo,a.zb).Fc(q8b,Yo,a.sb).Fc(lu,Xo,a.refresh)}
function gwp(a,b,c,d){d=void 0===d?!0:d;var e=Wvp(Yvp(),b);c&&tj(e,2,c);Nvp(px.qb(),e.va()).then(function(f){return iwp(a,b,f.getStatus(),hj(f,2),!0,d)},function(){a.oXa()})}function hwp(a,b,c,d){d=void 0===d?!0:d;var e=awp($vp(cwp(),a.C.getId()),b);c&&tj(e,3,c);Ovp(px.qb(),e.va()).then(function(f){return iwp(a,b,f.getStatus(),hj(f,2),!1,d)},function(){a.oXa()})}dwp.prototype.zb=function(){if(lu.isEnabled()){var a=ZEk(this.C);fwp(this,36715,a);a=a.yb().Ya(!0).va();hwp(this,a,null)}};
dwp.prototype.sb=function(){if(lu.isEnabled()){var a=ZEk(this.C);fwp(this,36716,a);a=a.yb().Ya(!1).va();hwp(this,a,null)}};function fwp(a,b,c){var d=new IOa;c=jwp(c.So());d=T(d,10,c);d=MAk(d);d=Ep(Cp(new Bp,75),d).va();a.hb.C(b,d)}function jwp(a){switch(a.So()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function kwp(a){a.state=3;a.refresh();CFk().then(function(b){a.isDisposed()||(b=mj(b,1,YEk).Lc(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Va?(a.Va=!1,a.show()):a.refresh())},function(){Js.qb().postMessage(Ls("Error loading schedule configuration.","error",!0))})}function lwp(a){return a.C&&fj(ZEk(a.C),1)?(jj(a.C.getStatus(),1),!0):!1}
function iwp(a,b,c,d,e,f){a.pob(!0);switch(c){case 1:a.focus();kwp(a);Vw.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;sUk(a.Za,d,function(h){a.isDisposed()||(a.pob(!1),e?gwp(a,b,h,!1):hwp(a,b,h,!1))});break;default:a.oXa()}}dwp.prototype.show=function(){3==this.state?this.Va=!0:(this.hb.C(116122),this.state=1==this.state?2:5,this.refresh())};function mwp(a,b){w$k.call(this,a,b)}z(mwp,w$k);mwp.prototype.R=function(){this.refresh()};mwp.prototype.refresh=function(){if(this.Dc()){var a=lu.isEnabled();a=this.J&&this.O&&a&&0<Rvp(this.H).length;this.C.Ya(a)}};mwp.prototype.V=q("Refresh all");function nwp(a){a=a||{};var b=Iq(void 0,null)?18:void 0;b='<svg xmlns="http://www.w3.org/2000/svg" width="'+V(b)+'px" height="'+V(b)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+V(Iq(void 0,null)?"#188038":void 0)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
b=zq(b);a=""+ZY(Hq({title:"Refresh options",pD:"waffle-dataconnector-refresh-sidebar",cP:Kq(""+b),gA:Kq('<div class="'+V("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+V("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),O7:!0,WX:Kq('<div class="'+V("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a));return zq(a)};function owp(){}z(owp,gs);owp.prototype.zd=q("docs-calendar-select");owp.prototype.tx=function(a){a=a.Ia("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ia("DIV",["docs-icon","goog-inline-block"],a.Ia("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));br(a,"docs-material");return a};qa(owp);function pwp(){return zq('<div><div class="'+V("waffle-dataconnector-refresh-date-input-date-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function qwp(a,b,c){void 0===b&&ixe.qb();mq.call(this,c);this.D=new By("",c);this.Pa(this.D);this.C=null;this.setDate(new Date)}z(qwp,mq);u=qwp.prototype;u.Ia=function(){mq.prototype.Ia.call(this);this.Ob(xq(pwp))};u.Qa=function(){mq.prototype.Qa.call(this);this.D.render(this.Ja("waffle-dataconnector-refresh-date-input-date-select"));this.setDate(this.F);this.getHandler().listen(this.D,"action",this.uhc)};u.getDate=n("F");
u.uhc=function(){var a=this;null==this.C?rwp(this,function(){return swp(a)}):swp(this)};function swp(a){a.C.position(a.Ua());a.C.Ja("goog-date-picker").focus();null!=a.D.getValue()&&a.C.Jnd(a.getDate())}function rwp(a,b){vo("datepicker",function(){var c=xo("datepicker");a.C=c.C(a.Da());a.Pa(a.C);a.C.render(a.Ja("waffle-dataconnector-refresh-date-input-date-picker"));a.C.mec();a.getHandler().listen(a.C,"change",a.vSc);b()})}u.vSc=function(a){this.setDate(new Date(a.C.getTime()));this.C.hide();this.D.Ua().focus()};
u.setDate=function(a){this.F=new Date(a);this.F.setMinutes(0);this.F.setSeconds(0);this.F.setMilliseconds(0);var b=this.D,c=b.setValue;a=(new du(eu.MONTH_DAY_YEAR_MEDIUM)).format(a);c.call(b,a);this.Dc()&&(ln(this.D.Ua(),""+this.D.getValue()),Zq(this.D.Ua(),"Start date:"+this.D.getValue()))};var twp=new ct("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function uwp(a,b){a=void 0===a?zv.qb():a;for(var c=new es,d=1;28>=d;d++)c.Pa(new as(twp.format({DAY:d}),d),!0);wJk.call(this,c,a,b)}z(uwp,wJk);function vwp(){var a='<div class="'+V("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'" aria-label="';a+=Mq("Add day to repeat on");a+='"></div></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>';return zq(a)};var wwp=new ct("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function xwp(a){mq.call(this,a);this.D=new mq;this.Pa(this.D);this.C=new uwp(Yr.qb(),a);lOb(this.C,"Add day");this.Pa(this.C);this.F=new ywp}z(xwp,mq);u=xwp.prototype;u.Ia=function(){mq.prototype.Ia.call(this);this.Ob(xq(vwp));this.D.ub(this.Ja("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Ja("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
u.Qa=function(){mq.prototype.Qa.call(this);ln(this.Ja("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.lgd).listen(this,"Ee",this.yid)};u.lgd=function(){var a=this.C.getValue();jOb(this.C.Ar,null);zwp(this,a);this.dispatchEvent("change")};u.yid=function(a){a=a.target;var b=qq(this.D,a);this.F.remove(b)&&(this.D.removeChild(a,this.Dc()),this.dispatchEvent("change"))};
function zwp(a,b){if(!a.F.has(b)){var c=new pUk(wwp.format({DAY:b}),a.Da());b=a.F.add(b);a.D.Dj(c,b,a.Dc())}}u.Ag=function(){return this.F.C};function Awp(a,b){for(var c=0;c<b.length;c++)zwp(a,b[c])}function ywp(){this.C=[]}ywp.prototype.add=function(a){var b=ag(this.C,a);Rf(this.C,a,-b-1);return-b-1};ywp.prototype.has=function(a){return-1<vf(this.C,a)};ywp.prototype.remove=function(a){return Uf(this.C,a)};function Bwp(){}z(Bwp,gxe);Bwp.prototype.Ia=function(a){return a.Da().Ia("INPUT",{type:"number",max:"100",min:"1"})};qa(Bwp);function Cwp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-new-title")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-enable-switch")+'"></div></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-label-separator")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+V("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ';a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+
'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+
'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+
'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-time-select-label")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-time-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-time-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return zq(a)};function Dwp(){for(var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+V(b)+'" class="'+V("waffle-dataconnector-refresh-weekday-select")+'"></div>';return zq(a+"</div>")};function Ewp(a){a=a.name;return zq('<div class="'+V("waffle-dataconnector-refresh-weekday-toggle")+'">'+yq(a)+"</div>")};function Fwp(a,b,c,d){Zr.call(this,void 0,Gwp.qb(),d);this.F=a;this.D=c;this.C=b;this.Wj(16,!0)}z(Fwp,Zr);Fwp.prototype.iy=function(a){Zr.prototype.iy.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};Fwp.prototype.getName=n("F");function Gwp(){}z(Gwp,Yr);Gwp.prototype.Ia=function(a){var b=xq(Ewp,{name:a.getName()});cr(b,this.Lx(a));return b};Gwp.prototype.zd=q("waffle-dataconnector-refresh-weekday-toggle");qa(Gwp);function Hwp(a){mq.call(this,a);this.C=Iwp(this,a)}z(Hwp,mq);Hwp.prototype.Ia=function(){mq.prototype.Ia.call(this);this.Ob(xq(Dwp))};Hwp.prototype.Qa=function(){var a=this;mq.prototype.Qa.call(this);ln(this.Ja("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.Ij("waffle-dataconnector-refresh-weekday-select")[c]);Zq(b.Ua(),b.D)})};Hwp.prototype.Ag=function(){return this.C.filter(function(a){return a.Le()}).map(function(a){return a.C})};
function Iwp(a,b){var c=($t.FIRSTDAYOFWEEK+1)%7,d=$t.NARROWWEEKDAYS.map(function(e,f){return new Fwp(e,(f+6)%7+1,$t.WEEKDAYS[f],b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Pa(e)});return d};var Jwp=new ct("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Kwp(a,b,c,d){dwp.call(this,a,b,c,d);this.V=new iVk(0,Bwp.qb(),d);this.V.setValue("1");this.Pa(this.V);a=new es;a.Pa(new as("hours",4),!0);a.Pa(new as("days",1),!0);a.Pa(new as("weeks",2),!0);a.Pa(new as("months",3),!0);this.D=new wJk(a,owp.qb(),d);this.D.Wi(0);this.D.$c("waffle-dataconnector-refresh-schedule-frequency");this.Pa(this.D);this.O=new xwp(d);this.Pa(this.O);this.Fa=new Hwp(d);this.Pa(this.Fa);this.F=new wJk(Lwp(),owp.qb(),d);this.F.Wi((new Date).getHours());this.F.$c("waffle-dataconnector-refresh-schedule-time");
this.Pa(this.F);this.Aa=new qwp(0,gxe.qb(),d);this.X=new wJk(Lwp(),owp.qb(),d);this.X.Wi((new Date).getHours());this.Pa(this.Aa);this.J=new Oz("Cancel");this.Pa(this.J);this.oa=new Xt("Save",d);this.Pa(this.oa);this.Ga=new Zr("",ex.qb(),d);this.Pa(this.Ga);this.Ta=new Zr("Setup now",ex.qb(),d);this.Pa(this.Ta);this.Ra=new Zr("",ex.qb(),d);this.Pa(this.Ra);this.H=new I$j(d);this.H.dh("Enable schedule");this.Pa(this.H);this.Ka=b;this.R=new yVk(d);this.R.ld("waffle-dataconnector-refresh-schedules-new-info-icon");
this.R.setVisible(!1);this.rb=new QY(!0,"#0f9d58")}z(Kwp,dwp);u=Kwp.prototype;
u.Ia=function(){dwp.prototype.Ia.call(this);this.Ob(xq(Cwp));var a=this.Ja("waffle-dataconnector-refresh-schedules-new-title");a.id=oq(this,"waffle-dataconnector-refresh-schedules-new-title");Wq(this.Ua(),"labelledby",a.id);Zq(a,"Scheduled refresh");ln(a,"Scheduled refresh");a=this.R.C;a.setContent(hh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.R.render(this.Ja("waffle-dataconnector-refresh-schedules-new-header-title"));
a=a.Ec();Wq(gn(this.R.Ua())[0],"labelledby",a.id)};
u.Qa=function(){var a=this;dwp.prototype.Qa.call(this);this.J.render(this.Ja("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ga.render(this.Ja("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.H.render(this.Ja("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.V.render(this.Ja("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Ja("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.oa.render(this.Ja("waffle-dataconnector-refresh-schedules-new-save-btn"));
this.Ta.render(this.Ja("waffle-dataconnector-refresh-schedules-new-setup-btn"));this.Ra.render(this.Ja("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.F.render(this.Ja("waffle-dataconnector-refresh-schedules-new-time-select"));this.O.render(this.Ja("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Fa.render(this.Ja("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.rb.render(this.Ja("waffle-dataconnector-refresh-schedules-new-spinner"));
this.Aa.render(this.Ja("waffle-dataconnector-refresh-schedules-new-start-date-select"));this.X.render(this.Ja("waffle-dataconnector-refresh-schedules-new-start-time-select"));Mwp(this,!1);Nwp(this,!1);Owp(this,!0);zNb(this.F,new Sq(null,13));zNb(this.X,new Sq(null,13));ln(this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");ln(this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),"Repeat every");ln(this.Ja("waffle-dataconnector-refresh-schedules-new-start-date-label"),
"Start date");var b=this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-every-label");b.id=oq(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");Wq(this.D.Ua(),"labelledby",b.id);Wq(this.V.Ua(),"labelledby",b.id);b=this.Ja("waffle-dataconnector-refresh-schedules-new-repeat-at-label");b.id=oq(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");Wq(this.F.Ua(),"labelledby",b.id);b=this.Ja("waffle-dataconnector-refresh-schedules-new-start-date-label");b.id=oq(this,
"waffle-dataconnector-refresh-schedules-new-start-date-label");Wq(this.Aa.Ua(),"labelledby",b.id);this.getHandler().listen(this.Ga,"action",this.show).listen(this.J,"action",this.whc).listen(this.oa,"action",this.zhc).listen(this.Ta,"action",this.show).listen(this.H,"action",this.xhc).listen(this.D,"change",this.yhc).listen(this.O,"change",this.P0).listen(this.Fa,"change",this.P0).listen(this.O,"change",this.P0).listen(this.F,"change",this.P0).listen(this.X,"change",this.P0).listen(this.V,"action",
this.P0).listen(this.Ra,"action",this.Ahc).listen(this.Ua(),"keydown",this.vhc);[this.D,this.F,this.X,this.J].forEach(function(c){a.getHandler().listen(c.Ua(),"focus",function(){var d=a.Aa;d.C&&d.C.isVisible()&&d.C.hide()})});0<Array.from(this.$a.C.keys()).length?(gq(this.Ua(),!0),kwp(this)):gq(this.Ua(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ja("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Ja("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Ja("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Ja("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Ja("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Ja("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Ja("waffle-dataconnector-refresh-schedules-new-spinner");
gq(e,!1);gq(f,!1);gq(a,!1);gq(b,!1);gq(c,!1);gq(d,!1);gq(h,!1);fr(this.Ua(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.R.setVisible(!1);switch(this.state){case 1:gq(e,!0);break;case 2:gq(c,!0);gq(a,!0);gq(d,!0);fr(this.Ua(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;Pwp(this);Qwp(this);this.P0();this.J.Ya(!0);this.R.setVisible(!0);Awp(this.O,[1]);break;case 3:gq(h,!0);break;case 5:gq(c,!0);gq(f,!0);gq(a,!0);gq(d,!0);fr(this.Ua(),"waffle-dataconnector-refresh-schedules-new-widget-opened",
!0);k=!0;Rwp(this);Pwp(this);Qwp(this);a=ZEk(this.C);this.H.Wc(!!fj(a,1));b=a.So().So();this.D.setValue(b);switch(b){case 4:Nwp(this,!1);Mwp(this,!1);break;case 1:Nwp(this,!1);Mwp(this,!1);this.F.setValue(kj(a.So(),2));break;case 2:Nwp(this,!0);Mwp(this,!1);c=this.Fa;d=xX(a.So(),4).Lc();e=ea(c.C);for(f=e.next();!f.done;f=e.next())f.value.Wc(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Wc(!0);this.F.setValue(kj(a.So(),2));break;case 3:Nwp(this,!1),Mwp(this,!0),Awp(this.O,xX(a.So(),5).Lc()),
this.F.setValue(kj(a.So(),2))}c=dj(a.So(),7)?new Date(jj(a.So(),7)):new Date;this.Aa.setDate(c);4===b?this.X.setValue(c.getHours()):this.F.setValue(kj(a.So(),2));this.V.setValue(lj(a.So(),6,1).toString());this.P0();this.J.Ya(!0);this.R.setVisible(!0);break;case 4:gq(f,!0),gq(b,!0),Rwp(this),b=this.Ja("waffle-dataconnector-refresh-schedules-new-overview-text"),lwp(this)?(a=this.C.getStatus(),ln(b,"Next: "),b=new Date(1E3*jj(a,2)),a=new Date(1E3*jj(a,3)),this.Ga.setContent(zn(this.Da(),FVk(b,a,this.Ka,
!0,!0))),gq(this.Ja("waffle-dataconnector-refresh-schedules-new-label-separator"),!1)):(ln(b,"Paused"),this.Ga.setContent("Edit"),gq(this.Ja("waffle-dataconnector-refresh-schedules-new-label-separator"),!0))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Vk":"Uk"))}};function Rwp(a){var b=!!fj(ZEk(a.C),1),c=lu.isEnabled();a.H.Wc(b);a.H.Ya(c)}
function Pwp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=hj(a.C.rc(4,OEk),1))&&(c+=" Currently running as "+a);ln(b,c)}function Qwp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-new-fullview-text");if(lwp(a)){var c=a.C.getStatus(),d=new Date(1E3*jj(c,2));c=new Date(1E3*jj(c,3));var e=a.Da();e.Te(b);e.appendChild(b,zn(e,oh(hh("Next: "),FVk(d,c,a.Ka,!1,!0))))}else ln(b,"");a.Ra.setContent(EVk(a.Ka))}u.whc=function(){Swp(this)};
function Swp(a){a.state=2==a.state?1:4;a.refresh();a.Ja("waffle-dataconnector-refresh-schedules-new-title").focus()}u.yhc=function(){switch(this.D.getValue()){case 4:Nwp(this,!1);Mwp(this,!1);Owp(this,!0);break;case 1:Nwp(this,!1);Mwp(this,!1);Owp(this,!1);break;case 2:Mwp(this,!1);Nwp(this,!0);Owp(this,!1);break;case 3:Nwp(this,!1),Mwp(this,!0),Owp(this,!1)}this.P0()};
function Owp(a,b){gq(a.Ja("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);gq(a.Ja("waffle-dataconnector-refresh-schedules-new-time-select"),!b);gq(a.Ja("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
u.zhc=function(){this.oa.Ya(!1);this.J.Ya(!1);var a=this.D.getValue(),b=Tvp().K$(a);if(2===a)for(var c=ea(this.Fa.Ag()),d=c.next();!d.done;d=c.next())d=d.value,Sva(b.Ib,4,uva).add(d);else if(3===a)for(c=ea(this.O.Ag()),d=c.next();!d.done;d=c.next())d=d.value,Sva(b.Ib,5,uva).add(d);c=this.Aa.getDate();4===a&&c.setHours(this.X.getValue());c=c.getTime();uj(b,7,c);4!==a&&(a=this.F.getValue(),vj(b,2,a));a=parseInt(this.V.getValue(),10);vj(b,6,a);b=vj(Uvp().K$(b),3,1);2==this.state?(b.Ya(!0),n8b.Nb(b.va())):
(b.Ya(this.H.Le()),o8b.Nb(b.va()))};u.xhc=function(){var a=this;if(4==this.state){var b=this.H.Le();this.H.Wc(!b);this.H.Ya(!1);if(b){var c=Twp(this);c.render();c.setVisible(!0);c.Kl().then(function(){hi(c);p8b.Nb()},function(){hi(c);Rwp(a)})}else q8b.Nb()}};u.vhc=function(a){27==a.keyCode&&this.ma&&(Swp(this),a.stopPropagation())};u.Ahc=function(){Aec.Nb()};
u.P0=function(){var a=!!this.D.bj(),b=3!==this.D.getValue()||0<this.O.Ag().length,c=2!==this.D.getValue()||0<this.Fa.Ag().length,d=!!this.F.bj()||4===this.D.getValue(),e=!!this.X.bj()||4!==this.D.getValue(),f=lu.isEnabled(),h=parseFloat(this.V.getValue());h=Number.isInteger(h)&&0<h&&100>=h;this.oa.Ya(a&&b&&c&&d&&e&&f&&h)};u.focus=function(){this.Ja("waffle-dataconnector-refresh-schedules-new-title").focus()};u.pob=function(a){this.H.Ya(a)};
function Mwp(a,b){gq(a.Ja("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function Nwp(a,b){gq(a.Ja("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function Twp(a){var b=new ecl;b.ld("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=ZEk(a.C);switch(c.So().So()){case 1:var d="Daily ";break;case 2:d=Uwp();var e=xX(c.So(),4).Lc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(xX(c.So(),5).Lc().map(function(l){return Jwp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=CVk(a.Ka);var h=new Date(ya()),k=new Date(1E3*jj(f,2));f=new Date(1E3*jj(f,3));d+=DVk(k,f,c)+" ("+M0b(O0b(c,h))+")";a="Will run as "+hj(a.C.rc(4,OEk),1);a=oh(hh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),nh("H4",void 0,"Schedule"),hh(d),nh("BR"),hh(a));rr(b,a);return b}u.oXa=function(){Js.qb().postMessage(Ls("Error saving schedule.","error",!0));this.oa.Ya(!0);this.J.Ya(!0);this.H.Ya(!0)};
function Uwp(){var a=($t.FIRSTDAYOFWEEK+1)%7,b=$t.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function Lwp(){for(var a=new es,b=new Date(ya()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=DVk(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new as(c[b].label,c[b].value),a.Pa(d,!0);return a};function Vwp(a,b,c){ji.call(this);this.C=a;this.J=b;this.O=c;this.F=[];this.H=[];this.D=[]}z(Vwp,ji);Vwp.prototype.Wa=function(){Wwp(this);ji.prototype.Wa.call(this)};function Xwp(a,b,c){var d=cx(a.C);b.forEach(function(e){var f=e.rect;f&&sv(f)&&(d&&vY(a.C)==e.gid?(e=yzd(d,f,Ywp(c)),a.Ca(e),e.setVisible(!0),a.F.push(e)):Zwp(a,e.gid,c))})}
function $wp(a,b,c){var d=cx(a.C);b.forEach(function(e){if(d){var f=Krd(d.J,e);if(f&&f.Dc()&&f instanceof sbl){a.D.push(f);br(abl(f.D),Ywp(c));return}}(e=a.O.J.Rr(e))&&Zwp(a,e.Cb(),c)})}function Zwp(a,b,c){b=TGk(a.J,b);br(b.Ua(),Ywp(c));a.H.push(b)}function Ywp(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function Wwp(a){ii(a.F);a.F=[];a.H.forEach(function(b){er(b.Ua(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.H=[];a.D.forEach(function(b){er(abl(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.D=[]};function axp(){return zq('<div class="'+V("waffle-dataconnector-refresh-all-pane")+'"><div class="'+V("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function bxp(){return zq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function cxp(a,b){return zq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+bxp(null,b))}function dxp(){return zq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function exp(a){a=a.title;a='<div class="'+V("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+tUc()+'</div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+yq(a)+'</div><div class="'+
V("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return zq(a+"Running\u2026</div></div></div>")};function fxp(a,b,c,d,e,f,h){mq.call(this,h);this.C=a;this.ma=b;this.X=c;this.V=d.O;this.O=e;this.D=new Vwp(e,f,d);this.Ca(this.D);this.R=new rod;this.H=new QY(!1,"#0f9d58");this.F=this.J=!0}z(fxp,mq);u=fxp.prototype;u.Ia=function(){this.Ob(xq(exp,{title:this.ma}));var a=this.Ja("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=oq(this,"waffle-dataconnector-refresh-all-dbobject-item-title");Tq(a,"heading");Wq(this.Ua(),"labelledby",a.id)};
u.Qa=function(){mq.prototype.Qa.call(this);br(this.Ua(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Ua(),"click",this.sxb).listen(this.Ua(),"keydown",this.Chc).listen(this.Ua(),["mouseenter","focus"],this.Bhc).listen(this.Ua(),["mouseleave","blur"],this.FQc);gxp(this)};
function gxp(a){var b=wFk(a.V,a.C),c=b.getType(),d=a.Ua();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":gr(d,"valid-highlight","error-highlight");a.F=!1;break;case "loading":case "no-results":case "fetch-successful":gr(d,"error-highlight","valid-highlight");a.F=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":hxp(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");ixp(a);break;case "offline":ixp(a);break;case "loading":hxp(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");jxp(a);break;case "fetching-results":hxp(a,"waffle-dataconnector-refresh-all-dbobject-item-running");jxp(a);break;case "no-results":kxp(a);ixp(a);break;case "fetch-successful":b=jj(b.C,8);b=a.R.format(b);ln(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);Zq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);hxp(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");ixp(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}u.Ya=function(a){this.J=a;var b=this.Ua();this.Da().Ln(b,a);a?gr(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):gr(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
u.Bhc=function(){var a=this;switch(this.X){case 1:case 3:case 5:var b=Yk().jHb()(this.C,vY(this.O)).map(function(c){return Fv(ro(c))});Xwp(this.D,b,this.F);break;case 2:b=Yk().iHb()(this.C);$wp(this.D,b,this.F);break;case 4:Yk().hHb()(this.C).forEach(function(c){Zwp(a.D,c,a.F)})}};u.FQc=function(){Wwp(this.D)};function hxp(a,b){kxp(a);gq(a.Ja(b),!0)}
function ixp(a){a.H.setActive(!1);gq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);gq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function jxp(a){a.H.setActive(!0);gq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);gq(a.Ja("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}u.Chc=function(a){13===a.keyCode&&this.sxb()};u.sxb=function(){if(this.J){var a=new Kv("refresh-db-object-request");a.FFb=this.C;this.dispatchEvent(a)}};
function kxp(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return gq(a.Ja(b),!1)})};function lxp(a,b,c,d,e,f,h,k){mq.call(this,k);this.R=a;this.H=new Set(b);this.oa=c;this.V=c.O;this.F=[];this.X=f;this.ma=h;this.J=d;this.D=this.C=null;e&&(this.C=new mxp(this.Da()),this.D=new jUk(this.J,this.Da(),!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}z(lxp,mq);u=lxp.prototype;u.Ia=function(){if(this.D){var a=$m("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.Ob(a);this.Pa(this.D,!0);this.D.setContent(xq(bxp));br(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.Ob(xq(cxp))};
u.Qa=function(){mq.prototype.Qa.call(this);this.D||ln(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.J);nxp(this);oxp(this);var a=this.getHandler();this.C&&(this.C.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.U3c))};function pxp(a){var b=a.getHandler();a.F.forEach(function(c){b.Td(c,"refresh-db-object-request",a.WMb)})}
function oxp(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.WMb)})}function nxp(a){var b=a.Ja("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.H.forEach(function(c){var d=Yk().ZX()(c);c=new fxp(c,qxp(a,d),d,a.oa,a.X,a.ma,a.Da());a.F.push(c);c.render(b)})}
function qxp(a,b){switch(b){case 1:return"Pivot table "+rxp(a,1);case 2:return"Chart "+rxp(a,2);case 3:return"Function "+rxp(a,3);case 4:return"Preview";case 5:return"Extract "+rxp(a,5);default:throw Error("Unexpected DbObjectType");}}function rxp(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}function sxp(a){a.O.forEach(function(b,c,d){return d.set(c,0)})}
u.U3c=function(){var a=this,b=Array.from(this.H).filter(function(c){return r3c.has(wFk(a.V,c).D)});W7b.Nb(new fak(b,"all-objects-for-single-datasource",this.R))};u.WMb=function(a){a=a.FFb;r3c.has(wFk(this.V,a).D)&&W7b.Nb(new fak([a],"specific-ids"))};function txp(a){a.F.forEach(function(b){return gxp(b)})}function uxp(a,b){a.C&&(b=b.filter(function(c){return dj(c,3)&&a.H.has(c.Fu())}),vxp(a.C,b))}u.expand=function(){this.D.Cl().Wc(!0)};u.jg=n("R");
function wxp(a,b){a.J=b;a.D?a.D.Cl().setContent(b):ln(a.Ja("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}u.Ya=function(a){this.C&&this.C.Ya(a);this.F.forEach(function(b){return b.Ya(a)})};function mxp(a){mq.call(this,a);this.D=new Oz("Refresh",this.Da());this.Pa(this.D);this.C=new v$k;this.Pa(this.C)}z(mxp,mq);mxp.prototype.Ia=function(){this.Ob(xq(dxp))};
mxp.prototype.Qa=function(){mq.prototype.Qa.call(this);this.D.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ja("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function vxp(a,b){var c=0;b.forEach(function(d){return c+=parseInt(d.tA(),10)});FWk(a.C,c);a.D.Ya(!0)}mxp.prototype.Ya=function(a){this.D.Ya(a)};function xxp(a,b,c,d){mq.call(this,d);this.F=a;this.J=a.O;this.D=new mq;this.Pa(this.D);this.C=[];this.H=b;this.O=c}z(xxp,mq);xxp.prototype.Ia=function(){this.Ob(xq(axp))};xxp.prototype.Qa=function(){var a=this;mq.prototype.Qa.call(this);this.D.ub(this.Ja("waffle-dataconnector-refresh-all-datasources-container"));yxp(this);this.getHandler().listen(this.F.C,"ua",function(b){return zxp(a,b)})};
function yxp(a){var b=a.D.Te(!0);ii(b);a.C=[];b=Axp(a);if(1==b.size)b=b.entries().next().value,Bxp(a,b[0],b[1],!1),br(a.D.Ua(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ea(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);Bxp(a,d,e,!0)}dr(a.D.Ua(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function Cxp(a){var b=Axp(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.jg();if(b.has(d)){var e=b.get(d);pxp(c);ii(c.F);c.F=[];sxp(c);c.H=new Set(e);nxp(c);oxp(c)}else Dxp(a,c);b.delete(d)}),b.forEach(function(c,d){return Bxp(a,d,c,!0)})):yxp(a)}function Dxp(a,b){a.C=a.C.filter(function(c){return b!=c});hi(b)}function Bxp(a,b,c,d){var e=Yk().Sda()(b);e=vw(a.F.C,e).Pg();b=new lxp(b,c,a.F,e,d,a.H,a.O,a.Da());a.C.push(b);a.D.Pa(b,!0)}
function Axp(a){var b=new Map;Qvp(a.J).forEach(function(c){var d=Yk().Z7()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function Exp(a,b){a.C.forEach(function(c){return uxp(c,b)})}function Fxp(a){a.C.forEach(function(b){b.C&&DWk(b.C.C)})}function Gxp(a){a.C.forEach(function(b){b.C&&(b=b.C,CWk(b.C),b.D.Ya(!1))})}function Hxp(a){a.C.forEach(function(b){return txp(b)})}xxp.prototype.Ya=function(a){this.C.forEach(function(b){return b.Ya(a)})};
function zxp(a,b){3==vw(a.F.C,b.xm).mj()&&(a=a.C.find(function(c){return c.J==b.C}))&&wxp(a,b.zv)};function Ixp(a,b,c){b=void 0===b?yv.qb():b;Or.call(this,"",void 0,c);a&&Jxp(a);this.C=new Kxp(a,b,c);this.Pa(this.C)}z(Ixp,Or);u=Ixp.prototype;u.Ia=function(){this.C.Ia();this.Ob(this.C.Ua())};u.Me=function(a){a.dw(!0);this.C.Me(a)};u.ZD=function(a,b){a.dw(!0);this.C.ZD(a,b)};u.ql=function(a){return this.C.ql(a)};u.Dm=function(){return this.C.Dm()};u.Ag=function(){return this.C.C.map(function(a){return a.getValue()})};
function Lxp(a,b){a=a.C;for(var c=ea(a.C),d=c.next();!d.done;d=c.next())d.value.Wc(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.Dm();e++){var f=a.ql(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Wc(!0),c.push(f),0==--d))break}a.C=c}a.p_()}u.Hc=function(){return this.C.Hc()};u.Ah=function(a){Jxp(a);this.C.Ah(a)};u.$c=function(a){this.C.$c(a)};function Jxp(a){for(var b=0;b<a.yd();b++)a.Ld(b).dw(!0)}function Kxp(a,b,c){b=void 0===b?yv.qb():b;GY.call(this,a,b,c);this.C=[]}z(Kxp,GY);
Kxp.prototype.Ah=function(a){GY.prototype.Ah.call(this,a);this.C=[];this.p_()};Kxp.prototype.wA=function(a){a.stopPropagation();a=a.target;if(a.Le()){var b=this.Hc();Mia(this.C,a,function(c,d){return cg(qq(b,c),qq(b,d))})}else Tf(this.C,a);this.p_();this.dispatchEvent("change")};Kxp.prototype.J=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Fl()}).join(", ");return a||""};function Mxp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(V("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
V("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-date-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-time-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return zq(a)};var Nxp=new ct("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Oxp(a,b,c,d){dwp.call(this,a,b,c,d);this.Ka=nf(pf(),"fdsrfu")?1:4;a=new es;a.Pa(new as("Every day",1),!0);a.Pa(new as("Every week",2),!0);a.Pa(new as("Every month",3),!0);this.H=new GY(a,yv.qb(),d);lOb(this.H,"Add frequency");this.H.$c("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Pa(this.H);this.D=new Ixp(void 0,yv.qb(),d);lOb(this.D.C,"Add date");this.D.$c("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");this.Pa(this.D);
var e=this.Ka;a=new es;var f=new Date(ya());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=DVk(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new as(c[e].label,c[e].value),a.Pa(f,!0);this.J=new GY(a,yv.qb(),d);lOb(this.J,"Add time");this.J.$c("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Pa(this.J);this.R=new Oz("Cancel");this.Pa(this.R);this.V=new Xt("Save",d);this.V.Ya(!1);
this.Pa(this.V);this.X=new Zr("",ex.qb(),d);this.Pa(this.X);this.Fa=new Zr("Setup now",ex.qb(),d);this.Pa(this.Fa);this.Aa=new Zr("",ex.qb(),d);this.Pa(this.Aa);this.F=new I$j(d);this.F.dh("Enable schedule");this.Pa(this.F);this.oa=b;this.O=new yVk(d);this.O.ld("waffle-dataconnector-refresh-schedules-info-icon");this.O.setVisible(!1);this.Ga=new QY(!0,"#0f9d58")}z(Oxp,dwp);u=Oxp.prototype;
u.Ia=function(){dwp.prototype.Ia.call(this);this.Ob(xq(Mxp));var a=this.Ja("waffle-dataconnector-refresh-schedules-title");a.id=oq(this,"waffle-dataconnector-refresh-schedules-title");Tq(a,"heading");Wq(this.Ua(),"labelledby",a.id);a=this.O.C;a.setContent(hh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Ja("waffle-dataconnector-refresh-schedules-header-title"));a=a.Ec();Wq(this.O.Ua(),"labelledby",
a.id)};
u.Qa=function(){dwp.prototype.Qa.call(this);this.R.render(this.Ja("waffle-dataconnector-refresh-schedules-cancel-btn"));this.X.render(this.Ja("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Ja("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ja("waffle-dataconnector-refresh-schedules-frequency-select"));this.V.render(this.Ja("waffle-dataconnector-refresh-schedules-save-btn"));this.Fa.render(this.Ja("waffle-dataconnector-refresh-schedules-setup-btn"));this.Aa.render(this.Ja("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Ja("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Ja("waffle-dataconnector-refresh-schedules-date-select"));this.Ga.render(this.Ja("waffle-dataconnector-refresh-schedules-spinner"));Pxp(this,!1);zNb(this.J,new Sq(null,13));this.getHandler().listen(this.X,"action",this.show).listen(this.R,"action",this.Ehc).listen(this.V,"action",this.Hhc).listen(this.Fa,"action",this.show).listen(this.F,"action",this.Fhc).listen(this.H,"change",this.Ghc).listen(this.D,
"change",this.gva).listen(this.J,"change",this.gva).listen(this.Aa,"action",this.Ihc).listen(this.Ua(),"keydown",this.Dhc);0<Array.from(this.$a.C.keys()).length?(gq(this.Ua(),!0),kwp(this)):gq(this.Ua(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ja("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Ja("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Ja("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Ja("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Ja("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Ja("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Ja("waffle-dataconnector-refresh-schedules-spinner");
gq(e,!1);gq(f,!1);gq(a,!1);gq(b,!1);gq(c,!1);gq(d,!1);gq(h,!1);fr(this.Ua(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:gq(e,!0);break;case 2:gq(c,!0);gq(a,!0);gq(d,!0);fr(this.Ua(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;Qxp(this);Rxp(this);this.gva();this.R.Ya(!0);this.O.setVisible(!0);break;case 3:gq(h,!0);break;case 5:gq(c,!0);gq(f,!0);gq(a,!0);gq(d,!0);fr(this.Ua(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;Sxp(this);Qxp(this);Rxp(this);a=ZEk(this.C);this.F.Wc(!!fj(a,1));b=a.So().So();this.H.setValue(b);switch(b){case 1:Pxp(this,!1);break;case 2:Lxp(this.D,xX(a.So(),4).Lc());Pxp(this,!0);break;case 3:Lxp(this.D,xX(a.So(),5).Lc()),Pxp(this,!0)}this.J.setValue(kj(a.So(),2));this.gva();this.R.Ya(!0);this.O.setVisible(!0);break;case 4:gq(f,!0),gq(b,!0),Sxp(this),b=this.Ja("waffle-dataconnector-refresh-schedules-overview-text"),lwp(this)?(a=this.C.getStatus(),ln(b,"Next: "),b=new Date(1E3*jj(a,2)),
a=new Date(1E3*jj(a,3)),this.X.setContent(zn(this.Da(),FVk(b,a,this.oa,!0,!0)))):(ln(b,"Paused"),this.X.setContent("Edit"))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Vk":"Uk"))}};function Sxp(a){var b=!!fj(ZEk(a.C),1),c=lu.isEnabled();a.F.Wc(b);a.F.Ya(c)}function Qxp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=hj(a.C.rc(4,OEk),1))&&(c+=" Currently running as "+a);ln(b,c)}
function Rxp(a){var b=a.Ja("waffle-dataconnector-refresh-schedules-fullview-text");if(lwp(a)){var c=a.C.getStatus(),d=new Date(1E3*jj(c,2));c=new Date(1E3*jj(c,3));var e=a.Da();e.Te(b);e.appendChild(b,zn(e,oh(hh("Next: "),FVk(d,c,a.oa,!1,!0))))}else ln(b,"");a.Aa.setContent(EVk(a.oa))}u.Ehc=function(){Txp(this)};function Txp(a){a.state=2==a.state?1:4;a.refresh();a.Ja("waffle-dataconnector-refresh-schedules-title").focus()}
u.Ghc=function(){var a=this.H.getValue();Lxp(this.D,[]);switch(a){case 1:Pxp(this,!1);break;case 2:Pxp(this,!0);a=this.D;var b=a.Ah,c=new es,d=Uxp();d=ea(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Pa(new as(e.label,e.value),!0);a=b.call(a,c);hi(a);break;case 3:Pxp(this,!0);a=this.D;b=a.Ah;c=new es;for(d=1;28>=d;d++)c.Pa(new as(Nxp.format({DAY:d}),d),!0);a=b.call(a,c);hi(a)}this.gva()};
u.Hhc=function(){this.V.Ya(!1);this.R.Ya(!1);var a=this.H.getValue(),b=Tvp().K$(a);if(2===a){a=ea(this.D.Ag());for(var c=a.next();!c.done;c=a.next())c=c.value,Sva(b.Ib,4,uva).add(c)}else if(3===a)for(a=ea(this.D.Ag()),c=a.next();!c.done;c=a.next())c=c.value,Sva(b.Ib,5,uva).add(c);a=this.J.getValue();vj(b,2,a);b=vj(Uvp().K$(b),3,1);2==this.state?(b.Ya(!0),n8b.Nb(b.va())):(b.Ya(this.F.Le()),o8b.Nb(b.va()))};
u.Fhc=function(){var a=this;if(4==this.state){var b=this.F.Le();this.F.Wc(!b);this.F.Ya(!1);if(b){var c=Vxp(this);c.render();c.setVisible(!0);c.Kl().then(function(){hi(c);p8b.Nb()},function(){hi(c);Sxp(a)})}else q8b.Nb()}};u.Dhc=function(a){27==a.keyCode&&this.ma&&(Txp(this),a.stopPropagation())};u.Ihc=function(){Aec.Nb()};u.gva=function(){var a=!!this.H.bj(),b=1===this.H.getValue()||0<this.D.Ag().length,c=!!this.J.bj(),d=lu.isEnabled();this.V.Ya(a&&b&&c&&d)};u.focus=function(){this.Ja("waffle-dataconnector-refresh-schedules-title").focus()};
u.pob=function(a){this.F.Ya(a)};function Pxp(a,b){gq(a.Ja("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function Vxp(a){var b=new ecl;b.ld("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=ZEk(a.C);switch(c.So().So()){case 1:var d="Daily ";break;case 2:d=Uxp();var e=xX(c.So(),4).Lc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(xX(c.So(),5).Lc().map(function(l){return Nxp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=CVk(a.oa);var h=new Date(ya()),k=new Date(1E3*jj(f,2));f=new Date(1E3*jj(f,3));d+=DVk(k,f,c)+" ("+M0b(O0b(c,h))+")";a="Will run as "+hj(a.C.rc(4,OEk),1);a=oh(hh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),nh("H4",void 0,"Schedule"),hh(d),nh("BR"),hh(a));rr(b,a);return b}u.oXa=function(){Js.qb().postMessage(Ls("Error saving schedule.","error",!0));this.V.Ya(!0);this.R.Ya(!0);this.F.Ya(!0)};
function Uxp(){var a=($t.FIRSTDAYOFWEEK+1)%7,b=$t.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function Wxp(a,b,c,d,e,f){TY.call(this,f);this.F=b.O;this.O=a;this.V=d;this.u$=new xxp(b,c,this.V,this.Da());this.Pa(this.u$);this.D=new mwp(this.F,f);this.Ca(this.D);this.C=null;this.X=nf(pf(),"fdsrfu");this.J=null;this.R=e}z(Wxp,TY);u=Wxp.prototype;u.Ia=function(){TY.prototype.Ia.call(this);this.Ob(xq(nwp,{id:this.getId()}));this.D.render(this.Ja("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
u.Qa=function(){var a=this;TY.prototype.Qa.call(this);Xxp(this);this.getHandler().listen(this,["Uk","Vk"],this.f5c);this.u$.render(this.Ja("waffle-dataconnector-refresh-sidebar-refresh-widget"));Yxp(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=Rvp(a.F);W7b.Nb(new fak(b,"all-objects-for-all-datasources"))});this.D.refresh();gq(this.Ja("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function Zxp(a){null!=a.C&&(hi(a.C),hi(a.J),Xxp(a))}
u.AZa=function(){null!=this.C&&this.C.show()};function $xp(a,b){Exp(a.u$,b);var c=0;b.forEach(function(d){return c+=parseInt(d.tA(),10)});a.D.Dv(c)}function Yxp(a,b){a.u$.Ya(b);b?a.D.refresh():a.D.C.Ya(b)}
u.f5c=function(a){var b=this;a="Vk"===a.type;gq(this.Ja("waffle-dataconnector-refresh-sidebar-backdrop"),a);Yxp(this,!a);Sp(this.Ec(),"overflow-y",a?"hidden":"auto");hi(this.J);a?(ayp(this),setTimeout(function(){if(b.C.Dc()){var c=b.C.Ua();b.J=new Pt(c,b.Da());b.Ca(b.J);Qt(b.J);c.focus()}},500)):this.resize()};function Xxp(a){a.C=a.X?new Kwp(a.F,a.O,a.R,a.Da()):new Oxp(a.F,a.O,a.R,a.Da());a.Pa(a.C);a.C.render(a.Ua());gq(a.Ja("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
u.resize=function(){if(this.C)if(this.C.ma)ayp(this);else{var a=dq(this.Ec()).height-dq(this.C.Ua()).height,b=this.Ja("waffle-dataconnector-refresh-sidebar-refresh-widget");cq(b,a)}};function ayp(a){var b=dq(a.Ua()).height-dq(a.Ja("waffle-sidebar-title")).height-10;Sp(a.C.Ua(),"max-height",b+"px")};function byp(a,b,c){zY.call(this,a,b);var d=this;this.C=c;this.F=new Jm;this.Ca(this.F);this.F.Bc(this.C.H,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.wd,Cxp(e.u$),0<Rvp(e.F).length||e.dispatchEvent("close-sidebar");cyp(d);Hxp(d.wd.u$)});this.D.listen(Vw,"show-db-objects-refresh-sidebar",this.H)}z(byp,zY);byp.prototype.Ej=function(){return Y7b};byp.prototype.qv=function(){return Z7b};
function cyp(a){var b=Rvp(a.C),c=a.wd;0==b.length?Svp(c.D):(Fxp(c.u$),x$k(c.D),U_j(a.C,b,function(d){a.isDisposed()||c.isDisposed()||$xp(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new x2c(d[0].Fu(),d[0].gj()),Gxp(c.u$),c.D.eP(d))}))}byp.prototype.H=function(a){var b=this;Zxp(this.wd);cyp(this);AY(this);a.AZa&&this.wd.AZa();Cn(function(){b.wd.Ua().focus()})};function dyp(){ko.apply(this,arguments)}z(dyp,ko);dyp.prototype.C=function(){return byp};dyp.prototype.D=function(){return Wxp};wo("dbrefresh",dyp);
